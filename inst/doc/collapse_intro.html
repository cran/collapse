<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Sebastian Krantz" />

<meta name="date" content="2020-11-10" />

<title>Introduction to collapse</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>
<style type="text/css">
a.anchor-section {margin-left: 10px; visibility: hidden; color: inherit;}
a.anchor-section::before {content: '#';}
.hasAnchor:hover a.anchor-section {visibility: visible;}
</style>
<script>// Anchor sections v1.0 written by Atsushi Yasumoto on Oct 3rd, 2020.
document.addEventListener('DOMContentLoaded', function() {
  // Do nothing if AnchorJS is used
  if (typeof window.anchors === 'object' && anchors.hasOwnProperty('hasAnchorJSLink')) {
    return;
  }

  const h = document.querySelectorAll('h1, h2, h3, h4, h5, h6');

  // Do nothing if sections are already anchored
  if (Array.from(h).some(x => x.classList.contains('hasAnchor'))) {
    return null;
  }

  // Use section id when pandoc runs with --section-divs
  const section_id = function(x) {
    return ((x.classList.contains('section') || (x.tagName === 'SECTION'))
            ? x.id : '');
  };

  // Add anchors
  h.forEach(function(x) {
    const id = x.id || section_id(x.parentElement);
    if (id === '') {
      return null;
    }
    let anchor = document.createElement('a');
    anchor.href = '#' + id;
    anchor.classList = ['anchor-section'];
    x.classList.add('hasAnchor');
    x.appendChild(anchor);
  });
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to <em>collapse</em></h1>
<h3 class="subtitle">Advanced and Fast Data Transformation in R</h3>
<h4 class="author">Sebastian Krantz</h4>
<h4 class="date">2020-11-10</h4>


<div id="TOC">
<ul>
<li><a href="#why-collapse">Why <em>collapse</em>?</a></li>
<li><a href="#data-and-summary-tools">1. Data and Summary Tools</a><ul>
<li><a href="#wlddev---world-bank-development-data">1.1 <code>wlddev</code> - World Bank Development Data</a></li>
<li><a href="#ggdc10s---ggdc-10-sector-database">1.2 <code>GGDC10S</code> - GGDC 10-Sector Database</a></li>
</ul></li>
<li><a href="#fast-data-manipulation">2. Fast Data Manipulation</a><ul>
<li><a href="#selecting-and-replacing-columns">2.1 Selecting and Replacing Columns</a></li>
<li><a href="#subsetting">2.2 Subsetting</a></li>
<li><a href="#reordering-rows-and-columns">2.3 Reordering Rows and Columns</a></li>
<li><a href="#transforming-and-computing-new-columns">2.4 Transforming and Computing New Columns</a></li>
<li><a href="#adding-and-binding-columns">2.5 Adding and Binding Columns</a></li>
<li><a href="#renaming-columns">2.6 Renaming Columns</a></li>
<li><a href="#using-shortcuts">2.7 Using Shortcuts</a></li>
<li><a href="#missing-values-rows">2.8 Missing Values / Rows</a></li>
<li><a href="#unique-values-rows">2.9 Unique Values / Rows</a></li>
<li><a href="#recoding-and-replacing-values">2.10 Recoding and Replacing Values</a></li>
</ul></li>
<li><a href="#quick-data-object-conversions">3. Quick Data Object Conversions</a></li>
<li><a href="#advanced-statistical-programming">4. Advanced Statistical Programming</a><ul>
<li><a href="#fast-grouped-weighted-statistical-functions">4.1 Fast (Grouped, Weighted) Statistical Functions</a></li>
<li><a href="#factors-grouping-objects-and-grouped-data-frames">4.2 Factors, Grouping Objects and Grouped Data Frames</a></li>
<li><a href="#grouped-and-weighted-computations">4.3 Grouped and Weighted Computations</a></li>
<li><a href="#transformations-using-the-tra-argument">4.4 Transformations Using the <code>TRA</code> Argument</a></li>
</ul></li>
<li><a href="#advanced-data-aggregation">5. Advanced Data Aggregation</a></li>
<li><a href="#data-transformations">6. Data Transformations</a><ul>
<li><a href="#row-and-column-data-apply">6.1 Row and Column Data Apply</a></li>
<li><a href="#split-apply-combine-computing">6.2 Split-Apply-Combine Computing</a></li>
<li><a href="#fast-replacing-and-sweeping-out-statistics">6.3 Fast Replacing and Sweeping-out Statistics</a></li>
<li><a href="#fast-standardizing">6.4 Fast Standardizing</a></li>
<li><a href="#fast-centering-and-averaging">6.5 Fast Centering and Averaging</a></li>
<li><a href="#hd-centering-and-linear-prediction">6.6 HD Centering and Linear Prediction</a></li>
</ul></li>
<li><a href="#time-series-and-panel-series">7. Time Series and Panel Series</a><ul>
<li><a href="#panel-series-to-array-conversions">7.1 Panel Series to Array Conversions</a></li>
<li><a href="#panel-series-acf-pacf-and-ccf">7.2 Panel Series ACF, PACF and CCF</a></li>
<li><a href="#fast-lags-and-leads">7.3 Fast Lags and Leads</a></li>
<li><a href="#fast-differences-and-growth-rates">7.4 Fast Differences and Growth Rates</a></li>
</ul></li>
<li><a href="#list-processing-and-a-panel-var-example">8. List Processing and a Panel-VAR Example</a><ul>
<li><a href="#list-search-and-identification">8.1 List Search and Identification</a></li>
<li><a href="#list-subsetting">8.2 List Subsetting</a></li>
<li><a href="#recursive-apply-and-unlisting-in-2d">8.3 Recursive Apply and Unlisting in 2D</a></li>
</ul></li>
<li><a href="#going-further">Going Further</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

<style type="text/css">
pre {
  max-height: 500px;
  overflow-y: auto;
}

pre[class] {
  max-height: 500px;
}
</style>
<p><em>collapse</em> is a C/C++ based package for data transformation and statistical computing in R. It’s aims are:</p>
<ol style="list-style-type: decimal">
<li>To facilitate complex data transformation, exploration and computing tasks in R.</li>
<li>To help make R code fast, flexible, parsimonious and programmer friendly.</li>
</ol>
<p>This vignette demonstrates these two points and introduces all main features of the package in a structured way. The chapters are pretty self-contained, however the first chapters introduce the data and faster data manipulation functions which are used throughout the rest of this vignette.</p>
<!-- structured with an overarching aim to instruct the reader how to write fast R code for (advanced) data manipulation with *collapse*. -->
<hr />
<p><strong>Notes:</strong></p>
<ul>
<li><p>Apart from this vignette, <em>collapse</em> comes with a built-in structured documentation available under <code>help(&quot;collapse-documentation&quot;)</code> after installing the package, and <code>help(&quot;collapse-package&quot;)</code> provides a compact set of examples for quick-start. <!-- To learn *collapse* as quickly as possible it is possibly better to consult those resources than going through this document.  --></p></li>
<li><p>The two other vignettes focus on the integration of <em>collapse</em> with <em>dplyr</em> workflows (recommended for <em>dplyr</em> / <em>tidyverse</em> users), and on the integration of <em>collapse</em> with the <em>plm</em> package (+ some advanced programming with panel data).</p></li>
<li><p>Documentation and vignettes can also be viewed <a href="https://sebkrantz.github.io/collapse/">online</a>.</p></li>
</ul>
<!-- - All benchmarks are run with a Windows 8.1 laptop, 2x 2.2 GHZ Intel i5 processor, 8GB DDR3 RAM and a Samsung 850 EVO SSD.  -->
<hr />
<!-- and why learn *collapse*? -->
<div id="why-collapse" class="section level2">
<h2>Why <em>collapse</em>?</h2>
<p><em>collapse</em> is a high-performance package that extends and enhances the data-manipulation capabilities of R and existing popular packages (such as <em>dplyr</em>, <em>data.table</em>, and matrix packages). It’s main focus is on grouped and weighted statistical programming, complex aggregations and transformations, time series and panel data operations, and programming with lists of data objects. The lead author is an applied economist and created the package mainly to facilitate advanced computations on varied and complex data, in particular surveys, (multivariate) time series, multilevel / panel data, and lists / model objects.</p>
<p>A secondary aspect to applied work is that data is often imported into R from richer data structures (such as STATA, SPSS or SAS files imported with <em>haven</em>). This called for an intelligent suite of data manipulation functions that can both utilize aspects of the richer data structure (such as variable labels), and preserve the data structure / attributes in computations. Sometimes specialized classes like <em>xts</em>, <em>pdata.frame</em> and <em>grouped_df</em> can also become very useful to manipulate certain types of data. Thus <em>collapse</em> was built to explicitly supports these classes, while preserving most other classes / data structures in R. <!-- , enabling flexible, efficient and non-destructive workflows with complex data.  --></p>
<p>Another objective was to radically improve the speed of R code by extensively relying on efficient algorithms in C/C++ and the faster components of base R. <em>collapse</em> ranks among the fastest R packages, and performs many grouped and/or weighted computations noticeably faster than <em>dplyr</em> or <em>data.table</em>.</p>
<p>A further development objective was to channel this performance through a stable and well conceived user API providing extensive and optimized programming capabilities (in standard evaluation) while also facilitating quick use and easy integration with existing data manipulation frameworks (in particular <em>dplyr</em> / <em>tidyverse</em> and <em>data.table</em>, both relying on non-standard evaluation).</p>
<p><em>collapse</em> also provides exemplary documentation (built-in, vignettes, website) and testing. Testing currently covers all core features of the package, amounting to &gt; 7700 unit tests, with extensive testing of statistical functions and computations.</p>
<p>The name of the package derives from the ‘collapse’ command for multi-type aggregation in the STATA statistical software. This was the first function in this package (later renamed to <code>collap</code> to avoid naming conflicts with <em>dplyr</em>).</p>
<!-- Key strengths are: -->
<!-- * *collapse* provides an organized and comprehensive suite of advanced statistical operations such as grouped, weighted and groupwise weighted statistics, grouped sweeping of statistics, scaling, centering, higher-dimensional centering and linear prediction, panel data methods and summary statistics, and various time-computations such as iterated-, panel-, quasi-, log- differences and growth rates. -->
<!-- * *collapse* is extremely fast *and* micro-optimized. Many grouped and weighted computations are noticeably faster than doing them in *dplyr* or *data.table*. Furthermore the execution speed of *collapse* functions on small data is ~ 10-100 microseconds. This speed becomes noticeable when executing a page of code, writing a statistical program or the server code for a *shiny* app. -->
<!-- <!-- Core functions in *dplyr* or *data.table* seldomly execute below 1 millisecond.  -->
<!-- * *collapse* is fully programmable in standard evaluation. It facilitates writing complex and performant code without the need of complex meta-programming. Core methods can be called directly and grouping time can be saved through creating grouping objects or grouped / panel data frames. The result is that efficient *collapse* code is often not that far from a native C++ implementation. -->
<!-- * *collapse* is broadly object oriented and not centered around data frames. It supports all R data structures, in particular vectors / various time series / panel series, matrices, data frames / grouped data frames (`dplyr::grouped_df`) / panel data frames (`plm::pdata.frame`) and general lists of data objects.  -->
<!-- * *collapse* is well documented and receives continued maintenance and support. Performance and functionality will increase over time. The API for core functionality such as the fast statistical functions and transformation operators is guaranteed to remain unaltered for some time to come.  -->
<!-- Finally, in case you want to know, why is this package called *collapse*? Because I came to R from *STATA* and one of the first things I started to create and use was a `collap` command (abbreviated from *STATA*'s `collapse`) to flexibly aggregate multi-type data. That was the very early beginning of this package in 2017. I started developing many more tools for R that I required for econometric analysis of complex data, and in 2019 started rewriting everything in C++ with the goal of creating a coherent, state of the art high-performance package. I stuck with `collapse` because I still think it's a nice name for a package with a rather revolutionary approach to data manipulation.   -->
</div>
<div id="data-and-summary-tools" class="section level2">
<h2>1. Data and Summary Tools</h2>
<p>We begin by introducing some powerful summary tools along with the 2 panel datasets <em>collapse</em> provides which are used throughout this vignette. If you are just interested in programming you can skip this section. Apart from the 2 datasets that come with <em>collapse</em> (<code>wlddev</code> and <code>GGDC10S</code>), this vignette uses a few well known datasets from base R: <code>mtcars</code>, <code>iris</code>, <code>airquality</code>, and the time series <code>Airpassengers</code> and <code>EuStockMarkets</code>. <!-- Below I introduce `wlddev` and `GGDC10S` and summarize them using `qsu` (quick-summary), as I will not spend much time explaining these datasets in the remainder of the vignette. You may choose to skip this section and start with Section 2. --></p>
<div id="wlddev---world-bank-development-data" class="section level3">
<h3>1.1 <code>wlddev</code> - World Bank Development Data</h3>
<p>This dataset contains 4 key World Bank Development Indicators covering 216 countries over 59 years. It is a balanced panel with <span class="math inline">\(216 \times 59 = 12744\)</span> observations.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(collapse)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">head</span>(wlddev)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co">#       country iso3c       date year decade     region     income  OECD PCGDP LIFEEX GINI       ODA</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co"># 1 Afghanistan   AFG 1961-01-01 1960   1960 South Asia Low income FALSE    NA 32.292   NA 114440000</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co"># 2 Afghanistan   AFG 1962-01-01 1961   1960 South Asia Low income FALSE    NA 32.742   NA 233350000</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co"># 3 Afghanistan   AFG 1963-01-01 1962   1960 South Asia Low income FALSE    NA 33.185   NA 114880000</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co"># 4 Afghanistan   AFG 1964-01-01 1963   1960 South Asia Low income FALSE    NA 33.624   NA 236450000</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co"># 5 Afghanistan   AFG 1965-01-01 1964   1960 South Asia Low income FALSE    NA 34.060   NA 302480000</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co"># 6 Afghanistan   AFG 1966-01-01 1965   1960 South Asia Low income FALSE    NA 34.495   NA 370250000</span></span>
<span id="cb1-10"><a href="#cb1-10"></a></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="co"># The variables have &quot;label&quot; attributes. Use vlabels() to get and set labels</span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="kw">namlab</span>(wlddev, <span class="dt">class =</span> <span class="ot">TRUE</span>)</span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="co">#    Variable     Class                                   Label</span></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="co"># 1   country character                            Country Name</span></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="co"># 2     iso3c    factor                            Country Code</span></span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="co"># 3      date      Date              Date Recorded (Fictitious)</span></span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="co"># 4      year   integer                                    Year</span></span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="co"># 5    decade   numeric                                  Decade</span></span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="co"># 6    region    factor                                  Region</span></span>
<span id="cb1-20"><a href="#cb1-20"></a><span class="co"># 7    income    factor                            Income Level</span></span>
<span id="cb1-21"><a href="#cb1-21"></a><span class="co"># 8      OECD   logical                 Is OECD Member Country?</span></span>
<span id="cb1-22"><a href="#cb1-22"></a><span class="co"># 9     PCGDP   numeric      GDP per capita (constant 2010 US$)</span></span>
<span id="cb1-23"><a href="#cb1-23"></a><span class="co"># 10   LIFEEX   numeric Life expectancy at birth, total (years)</span></span>
<span id="cb1-24"><a href="#cb1-24"></a><span class="co"># 11     GINI   numeric        GINI index (World Bank estimate)</span></span>
<span id="cb1-25"><a href="#cb1-25"></a><span class="co"># 12      ODA   numeric    Net ODA received (constant 2015 US$)</span></span></code></pre></div>
<p>Of the categorical identifiers, the date variable was artificially generated to have an example dataset that contains all common data types frequently encountered in R. A detailed statistical description of this data is computed by <code>descr</code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># A fast and detailed statistical description</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw">descr</span>(wlddev)</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co"># Dataset: wlddev, 12 Variables, N = 12744</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co"># -----------------------------------------------------------------------------------------------------</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co"># country (character): Country Name</span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="co"># Stats: </span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co">#       N  Ndist</span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co">#   12744    216</span></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="co"># Table: </span></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="co">#                      Freq  Perc</span></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="co"># Afghanistan            59  0.46</span></span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="co"># Albania                59  0.46</span></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="co"># Algeria                59  0.46</span></span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="co"># American Samoa         59  0.46</span></span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="co"># Andorra                59  0.46</span></span>
<span id="cb2-16"><a href="#cb2-16"></a><span class="co"># Angola                 59  0.46</span></span>
<span id="cb2-17"><a href="#cb2-17"></a><span class="co"># Antigua and Barbuda    59  0.46</span></span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="co">#   ---</span></span>
<span id="cb2-19"><a href="#cb2-19"></a><span class="co">#                        Freq  Perc</span></span>
<span id="cb2-20"><a href="#cb2-20"></a><span class="co"># Vanuatu                  59  0.46</span></span>
<span id="cb2-21"><a href="#cb2-21"></a><span class="co"># Venezuela, RB            59  0.46</span></span>
<span id="cb2-22"><a href="#cb2-22"></a><span class="co"># Vietnam                  59  0.46</span></span>
<span id="cb2-23"><a href="#cb2-23"></a><span class="co"># Virgin Islands (U.S.)    59  0.46</span></span>
<span id="cb2-24"><a href="#cb2-24"></a><span class="co"># West Bank and Gaza       59  0.46</span></span>
<span id="cb2-25"><a href="#cb2-25"></a><span class="co"># Yemen, Rep.              59  0.46</span></span>
<span id="cb2-26"><a href="#cb2-26"></a><span class="co"># Zambia                   59  0.46</span></span>
<span id="cb2-27"><a href="#cb2-27"></a><span class="co"># Zimbabwe                 59  0.46</span></span>
<span id="cb2-28"><a href="#cb2-28"></a><span class="co"># </span></span>
<span id="cb2-29"><a href="#cb2-29"></a><span class="co"># Summary of Table: </span></span>
<span id="cb2-30"><a href="#cb2-30"></a><span class="co">#    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb2-31"><a href="#cb2-31"></a><span class="co">#      59      59      59      59      59      59 </span></span>
<span id="cb2-32"><a href="#cb2-32"></a><span class="co"># -----------------------------------------------------------------------------------------------------</span></span>
<span id="cb2-33"><a href="#cb2-33"></a><span class="co"># iso3c (factor): Country Code</span></span>
<span id="cb2-34"><a href="#cb2-34"></a><span class="co"># Stats: </span></span>
<span id="cb2-35"><a href="#cb2-35"></a><span class="co">#       N  Ndist</span></span>
<span id="cb2-36"><a href="#cb2-36"></a><span class="co">#   12744    216</span></span>
<span id="cb2-37"><a href="#cb2-37"></a><span class="co"># Table: </span></span>
<span id="cb2-38"><a href="#cb2-38"></a><span class="co">#      Freq  Perc</span></span>
<span id="cb2-39"><a href="#cb2-39"></a><span class="co"># ABW    59  0.46</span></span>
<span id="cb2-40"><a href="#cb2-40"></a><span class="co"># AFG    59  0.46</span></span>
<span id="cb2-41"><a href="#cb2-41"></a><span class="co"># AGO    59  0.46</span></span>
<span id="cb2-42"><a href="#cb2-42"></a><span class="co"># ALB    59  0.46</span></span>
<span id="cb2-43"><a href="#cb2-43"></a><span class="co"># AND    59  0.46</span></span>
<span id="cb2-44"><a href="#cb2-44"></a><span class="co"># ARE    59  0.46</span></span>
<span id="cb2-45"><a href="#cb2-45"></a><span class="co"># ARG    59  0.46</span></span>
<span id="cb2-46"><a href="#cb2-46"></a><span class="co">#   ---</span></span>
<span id="cb2-47"><a href="#cb2-47"></a><span class="co">#      Freq  Perc</span></span>
<span id="cb2-48"><a href="#cb2-48"></a><span class="co"># VNM    59  0.46</span></span>
<span id="cb2-49"><a href="#cb2-49"></a><span class="co"># VUT    59  0.46</span></span>
<span id="cb2-50"><a href="#cb2-50"></a><span class="co"># WSM    59  0.46</span></span>
<span id="cb2-51"><a href="#cb2-51"></a><span class="co"># XKX    59  0.46</span></span>
<span id="cb2-52"><a href="#cb2-52"></a><span class="co"># YEM    59  0.46</span></span>
<span id="cb2-53"><a href="#cb2-53"></a><span class="co"># ZAF    59  0.46</span></span>
<span id="cb2-54"><a href="#cb2-54"></a><span class="co"># ZMB    59  0.46</span></span>
<span id="cb2-55"><a href="#cb2-55"></a><span class="co"># ZWE    59  0.46</span></span>
<span id="cb2-56"><a href="#cb2-56"></a><span class="co"># </span></span>
<span id="cb2-57"><a href="#cb2-57"></a><span class="co"># Summary of Table: </span></span>
<span id="cb2-58"><a href="#cb2-58"></a><span class="co">#    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb2-59"><a href="#cb2-59"></a><span class="co">#      59      59      59      59      59      59 </span></span>
<span id="cb2-60"><a href="#cb2-60"></a><span class="co"># -----------------------------------------------------------------------------------------------------</span></span>
<span id="cb2-61"><a href="#cb2-61"></a><span class="co"># date (Date): Date Recorded (Fictitious)</span></span>
<span id="cb2-62"><a href="#cb2-62"></a><span class="co"># Stats: </span></span>
<span id="cb2-63"><a href="#cb2-63"></a><span class="co">#       N  Ndist</span></span>
<span id="cb2-64"><a href="#cb2-64"></a><span class="co">#   12744     59</span></span>
<span id="cb2-65"><a href="#cb2-65"></a><span class="co"># -----------------------------------------------------------------------------------------------------</span></span>
<span id="cb2-66"><a href="#cb2-66"></a><span class="co"># year (integer): Year</span></span>
<span id="cb2-67"><a href="#cb2-67"></a><span class="co"># Stats: </span></span>
<span id="cb2-68"><a href="#cb2-68"></a><span class="co">#       N  Ndist  Mean     SD   Min   Max  Skew  Kurt</span></span>
<span id="cb2-69"><a href="#cb2-69"></a><span class="co">#   12744     59  1989  17.03  1960  2018    -0   1.8</span></span>
<span id="cb2-70"><a href="#cb2-70"></a><span class="co"># Quant: </span></span>
<span id="cb2-71"><a href="#cb2-71"></a><span class="co">#     1%    5%   25%   50%   75%   95%   99%</span></span>
<span id="cb2-72"><a href="#cb2-72"></a><span class="co">#   1960  1962  1974  1989  2004  2016  2018</span></span>
<span id="cb2-73"><a href="#cb2-73"></a><span class="co"># -----------------------------------------------------------------------------------------------------</span></span>
<span id="cb2-74"><a href="#cb2-74"></a><span class="co"># decade (numeric): Decade</span></span>
<span id="cb2-75"><a href="#cb2-75"></a><span class="co"># Stats: </span></span>
<span id="cb2-76"><a href="#cb2-76"></a><span class="co">#       N  Ndist     Mean     SD   Min   Max  Skew  Kurt</span></span>
<span id="cb2-77"><a href="#cb2-77"></a><span class="co">#   12744      7  1988.98  17.63  1960  2020  0.01  1.95</span></span>
<span id="cb2-78"><a href="#cb2-78"></a><span class="co"># Quant: </span></span>
<span id="cb2-79"><a href="#cb2-79"></a><span class="co">#     1%    5%   25%   50%   75%   95%   99%</span></span>
<span id="cb2-80"><a href="#cb2-80"></a><span class="co">#   1960  1960  1970  1990  2000  2020  2020</span></span>
<span id="cb2-81"><a href="#cb2-81"></a><span class="co"># -----------------------------------------------------------------------------------------------------</span></span>
<span id="cb2-82"><a href="#cb2-82"></a><span class="co"># region (factor): Region</span></span>
<span id="cb2-83"><a href="#cb2-83"></a><span class="co"># Stats: </span></span>
<span id="cb2-84"><a href="#cb2-84"></a><span class="co">#       N  Ndist</span></span>
<span id="cb2-85"><a href="#cb2-85"></a><span class="co">#   12744      7</span></span>
<span id="cb2-86"><a href="#cb2-86"></a><span class="co"># Table: </span></span>
<span id="cb2-87"><a href="#cb2-87"></a><span class="co">#                             Freq   Perc</span></span>
<span id="cb2-88"><a href="#cb2-88"></a><span class="co"># East Asia &amp; Pacific         2124  16.67</span></span>
<span id="cb2-89"><a href="#cb2-89"></a><span class="co"># Europe &amp; Central Asia       3422  26.85</span></span>
<span id="cb2-90"><a href="#cb2-90"></a><span class="co"># Latin America &amp; Caribbean   2478  19.44</span></span>
<span id="cb2-91"><a href="#cb2-91"></a><span class="co"># Middle East &amp; North Africa  1239   9.72</span></span>
<span id="cb2-92"><a href="#cb2-92"></a><span class="co"># North America                177   1.39</span></span>
<span id="cb2-93"><a href="#cb2-93"></a><span class="co"># South Asia                   472   3.70</span></span>
<span id="cb2-94"><a href="#cb2-94"></a><span class="co"># Sub-Saharan Africa          2832  22.22</span></span>
<span id="cb2-95"><a href="#cb2-95"></a><span class="co"># -----------------------------------------------------------------------------------------------------</span></span>
<span id="cb2-96"><a href="#cb2-96"></a><span class="co"># income (factor): Income Level</span></span>
<span id="cb2-97"><a href="#cb2-97"></a><span class="co"># Stats: </span></span>
<span id="cb2-98"><a href="#cb2-98"></a><span class="co">#       N  Ndist</span></span>
<span id="cb2-99"><a href="#cb2-99"></a><span class="co">#   12744      4</span></span>
<span id="cb2-100"><a href="#cb2-100"></a><span class="co"># Table: </span></span>
<span id="cb2-101"><a href="#cb2-101"></a><span class="co">#                      Freq   Perc</span></span>
<span id="cb2-102"><a href="#cb2-102"></a><span class="co"># High income          4720  37.04</span></span>
<span id="cb2-103"><a href="#cb2-103"></a><span class="co"># Low income           1947  15.28</span></span>
<span id="cb2-104"><a href="#cb2-104"></a><span class="co"># Lower middle income  2773  21.76</span></span>
<span id="cb2-105"><a href="#cb2-105"></a><span class="co"># Upper middle income  3304  25.93</span></span>
<span id="cb2-106"><a href="#cb2-106"></a><span class="co"># -----------------------------------------------------------------------------------------------------</span></span>
<span id="cb2-107"><a href="#cb2-107"></a><span class="co"># OECD (logical): Is OECD Member Country?</span></span>
<span id="cb2-108"><a href="#cb2-108"></a><span class="co"># Stats: </span></span>
<span id="cb2-109"><a href="#cb2-109"></a><span class="co">#       N  Ndist</span></span>
<span id="cb2-110"><a href="#cb2-110"></a><span class="co">#   12744      2</span></span>
<span id="cb2-111"><a href="#cb2-111"></a><span class="co"># Table: </span></span>
<span id="cb2-112"><a href="#cb2-112"></a><span class="co">#         Freq   Perc</span></span>
<span id="cb2-113"><a href="#cb2-113"></a><span class="co"># FALSE  10620  83.33</span></span>
<span id="cb2-114"><a href="#cb2-114"></a><span class="co"># TRUE    2124  16.67</span></span>
<span id="cb2-115"><a href="#cb2-115"></a><span class="co"># -----------------------------------------------------------------------------------------------------</span></span>
<span id="cb2-116"><a href="#cb2-116"></a><span class="co"># PCGDP (numeric): GDP per capita (constant 2010 US$)</span></span>
<span id="cb2-117"><a href="#cb2-117"></a><span class="co"># Stats: </span></span>
<span id="cb2-118"><a href="#cb2-118"></a><span class="co">#      N  Ndist      Mean        SD     Min        Max  Skew   Kurt</span></span>
<span id="cb2-119"><a href="#cb2-119"></a><span class="co">#   8995   8995  11563.65  18348.41  131.65  191586.64  3.11  16.96</span></span>
<span id="cb2-120"><a href="#cb2-120"></a><span class="co"># Quant: </span></span>
<span id="cb2-121"><a href="#cb2-121"></a><span class="co">#       1%      5%      25%      50%       75%       95%       99%</span></span>
<span id="cb2-122"><a href="#cb2-122"></a><span class="co">#   223.54  374.38  1215.59  3619.61  14084.71  46591.94  87780.62</span></span>
<span id="cb2-123"><a href="#cb2-123"></a><span class="co"># -----------------------------------------------------------------------------------------------------</span></span>
<span id="cb2-124"><a href="#cb2-124"></a><span class="co"># LIFEEX (numeric): Life expectancy at birth, total (years)</span></span>
<span id="cb2-125"><a href="#cb2-125"></a><span class="co"># Stats: </span></span>
<span id="cb2-126"><a href="#cb2-126"></a><span class="co">#       N  Ndist   Mean     SD    Min    Max   Skew  Kurt</span></span>
<span id="cb2-127"><a href="#cb2-127"></a><span class="co">#   11068  10048  63.84  11.45  18.91  85.42  -0.67  2.65</span></span>
<span id="cb2-128"><a href="#cb2-128"></a><span class="co"># Quant: </span></span>
<span id="cb2-129"><a href="#cb2-129"></a><span class="co">#      1%     5%    25%    50%   75%    95%    99%</span></span>
<span id="cb2-130"><a href="#cb2-130"></a><span class="co">#   35.49  42.23  55.84  66.97  72.5  78.82  81.83</span></span>
<span id="cb2-131"><a href="#cb2-131"></a><span class="co"># -----------------------------------------------------------------------------------------------------</span></span>
<span id="cb2-132"><a href="#cb2-132"></a><span class="co"># GINI (numeric): GINI index (World Bank estimate)</span></span>
<span id="cb2-133"><a href="#cb2-133"></a><span class="co"># Stats: </span></span>
<span id="cb2-134"><a href="#cb2-134"></a><span class="co">#      N  Ndist  Mean    SD   Min   Max  Skew  Kurt</span></span>
<span id="cb2-135"><a href="#cb2-135"></a><span class="co">#   1356    363  39.4  9.68  16.2  65.8  0.46  2.29</span></span>
<span id="cb2-136"><a href="#cb2-136"></a><span class="co"># Quant: </span></span>
<span id="cb2-137"><a href="#cb2-137"></a><span class="co">#      1%    5%   25%   50%   75%   95%    99%</span></span>
<span id="cb2-138"><a href="#cb2-138"></a><span class="co">#   24.66  26.5  31.7  37.4  46.8  57.2  60.84</span></span>
<span id="cb2-139"><a href="#cb2-139"></a><span class="co"># -----------------------------------------------------------------------------------------------------</span></span>
<span id="cb2-140"><a href="#cb2-140"></a><span class="co"># ODA (numeric): Net ODA received (constant 2015 US$)</span></span>
<span id="cb2-141"><a href="#cb2-141"></a><span class="co"># Stats: </span></span>
<span id="cb2-142"><a href="#cb2-142"></a><span class="co">#      N  Ndist        Mean          SD              Min             Max  Skew   Kurt</span></span>
<span id="cb2-143"><a href="#cb2-143"></a><span class="co">#   8336   7564  428,746468  819,868971  -1.08038000e+09  2.45521800e+10  7.19  122.9</span></span>
<span id="cb2-144"><a href="#cb2-144"></a><span class="co"># Quant: </span></span>
<span id="cb2-145"><a href="#cb2-145"></a><span class="co">#           1%        5%        25%         50%         75%             95%             99%</span></span>
<span id="cb2-146"><a href="#cb2-146"></a><span class="co">#   -11,731500  1,097500  41,020000  157,360000  463,057500  1.82400500e+09  3.48697750e+09</span></span>
<span id="cb2-147"><a href="#cb2-147"></a><span class="co"># -----------------------------------------------------------------------------------------------------</span></span></code></pre></div>
<p>The output of <code>descr</code> can be converted into a tidy data frame using:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">head</span>(<span class="kw">as.data.frame</span>(<span class="kw">descr</span>(wlddev)))</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="co">#   Variable     Class                      Label     N Ndist     Mean       SD  Min  Max</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co"># 1  country character               Country Name 12744   216       NA       NA   NA   NA</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co"># 2    iso3c    factor               Country Code 12744   216       NA       NA   NA   NA</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co"># 3     date      Date Date Recorded (Fictitious) 12744    59       NA       NA   NA   NA</span></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co"># 4     year   integer                       Year 12744    59 1989.000 17.03005 1960 2018</span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co"># 5   decade   numeric                     Decade 12744     7 1988.983 17.63107 1960 2020</span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="co"># 6   region    factor                     Region 12744     7       NA       NA   NA   NA</span></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co">#            Skew     Kurt   1%   5%  25%  50%  75%  95%  99%</span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="co"># 1            NA       NA   NA   NA   NA   NA   NA   NA   NA</span></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="co"># 2            NA       NA   NA   NA   NA   NA   NA   NA   NA</span></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="co"># 3            NA       NA   NA   NA   NA   NA   NA   NA   NA</span></span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="co"># 4 -6.402075e-16 1.799310 1960 1962 1974 1989 2004 2016 2018</span></span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="co"># 5  6.221301e-03 1.946267 1960 1960 1970 1990 2000 2020 2020</span></span>
<span id="cb3-15"><a href="#cb3-15"></a><span class="co"># 6            NA       NA   NA   NA   NA   NA   NA   NA   NA</span></span></code></pre></div>
<p>Note that <code>descr</code> does not require data to be labeled. Since <code>wlddev</code> is a panel data set tracking countries over time, we might be interested in checking which variables are time-varying, with the function <code>varying</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">varying</span>(wlddev, wlddev<span class="op">$</span>iso3c)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co"># country   iso3c    date    year  decade  region  income    OECD   PCGDP  LIFEEX    GINI     ODA </span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co">#   FALSE   FALSE    TRUE    TRUE    TRUE   FALSE   FALSE   FALSE    TRUE    TRUE    TRUE    TRUE</span></span></code></pre></div>
<p><code>varying</code> tells us that all 4 variables <code>PCGDP</code>, <code>LIFEEX</code>, <code>GINI</code> and <code>ODA</code> vary over time. However the <code>OECD</code> variable does not, so this data does not track when countries entered the OECD. We can also have a more detailed look letting <code>varying</code> check the variation in each country:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">head</span>(<span class="kw">varying</span>(wlddev, wlddev<span class="op">$</span>iso3c, <span class="dt">any_group =</span> <span class="ot">FALSE</span>))</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co">#     country iso3c date year decade region income  OECD PCGDP LIFEEX GINI  ODA</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co"># ABW   FALSE FALSE TRUE TRUE   TRUE  FALSE  FALSE FALSE  TRUE   TRUE   NA TRUE</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co"># AFG   FALSE FALSE TRUE TRUE   TRUE  FALSE  FALSE FALSE  TRUE   TRUE   NA TRUE</span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co"># AGO   FALSE FALSE TRUE TRUE   TRUE  FALSE  FALSE FALSE  TRUE   TRUE TRUE TRUE</span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co"># ALB   FALSE FALSE TRUE TRUE   TRUE  FALSE  FALSE FALSE  TRUE   TRUE TRUE TRUE</span></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="co"># AND   FALSE FALSE TRUE TRUE   TRUE  FALSE  FALSE FALSE  TRUE     NA   NA   NA</span></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="co"># ARE   FALSE FALSE TRUE TRUE   TRUE  FALSE  FALSE FALSE  TRUE   TRUE   NA TRUE</span></span></code></pre></div>
<p><code>NA</code> indicates that there are no data for this country. In general data is varying if it has two or more distinct non-missing values. We could also take a closer look at observation counts and distinct values using:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">head</span>(<span class="kw">fNobs</span>(wlddev, wlddev<span class="op">$</span>iso3c))</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co">#     country iso3c date year decade region income OECD PCGDP LIFEEX GINI ODA</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co"># ABW      59    59   59   59     59     59     59   59    32     57    0  20</span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co"># AFG      59    59   59   59     59     59     59   59    16     57    0  58</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co"># AGO      59    59   59   59     59     59     59   59    38     57    2  56</span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="co"># ALB      59    59   59   59     59     59     59   59    38     57    5  30</span></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="co"># AND      59    59   59   59     59     59     59   59    48      0    0   0</span></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="co"># ARE      59    59   59   59     59     59     59   59    43     57    0  45</span></span>
<span id="cb6-9"><a href="#cb6-9"></a></span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="kw">head</span>(<span class="kw">fNdistinct</span>(wlddev, wlddev<span class="op">$</span>iso3c))</span>
<span id="cb6-11"><a href="#cb6-11"></a><span class="co">#     country iso3c date year decade region income OECD PCGDP LIFEEX GINI ODA</span></span>
<span id="cb6-12"><a href="#cb6-12"></a><span class="co"># ABW       1     1   59   59      7      1      1    1    32     57    0  20</span></span>
<span id="cb6-13"><a href="#cb6-13"></a><span class="co"># AFG       1     1   59   59      7      1      1    1    16     57    0  58</span></span>
<span id="cb6-14"><a href="#cb6-14"></a><span class="co"># AGO       1     1   59   59      7      1      1    1    38     57    2  55</span></span>
<span id="cb6-15"><a href="#cb6-15"></a><span class="co"># ALB       1     1   59   59      7      1      1    1    38     56    5  30</span></span>
<span id="cb6-16"><a href="#cb6-16"></a><span class="co"># AND       1     1   59   59      7      1      1    1    48      0    0   0</span></span>
<span id="cb6-17"><a href="#cb6-17"></a><span class="co"># ARE       1     1   59   59      7      1      1    1    43     57    0  43</span></span></code></pre></div>
<p>Note that <code>varying</code> is more efficient than <code>fNdistinct</code>, although both functions are very fast. Even more powerful summary methods for multilevel / panel data are provided by <code>qsu</code> (shorthand for <em>quick-summary</em>). It is modeled after <em>STATA</em>’s <em>summarize</em> and <em>xtsummarize</em> commands. Calling <code>qsu</code> on the data gives a concise summary. We can subset columns internally using the <code>cols</code> argument:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">qsu</span>(wlddev, <span class="dt">cols =</span> <span class="dv">9</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">higher =</span> <span class="ot">TRUE</span>) <span class="co"># higher adds skewness and kurtosis</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="co">#             N        Mean          SD              Min             Max     Skew      Kurt</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co"># PCGDP    8995  11563.6529  18348.4052         131.6464       191586.64   3.1121   16.9585</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co"># LIFEEX  11068     63.8411     11.4497           18.907         85.4171  -0.6692    2.6458</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="co"># GINI     1356     39.3976      9.6764             16.2            65.8   0.4613    2.2932</span></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="co"># ODA      8336  428,746468  819,868971  -1.08038000e+09  2.45521800e+10   7.1918  122.9003</span></span></code></pre></div>
<p>We could easily compute these statistics by region:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">qsu</span>(wlddev, <span class="dt">by =</span> <span class="op">~</span>region, <span class="dt">cols =</span> <span class="dv">9</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">vlabels =</span> <span class="ot">TRUE</span>, <span class="dt">higher =</span> <span class="ot">TRUE</span>) </span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="co"># , , PCGDP: GDP per capita (constant 2010 US$)</span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="co"># </span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co">#                                N        Mean          SD         Min         Max    Skew     Kurt</span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="co"># East Asia &amp; Pacific         1391  10337.0463  14094.8338    131.9634  72183.3033  1.6378   4.7544</span></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="co"># Europe &amp; Central Asia       2084  25664.8064   26181.671    367.0493   191586.64  2.0987   9.2794</span></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="co"># Latin America &amp; Caribbean   1896   6976.0649   6705.5377    662.2795   42491.454  2.1357   7.9172</span></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="co"># Middle East &amp; North Africa   805  13760.2761  18374.2208    570.5574  113682.038  2.4215   9.6667</span></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="co"># North America                170  43650.5193  18345.0419  17550.5732  94903.1915  0.9047   3.3501</span></span>
<span id="cb8-10"><a href="#cb8-10"></a><span class="co"># South Asia                   366   1178.3447   1581.2678    267.0736   8971.1285  3.0144  11.8985</span></span>
<span id="cb8-11"><a href="#cb8-11"></a><span class="co"># Sub-Saharan Africa          2283   1750.0069   2553.7889    131.6464  20333.9404   3.209  15.1549</span></span>
<span id="cb8-12"><a href="#cb8-12"></a><span class="co"># </span></span>
<span id="cb8-13"><a href="#cb8-13"></a><span class="co"># , , LIFEEX: Life expectancy at birth, total (years)</span></span>
<span id="cb8-14"><a href="#cb8-14"></a><span class="co"># </span></span>
<span id="cb8-15"><a href="#cb8-15"></a><span class="co">#                                N     Mean       SD      Min      Max     Skew    Kurt</span></span>
<span id="cb8-16"><a href="#cb8-16"></a><span class="co"># East Asia &amp; Pacific         1717  65.6493  10.1221   18.907   84.278  -0.8473  4.2562</span></span>
<span id="cb8-17"><a href="#cb8-17"></a><span class="co"># Europe &amp; Central Asia       2886  71.9323   5.4596   45.369  85.4171  -0.4758  3.9257</span></span>
<span id="cb8-18"><a href="#cb8-18"></a><span class="co"># Latin America &amp; Caribbean   1995  67.7473   7.2844   42.113  82.1902  -0.9721  3.7783</span></span>
<span id="cb8-19"><a href="#cb8-19"></a><span class="co"># Middle East &amp; North Africa  1163  65.7501   9.5211   34.361  82.4073    -0.76  2.8428</span></span>
<span id="cb8-20"><a href="#cb8-20"></a><span class="co"># North America                135  75.9931   3.4825  68.8978  82.3005   -0.144  1.9842</span></span>
<span id="cb8-21"><a href="#cb8-21"></a><span class="co"># South Asia                   456  56.7471  11.1073   32.292   77.339  -0.2666  2.1147</span></span>
<span id="cb8-22"><a href="#cb8-22"></a><span class="co"># Sub-Saharan Africa          2716  51.0007   8.5873    27.61  74.3949   0.1514  2.8059</span></span>
<span id="cb8-23"><a href="#cb8-23"></a><span class="co"># </span></span>
<span id="cb8-24"><a href="#cb8-24"></a><span class="co"># , , GINI: GINI index (World Bank estimate)</span></span>
<span id="cb8-25"><a href="#cb8-25"></a><span class="co"># </span></span>
<span id="cb8-26"><a href="#cb8-26"></a><span class="co">#                               N     Mean      SD   Min   Max     Skew    Kurt</span></span>
<span id="cb8-27"><a href="#cb8-27"></a><span class="co"># East Asia &amp; Pacific          92  38.5065  5.3684  27.8  55.4   0.4917    2.85</span></span>
<span id="cb8-28"><a href="#cb8-28"></a><span class="co"># Europe &amp; Central Asia       588   31.902  4.7383  16.2  48.4   0.2524  3.0724</span></span>
<span id="cb8-29"><a href="#cb8-29"></a><span class="co"># Latin America &amp; Caribbean   363  50.5664  5.3238  34.4  63.3  -0.0893  2.4511</span></span>
<span id="cb8-30"><a href="#cb8-30"></a><span class="co"># Middle East &amp; North Africa   76  36.1947  5.1244  27.6  47.4    0.109  1.9657</span></span>
<span id="cb8-31"><a href="#cb8-31"></a><span class="co"># North America                22  36.1636  3.9282    31  41.1   0.1481  1.3322</span></span>
<span id="cb8-32"><a href="#cb8-32"></a><span class="co"># South Asia                   39  34.1641  4.3411  25.9  43.8   0.2892  2.4065</span></span>
<span id="cb8-33"><a href="#cb8-33"></a><span class="co"># Sub-Saharan Africa          176  44.8165  8.3376  28.9  65.8    0.634  2.8286</span></span>
<span id="cb8-34"><a href="#cb8-34"></a><span class="co"># </span></span>
<span id="cb8-35"><a href="#cb8-35"></a><span class="co"># , , ODA: Net ODA received (constant 2015 US$)</span></span>
<span id="cb8-36"><a href="#cb8-36"></a><span class="co"># </span></span>
<span id="cb8-37"><a href="#cb8-37"></a><span class="co">#                                N            Mean              SD              Min             Max</span></span>
<span id="cb8-38"><a href="#cb8-38"></a><span class="co"># East Asia &amp; Pacific         1491      346,977686      615,361973  -1.08038000e+09  3.92003000e+09</span></span>
<span id="cb8-39"><a href="#cb8-39"></a><span class="co"># Europe &amp; Central Asia        751      394,089867      566,834650      -343,480000  4.64666000e+09</span></span>
<span id="cb8-40"><a href="#cb8-40"></a><span class="co"># Latin America &amp; Caribbean   1918      173,728368      259,343122      -512,730000  2.95163000e+09</span></span>
<span id="cb8-41"><a href="#cb8-41"></a><span class="co"># Middle East &amp; North Africa  1079      663,574245  1.40635884e+09      -169,710000  2.45521800e+10</span></span>
<span id="cb8-42"><a href="#cb8-42"></a><span class="co"># North America                 39      423846.154     9,678883.86       -14,520000       55,820000</span></span>
<span id="cb8-43"><a href="#cb8-43"></a><span class="co"># South Asia                   450  1.25150376e+09  1.56736667e+09            80000  8.53900000e+09</span></span>
<span id="cb8-44"><a href="#cb8-44"></a><span class="co"># Sub-Saharan Africa          2608      440,308474      596,033604       -16,780000  1.12780600e+10</span></span>
<span id="cb8-45"><a href="#cb8-45"></a><span class="co">#                               Skew     Kurt</span></span>
<span id="cb8-46"><a href="#cb8-46"></a><span class="co"># East Asia &amp; Pacific          2.712  11.3035</span></span>
<span id="cb8-47"><a href="#cb8-47"></a><span class="co"># Europe &amp; Central Asia       3.1673  15.5881</span></span>
<span id="cb8-48"><a href="#cb8-48"></a><span class="co"># Latin America &amp; Caribbean   3.1857  20.4058</span></span>
<span id="cb8-49"><a href="#cb8-49"></a><span class="co"># Middle East &amp; North Africa   7.176  91.7057</span></span>
<span id="cb8-50"><a href="#cb8-50"></a><span class="co"># North America               4.8406  29.1877</span></span>
<span id="cb8-51"><a href="#cb8-51"></a><span class="co"># South Asia                  1.8057   6.6894</span></span>
<span id="cb8-52"><a href="#cb8-52"></a><span class="co"># Sub-Saharan Africa          4.8992  57.6191</span></span></code></pre></div>
<p>Computing summary statistics by country is of course also possible but would be too much information. Fortunately <code>qsu</code> lets us do something much more powerful:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">qsu</span>(wlddev, <span class="dt">pid =</span> <span class="op">~</span><span class="st"> </span>iso3c, <span class="dt">cols =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">9</span><span class="op">:</span><span class="dv">12</span>), <span class="dt">vlabels =</span> <span class="ot">TRUE</span>, <span class="dt">higher =</span> <span class="ot">TRUE</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="co"># , , country: Country Name</span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co"># </span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co">#            N/T  Mean  SD  Min  Max  Skew  Kurt</span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="co"># Overall  12744     -   -    -    -     -     -</span></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="co"># Between    216     -   -    -    -     -     -</span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co"># Within      59     -   -    -    -     -     -</span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co"># </span></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="co"># , , year: Year</span></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co"># </span></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="co">#            N/T  Mean       SD   Min   Max  Skew    Kurt</span></span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="co"># Overall  12744  1989  17.0301  1960  2018    -0  1.7993</span></span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="co"># Between    216  1989        0  1989  1989     -       -</span></span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="co"># Within      59  1989  17.0301  1960  2018    -0  1.7993</span></span>
<span id="cb9-15"><a href="#cb9-15"></a><span class="co"># </span></span>
<span id="cb9-16"><a href="#cb9-16"></a><span class="co"># , , PCGDP: GDP per capita (constant 2010 US$)</span></span>
<span id="cb9-17"><a href="#cb9-17"></a><span class="co"># </span></span>
<span id="cb9-18"><a href="#cb9-18"></a><span class="co">#              N/T        Mean          SD          Min         Max    Skew     Kurt</span></span>
<span id="cb9-19"><a href="#cb9-19"></a><span class="co"># Overall     8995  11563.6529  18348.4052     131.6464   191586.64  3.1121  16.9585</span></span>
<span id="cb9-20"><a href="#cb9-20"></a><span class="co"># Between      203  12488.8577  19628.3668     255.3999  141165.083   3.214  17.2533</span></span>
<span id="cb9-21"><a href="#cb9-21"></a><span class="co"># Within   44.3103  11563.6529   6334.9523  -30529.0928   75348.067   0.696  17.0534</span></span>
<span id="cb9-22"><a href="#cb9-22"></a><span class="co"># </span></span>
<span id="cb9-23"><a href="#cb9-23"></a><span class="co"># , , LIFEEX: Life expectancy at birth, total (years)</span></span>
<span id="cb9-24"><a href="#cb9-24"></a><span class="co"># </span></span>
<span id="cb9-25"><a href="#cb9-25"></a><span class="co">#              N/T     Mean       SD      Min      Max     Skew    Kurt</span></span>
<span id="cb9-26"><a href="#cb9-26"></a><span class="co"># Overall    11068  63.8411  11.4497   18.907  85.4171  -0.6692  2.6458</span></span>
<span id="cb9-27"><a href="#cb9-27"></a><span class="co"># Between      207  64.5285  10.0235   39.349  85.4171  -0.5253  2.2298</span></span>
<span id="cb9-28"><a href="#cb9-28"></a><span class="co"># Within   53.4686  63.8411   5.8292  33.4671  83.8595  -0.2508  3.7497</span></span>
<span id="cb9-29"><a href="#cb9-29"></a><span class="co"># </span></span>
<span id="cb9-30"><a href="#cb9-30"></a><span class="co"># , , GINI: GINI index (World Bank estimate)</span></span>
<span id="cb9-31"><a href="#cb9-31"></a><span class="co"># </span></span>
<span id="cb9-32"><a href="#cb9-32"></a><span class="co">#             N/T     Mean      SD      Min      Max    Skew    Kurt</span></span>
<span id="cb9-33"><a href="#cb9-33"></a><span class="co"># Overall    1356  39.3976  9.6764     16.2     65.8  0.4613  2.2932</span></span>
<span id="cb9-34"><a href="#cb9-34"></a><span class="co"># Between     161  39.5799  8.3679  23.3667  61.7143  0.5169  2.6715</span></span>
<span id="cb9-35"><a href="#cb9-35"></a><span class="co"># Within   8.4224  39.3976  3.0406  23.9576  54.7976  0.1421  5.7781</span></span>
<span id="cb9-36"><a href="#cb9-36"></a><span class="co"># </span></span>
<span id="cb9-37"><a href="#cb9-37"></a><span class="co"># , , ODA: Net ODA received (constant 2015 US$)</span></span>
<span id="cb9-38"><a href="#cb9-38"></a><span class="co"># </span></span>
<span id="cb9-39"><a href="#cb9-39"></a><span class="co">#              N/T        Mean          SD              Min             Max     Skew      Kurt</span></span>
<span id="cb9-40"><a href="#cb9-40"></a><span class="co"># Overall     8336  428,746468  819,868971  -1.08038000e+09  2.45521800e+10   7.1918  122.9003</span></span>
<span id="cb9-41"><a href="#cb9-41"></a><span class="co"># Between      178  418,026522  548,293709       423846.154  3.53258914e+09   2.4742   10.6503</span></span>
<span id="cb9-42"><a href="#cb9-42"></a><span class="co"># Within   46.8315  428,746468  607,024040  -2.47969577e+09  2.35093916e+10  10.3024  298.1213</span></span></code></pre></div>
<p>The above output reports 3 sets of summary statistics for each variable: Statistics computed on the <em>Overall</em> (raw) data, and on the <em>Between</em>-country (i.e. country averaged) and <em>Within</em>-country (i.e. country-demeaned) data<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. This is a powerful way to summarize panel data because aggregating the data by country gives us a cross-section of countries with no variation over time, whereas subtracting country specific means from the data eliminates the variation between countries. Thus we summarize the variation in our panel in 3 different ways: First we consider the raw data, then we create a cross-section of countries and summarize that, and then we sweep that cross-section out of the raw data and pretend we have a time series.</p>
<p>So what can these statistics tell us about our data? The <code>N/T</code> columns shows that for <code>PCGDP</code> we have 8995 total observations, that we observe GDP data for 203 countries and that we have on average 44.3 observations (time-periods) per country. In contrast the GINI Index is only available for 161 countries with 8.4 observations on average. The <em>Overall</em> and <em>Within</em> mean of the data are identical by definition, and the <em>Between</em> mean would also be the same in a balanced panel with no missing observations. In practice we have unequal amounts of observations for different countries, thus countries have different weights in the <em>Overall</em> mean and the difference between <em>Overall</em> and <em>Between</em>-country mean reflects this discrepancy. The most interesting statistic in this summary arguably is the standard deviation, and in particular the comparison of the <em>Between</em>-SD reflecting the variation between countries and the <em>Within</em>-SD reflecting average variation over time. This comparison shows that PCGDP, LIFEEX and GINI vary more between countries, but ODA received varies more within countries over time. The 0 <em>Between</em>-SD for the year variable and the fact that the <em>Overall</em> and <em>Within</em>-SD are equal shows that year is individual invariant. Thus <code>qsu</code> also provides the same information as <code>varying</code>, but with additional details on the relative magnitudes of cross-sectional and time series variation. It is also a common pattern that the <em>kurtosis</em> increases in within-transformed data, while the <em>skewness</em> decreases in most cases.</p>
<!-- and `qsu` is extremely fast (< 1 millisecond for basically all computations on this data with a moderate laptop) -->
<!-- Since `wlddev` is a panel dataset, we would normally like to obtain statistics not just on the overall variation in the data, but also on the variation between country averages vs. the variation within countries over time. We might also be interested in higher moments such as the *skewness* and the *kurtosis*. Such a summary is easily implemented using `qsu`:  -->
<!-- The output above is a 3D array of statistics which can also be subsetted (`[`) or permuted using `aperm()`. For each variable statistics are computed on the *Overall* (raw) data, and on the *Between*-country and *Within*-country transformed data^[in the *Within* data, the overall mean was added back after subtracting out country means, to preserve the level of the data, see also section 4.5.].  -->
<p>We could also do all of that by regions to have a look at the between and within country variations inside and across different World regions:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">qsu</span>(wlddev, <span class="dt">by =</span> <span class="op">~</span><span class="st"> </span>region, <span class="dt">pid =</span> <span class="op">~</span><span class="st"> </span>iso3c, <span class="dt">cols =</span> <span class="dv">9</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">vlabels =</span> <span class="ot">TRUE</span>, <span class="dt">higher =</span> <span class="ot">TRUE</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="co"># , , Overall, PCGDP: GDP per capita (constant 2010 US$)</span></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="co"># </span></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="co">#                              N/T        Mean          SD         Min         Max    Skew     Kurt</span></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="co"># East Asia &amp; Pacific         1391  10337.0463  14094.8338    131.9634  72183.3033  1.6378   4.7544</span></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="co"># Europe &amp; Central Asia       2084  25664.8064   26181.671    367.0493   191586.64  2.0987   9.2794</span></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="co"># Latin America &amp; Caribbean   1896   6976.0649   6705.5377    662.2795   42491.454  2.1357   7.9172</span></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="co"># Middle East &amp; North Africa   805  13760.2761  18374.2208    570.5574  113682.038  2.4215   9.6667</span></span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="co"># North America                170  43650.5193  18345.0419  17550.5732  94903.1915  0.9047   3.3501</span></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="co"># South Asia                   366   1178.3447   1581.2678    267.0736   8971.1285  3.0144  11.8985</span></span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="co"># Sub-Saharan Africa          2283   1750.0069   2553.7889    131.6464  20333.9404   3.209  15.1549</span></span>
<span id="cb10-12"><a href="#cb10-12"></a><span class="co"># </span></span>
<span id="cb10-13"><a href="#cb10-13"></a><span class="co"># , , Between, PCGDP: GDP per capita (constant 2010 US$)</span></span>
<span id="cb10-14"><a href="#cb10-14"></a><span class="co"># </span></span>
<span id="cb10-15"><a href="#cb10-15"></a><span class="co">#                             N/T        Mean          SD         Min         Max    Skew     Kurt</span></span>
<span id="cb10-16"><a href="#cb10-16"></a><span class="co"># East Asia &amp; Pacific          34  10337.0463    12576.62    410.2004  40046.4089  1.1707   2.7873</span></span>
<span id="cb10-17"><a href="#cb10-17"></a><span class="co"># Europe &amp; Central Asia        56  25664.8064  24008.1006    788.0229  141165.083  1.9279   8.4878</span></span>
<span id="cb10-18"><a href="#cb10-18"></a><span class="co"># Latin America &amp; Caribbean    36   6976.0649   6294.8452    884.5499  36049.6948  2.1451   7.9744</span></span>
<span id="cb10-19"><a href="#cb10-19"></a><span class="co"># Middle East &amp; North Africa   20  13760.2761  17291.0461   1084.5999  65963.2711  1.9946   6.2755</span></span>
<span id="cb10-20"><a href="#cb10-20"></a><span class="co"># North America                 3  43650.5193  12062.9919  35346.4194  61278.2411  0.7832   1.6136</span></span>
<span id="cb10-21"><a href="#cb10-21"></a><span class="co"># South Asia                    8   1178.3447   1470.7041    397.4451   6638.3501  3.1759  12.0293</span></span>
<span id="cb10-22"><a href="#cb10-22"></a><span class="co"># Sub-Saharan Africa           46   1750.0069   2199.9901    255.3999    9916.656  2.2221   7.2472</span></span>
<span id="cb10-23"><a href="#cb10-23"></a><span class="co"># </span></span>
<span id="cb10-24"><a href="#cb10-24"></a><span class="co"># , , Within, PCGDP: GDP per capita (constant 2010 US$)</span></span>
<span id="cb10-25"><a href="#cb10-25"></a><span class="co"># </span></span>
<span id="cb10-26"><a href="#cb10-26"></a><span class="co">#                                 N/T        Mean          SD          Min         Max     Skew</span></span>
<span id="cb10-27"><a href="#cb10-27"></a><span class="co"># East Asia &amp; Pacific         40.9118  11563.6529   6363.4087  -11892.0702  50475.9873   0.9072</span></span>
<span id="cb10-28"><a href="#cb10-28"></a><span class="co"># Europe &amp; Central Asia       37.2143  11563.6529  10444.6637  -30529.0928   75348.067   0.3914</span></span>
<span id="cb10-29"><a href="#cb10-29"></a><span class="co"># Latin America &amp; Caribbean   52.6667  11563.6529   2310.6622    -519.1743  21734.0427   0.0638</span></span>
<span id="cb10-30"><a href="#cb10-30"></a><span class="co"># Middle East &amp; North Africa    40.25  11563.6529   6215.4419  -18492.1455       60152   1.7628</span></span>
<span id="cb10-31"><a href="#cb10-31"></a><span class="co"># North America               56.6667  11563.6529  13821.1717  -21876.1952  45188.6033  -0.0258</span></span>
<span id="cb10-32"><a href="#cb10-32"></a><span class="co"># South Asia                    45.75  11563.6529    580.8934    9525.9724  13896.4313   1.0243</span></span>
<span id="cb10-33"><a href="#cb10-33"></a><span class="co"># Sub-Saharan Africa          49.6304  11563.6529   1296.8738    4528.6387  24375.5944   1.5433</span></span>
<span id="cb10-34"><a href="#cb10-34"></a><span class="co">#                                Kurt</span></span>
<span id="cb10-35"><a href="#cb10-35"></a><span class="co"># East Asia &amp; Pacific          9.3702</span></span>
<span id="cb10-36"><a href="#cb10-36"></a><span class="co"># Europe &amp; Central Asia        7.3036</span></span>
<span id="cb10-37"><a href="#cb10-37"></a><span class="co"># Latin America &amp; Caribbean    7.8009</span></span>
<span id="cb10-38"><a href="#cb10-38"></a><span class="co"># Middle East &amp; North Africa  22.4172</span></span>
<span id="cb10-39"><a href="#cb10-39"></a><span class="co"># North America                2.8074</span></span>
<span id="cb10-40"><a href="#cb10-40"></a><span class="co"># South Asia                   6.3765</span></span>
<span id="cb10-41"><a href="#cb10-41"></a><span class="co"># Sub-Saharan Africa          29.8043</span></span>
<span id="cb10-42"><a href="#cb10-42"></a><span class="co"># </span></span>
<span id="cb10-43"><a href="#cb10-43"></a><span class="co"># , , Overall, LIFEEX: Life expectancy at birth, total (years)</span></span>
<span id="cb10-44"><a href="#cb10-44"></a><span class="co"># </span></span>
<span id="cb10-45"><a href="#cb10-45"></a><span class="co">#                              N/T     Mean       SD      Min      Max     Skew    Kurt</span></span>
<span id="cb10-46"><a href="#cb10-46"></a><span class="co"># East Asia &amp; Pacific         1717  65.6493  10.1221   18.907   84.278  -0.8473  4.2562</span></span>
<span id="cb10-47"><a href="#cb10-47"></a><span class="co"># Europe &amp; Central Asia       2886  71.9323   5.4596   45.369  85.4171  -0.4758  3.9257</span></span>
<span id="cb10-48"><a href="#cb10-48"></a><span class="co"># Latin America &amp; Caribbean   1995  67.7473   7.2844   42.113  82.1902  -0.9721  3.7783</span></span>
<span id="cb10-49"><a href="#cb10-49"></a><span class="co"># Middle East &amp; North Africa  1163  65.7501   9.5211   34.361  82.4073    -0.76  2.8428</span></span>
<span id="cb10-50"><a href="#cb10-50"></a><span class="co"># North America                135  75.9931   3.4825  68.8978  82.3005   -0.144  1.9842</span></span>
<span id="cb10-51"><a href="#cb10-51"></a><span class="co"># South Asia                   456  56.7471  11.1073   32.292   77.339  -0.2666  2.1147</span></span>
<span id="cb10-52"><a href="#cb10-52"></a><span class="co"># Sub-Saharan Africa          2716  51.0007   8.5873    27.61  74.3949   0.1514  2.8059</span></span>
<span id="cb10-53"><a href="#cb10-53"></a><span class="co"># </span></span>
<span id="cb10-54"><a href="#cb10-54"></a><span class="co"># , , Between, LIFEEX: Life expectancy at birth, total (years)</span></span>
<span id="cb10-55"><a href="#cb10-55"></a><span class="co"># </span></span>
<span id="cb10-56"><a href="#cb10-56"></a><span class="co">#                             N/T     Mean      SD      Min      Max     Skew    Kurt</span></span>
<span id="cb10-57"><a href="#cb10-57"></a><span class="co"># East Asia &amp; Pacific          32  65.6493  7.7148  48.8626  77.5681  -0.3937   2.488</span></span>
<span id="cb10-58"><a href="#cb10-58"></a><span class="co"># Europe &amp; Central Asia        55  71.9323  4.2526  61.9424  85.4171  -0.5323  2.5438</span></span>
<span id="cb10-59"><a href="#cb10-59"></a><span class="co"># Latin America &amp; Caribbean    40  67.7473  4.9716  53.4959  82.1902  -0.9638  4.0726</span></span>
<span id="cb10-60"><a href="#cb10-60"></a><span class="co"># Middle East &amp; North Africa   21  65.7501  5.8655  53.0192   76.401  -0.2274  2.8315</span></span>
<span id="cb10-61"><a href="#cb10-61"></a><span class="co"># North America                 3  75.9931  1.2682  74.6066  77.9553   0.0859  1.5491</span></span>
<span id="cb10-62"><a href="#cb10-62"></a><span class="co"># South Asia                    8  56.7471  5.8027  47.8822  68.6733   0.5542   3.008</span></span>
<span id="cb10-63"><a href="#cb10-63"></a><span class="co"># Sub-Saharan Africa           48  51.0007  5.9389   39.349   71.403   1.0178  4.5846</span></span>
<span id="cb10-64"><a href="#cb10-64"></a><span class="co"># </span></span>
<span id="cb10-65"><a href="#cb10-65"></a><span class="co"># , , Within, LIFEEX: Life expectancy at birth, total (years)</span></span>
<span id="cb10-66"><a href="#cb10-66"></a><span class="co"># </span></span>
<span id="cb10-67"><a href="#cb10-67"></a><span class="co">#                                 N/T     Mean      SD      Min      Max     Skew    Kurt</span></span>
<span id="cb10-68"><a href="#cb10-68"></a><span class="co"># East Asia &amp; Pacific         53.6562  63.8411  6.5528  33.4671  83.8595  -0.3476  3.9061</span></span>
<span id="cb10-69"><a href="#cb10-69"></a><span class="co"># Europe &amp; Central Asia       52.4727  63.8411  3.4239  46.6863  77.0723  -0.0902  3.8904</span></span>
<span id="cb10-70"><a href="#cb10-70"></a><span class="co"># Latin America &amp; Caribbean    49.875  63.8411  5.3241  47.1311  78.2611  -0.3366  2.9553</span></span>
<span id="cb10-71"><a href="#cb10-71"></a><span class="co"># Middle East &amp; North Africa   55.381  63.8411  7.4998  41.8394  78.4739  -0.5889  2.7235</span></span>
<span id="cb10-72"><a href="#cb10-72"></a><span class="co"># North America                    45  63.8411  3.2433  54.7836   69.485  -0.3624  2.2514</span></span>
<span id="cb10-73"><a href="#cb10-73"></a><span class="co"># South Asia                       57  63.8411  9.4711  42.0094  82.0276  -0.0422  2.1366</span></span>
<span id="cb10-74"><a href="#cb10-74"></a><span class="co"># Sub-Saharan Africa          56.5833  63.8411  6.2025  43.7422  83.2612   0.0559  2.8488</span></span>
<span id="cb10-75"><a href="#cb10-75"></a><span class="co"># </span></span>
<span id="cb10-76"><a href="#cb10-76"></a><span class="co"># , , Overall, GINI: GINI index (World Bank estimate)</span></span>
<span id="cb10-77"><a href="#cb10-77"></a><span class="co"># </span></span>
<span id="cb10-78"><a href="#cb10-78"></a><span class="co">#                             N/T     Mean      SD   Min   Max     Skew    Kurt</span></span>
<span id="cb10-79"><a href="#cb10-79"></a><span class="co"># East Asia &amp; Pacific          92  38.5065  5.3684  27.8  55.4   0.4917    2.85</span></span>
<span id="cb10-80"><a href="#cb10-80"></a><span class="co"># Europe &amp; Central Asia       588   31.902  4.7383  16.2  48.4   0.2524  3.0724</span></span>
<span id="cb10-81"><a href="#cb10-81"></a><span class="co"># Latin America &amp; Caribbean   363  50.5664  5.3238  34.4  63.3  -0.0893  2.4511</span></span>
<span id="cb10-82"><a href="#cb10-82"></a><span class="co"># Middle East &amp; North Africa   76  36.1947  5.1244  27.6  47.4    0.109  1.9657</span></span>
<span id="cb10-83"><a href="#cb10-83"></a><span class="co"># North America                22  36.1636  3.9282    31  41.1   0.1481  1.3322</span></span>
<span id="cb10-84"><a href="#cb10-84"></a><span class="co"># South Asia                   39  34.1641  4.3411  25.9  43.8   0.2892  2.4065</span></span>
<span id="cb10-85"><a href="#cb10-85"></a><span class="co"># Sub-Saharan Africa          176  44.8165  8.3376  28.9  65.8    0.634  2.8286</span></span>
<span id="cb10-86"><a href="#cb10-86"></a><span class="co"># </span></span>
<span id="cb10-87"><a href="#cb10-87"></a><span class="co"># , , Between, GINI: GINI index (World Bank estimate)</span></span>
<span id="cb10-88"><a href="#cb10-88"></a><span class="co"># </span></span>
<span id="cb10-89"><a href="#cb10-89"></a><span class="co">#                             N/T     Mean      SD      Min      Max     Skew    Kurt</span></span>
<span id="cb10-90"><a href="#cb10-90"></a><span class="co"># East Asia &amp; Pacific          21  38.5065  4.8352     30.8    48.65   0.1913  1.9261</span></span>
<span id="cb10-91"><a href="#cb10-91"></a><span class="co"># Europe &amp; Central Asia        47   31.902   4.054  23.3667     40.8   0.3926  2.5421</span></span>
<span id="cb10-92"><a href="#cb10-92"></a><span class="co"># Latin America &amp; Caribbean    25  50.5664  4.0186     41.1  57.7333  -0.0433  2.2618</span></span>
<span id="cb10-93"><a href="#cb10-93"></a><span class="co"># Middle East &amp; North Africa   14  36.1947  4.6346    29.05  43.0667  -0.1349  1.7987</span></span>
<span id="cb10-94"><a href="#cb10-94"></a><span class="co"># North America                 2  36.1636  3.5731  32.6727  39.6545       -0       1</span></span>
<span id="cb10-95"><a href="#cb10-95"></a><span class="co"># South Asia                    7  34.1641  3.4562  30.3556    39.85   0.2502  1.3567</span></span>
<span id="cb10-96"><a href="#cb10-96"></a><span class="co"># Sub-Saharan Africa           45  44.8165  7.0733    31.45  61.7143   0.8873  3.1577</span></span>
<span id="cb10-97"><a href="#cb10-97"></a><span class="co"># </span></span>
<span id="cb10-98"><a href="#cb10-98"></a><span class="co"># , , Within, GINI: GINI index (World Bank estimate)</span></span>
<span id="cb10-99"><a href="#cb10-99"></a><span class="co"># </span></span>
<span id="cb10-100"><a href="#cb10-100"></a><span class="co">#                                 N/T     Mean      SD      Min      Max     Skew    Kurt</span></span>
<span id="cb10-101"><a href="#cb10-101"></a><span class="co"># East Asia &amp; Pacific           4.381  39.3976  2.3325  32.6476  46.1476   0.0321  4.2462</span></span>
<span id="cb10-102"><a href="#cb10-102"></a><span class="co"># Europe &amp; Central Asia       12.5106  39.3976  2.4529   28.636  54.4976   0.8011  9.7301</span></span>
<span id="cb10-103"><a href="#cb10-103"></a><span class="co"># Latin America &amp; Caribbean     14.52  39.3976  3.4921  26.3076  48.7365  -0.2144  3.0356</span></span>
<span id="cb10-104"><a href="#cb10-104"></a><span class="co"># Middle East &amp; North Africa   5.4286  39.3976  2.1863  32.6309  46.6404   0.0424  5.2628</span></span>
<span id="cb10-105"><a href="#cb10-105"></a><span class="co"># North America                    11  39.3976  1.6323   34.343   40.843  -1.4734  5.0766</span></span>
<span id="cb10-106"><a href="#cb10-106"></a><span class="co"># South Asia                   5.5714  39.3976  2.6268  34.6726  45.9309   0.0038  2.5971</span></span>
<span id="cb10-107"><a href="#cb10-107"></a><span class="co"># Sub-Saharan Africa           3.9111  39.3976  4.4142  23.9576  54.7976   0.1224  4.1458</span></span>
<span id="cb10-108"><a href="#cb10-108"></a><span class="co"># </span></span>
<span id="cb10-109"><a href="#cb10-109"></a><span class="co"># , , Overall, ODA: Net ODA received (constant 2015 US$)</span></span>
<span id="cb10-110"><a href="#cb10-110"></a><span class="co"># </span></span>
<span id="cb10-111"><a href="#cb10-111"></a><span class="co">#                              N/T            Mean              SD              Min             Max</span></span>
<span id="cb10-112"><a href="#cb10-112"></a><span class="co"># East Asia &amp; Pacific         1491      346,977686      615,361973  -1.08038000e+09  3.92003000e+09</span></span>
<span id="cb10-113"><a href="#cb10-113"></a><span class="co"># Europe &amp; Central Asia        751      394,089867      566,834650      -343,480000  4.64666000e+09</span></span>
<span id="cb10-114"><a href="#cb10-114"></a><span class="co"># Latin America &amp; Caribbean   1918      173,728368      259,343122      -512,730000  2.95163000e+09</span></span>
<span id="cb10-115"><a href="#cb10-115"></a><span class="co"># Middle East &amp; North Africa  1079      663,574245  1.40635884e+09      -169,710000  2.45521800e+10</span></span>
<span id="cb10-116"><a href="#cb10-116"></a><span class="co"># North America                 39      423846.154     9,678883.86       -14,520000       55,820000</span></span>
<span id="cb10-117"><a href="#cb10-117"></a><span class="co"># South Asia                   450  1.25150376e+09  1.56736667e+09            80000  8.53900000e+09</span></span>
<span id="cb10-118"><a href="#cb10-118"></a><span class="co"># Sub-Saharan Africa          2608      440,308474      596,033604       -16,780000  1.12780600e+10</span></span>
<span id="cb10-119"><a href="#cb10-119"></a><span class="co">#                               Skew     Kurt</span></span>
<span id="cb10-120"><a href="#cb10-120"></a><span class="co"># East Asia &amp; Pacific          2.712  11.3035</span></span>
<span id="cb10-121"><a href="#cb10-121"></a><span class="co"># Europe &amp; Central Asia       3.1673  15.5881</span></span>
<span id="cb10-122"><a href="#cb10-122"></a><span class="co"># Latin America &amp; Caribbean   3.1857  20.4058</span></span>
<span id="cb10-123"><a href="#cb10-123"></a><span class="co"># Middle East &amp; North Africa   7.176  91.7057</span></span>
<span id="cb10-124"><a href="#cb10-124"></a><span class="co"># North America               4.8406  29.1877</span></span>
<span id="cb10-125"><a href="#cb10-125"></a><span class="co"># South Asia                  1.8057   6.6894</span></span>
<span id="cb10-126"><a href="#cb10-126"></a><span class="co"># Sub-Saharan Africa          4.8992  57.6191</span></span>
<span id="cb10-127"><a href="#cb10-127"></a><span class="co"># </span></span>
<span id="cb10-128"><a href="#cb10-128"></a><span class="co"># , , Between, ODA: Net ODA received (constant 2015 US$)</span></span>
<span id="cb10-129"><a href="#cb10-129"></a><span class="co"># </span></span>
<span id="cb10-130"><a href="#cb10-130"></a><span class="co">#                             N/T            Mean              SD          Min             Max    Skew</span></span>
<span id="cb10-131"><a href="#cb10-131"></a><span class="co"># East Asia &amp; Pacific          31      346,977686      460,186340  1,550512.82  1.64164241e+09  1.8351</span></span>
<span id="cb10-132"><a href="#cb10-132"></a><span class="co"># Europe &amp; Central Asia        32      394,089867      446,099453  12,115777.8  2.16970133e+09  2.2773</span></span>
<span id="cb10-133"><a href="#cb10-133"></a><span class="co"># Latin America &amp; Caribbean    37      173,728368      169,248215  2,089677.42      560,007241  0.9171</span></span>
<span id="cb10-134"><a href="#cb10-134"></a><span class="co"># Middle East &amp; North Africa   21      663,574245      725,711345  2,946923.08  2.73873224e+09  1.2769</span></span>
<span id="cb10-135"><a href="#cb10-135"></a><span class="co"># North America                 1      423846.154               0   423846.154      423846.154       -</span></span>
<span id="cb10-136"><a href="#cb10-136"></a><span class="co"># South Asia                    8  1.25150376e+09  1.15946284e+09  25,663448.3  3.53258914e+09  0.7083</span></span>
<span id="cb10-137"><a href="#cb10-137"></a><span class="co"># Sub-Saharan Africa           48      440,308474      357,457530  27,340689.7  1.41753857e+09  0.9724</span></span>
<span id="cb10-138"><a href="#cb10-138"></a><span class="co">#                               Kurt</span></span>
<span id="cb10-139"><a href="#cb10-139"></a><span class="co"># East Asia &amp; Pacific         5.3242</span></span>
<span id="cb10-140"><a href="#cb10-140"></a><span class="co"># Europe &amp; Central Asia       8.5531</span></span>
<span id="cb10-141"><a href="#cb10-141"></a><span class="co"># Latin America &amp; Caribbean   2.5611</span></span>
<span id="cb10-142"><a href="#cb10-142"></a><span class="co"># Middle East &amp; North Africa  4.0978</span></span>
<span id="cb10-143"><a href="#cb10-143"></a><span class="co"># North America                    -</span></span>
<span id="cb10-144"><a href="#cb10-144"></a><span class="co"># South Asia                  2.3441</span></span>
<span id="cb10-145"><a href="#cb10-145"></a><span class="co"># Sub-Saharan Africa          3.1001</span></span>
<span id="cb10-146"><a href="#cb10-146"></a><span class="co"># </span></span>
<span id="cb10-147"><a href="#cb10-147"></a><span class="co"># , , Within, ODA: Net ODA received (constant 2015 US$)</span></span>
<span id="cb10-148"><a href="#cb10-148"></a><span class="co"># </span></span>
<span id="cb10-149"><a href="#cb10-149"></a><span class="co">#                                 N/T        Mean              SD              Min             Max</span></span>
<span id="cb10-150"><a href="#cb10-150"></a><span class="co"># East Asia &amp; Pacific         48.0968  428,746468      408,532605  -2.18778866e+09  3.57867647e+09</span></span>
<span id="cb10-151"><a href="#cb10-151"></a><span class="co"># Europe &amp; Central Asia       23.4688  428,746468      349,709591  -1.14106420e+09  3.01475819e+09</span></span>
<span id="cb10-152"><a href="#cb10-152"></a><span class="co"># Latin America &amp; Caribbean   51.8378  428,746468      196,504190      -579,470773  2.97543078e+09</span></span>
<span id="cb10-153"><a href="#cb10-153"></a><span class="co"># Middle East &amp; North Africa   51.381  428,746468  1.20465275e+09  -2.47969577e+09  2.35093916e+10</span></span>
<span id="cb10-154"><a href="#cb10-154"></a><span class="co"># North America                    39  428,746468     9,678883.86       413,802622      484,142622</span></span>
<span id="cb10-155"><a href="#cb10-155"></a><span class="co"># South Asia                    56.25  428,746468  1.05464885e+09  -2.37972267e+09  5.51177302e+09</span></span>
<span id="cb10-156"><a href="#cb10-156"></a><span class="co"># Sub-Saharan Africa          54.3333  428,746468      476,948814      -825,184566  1.07855444e+10</span></span>
<span id="cb10-157"><a href="#cb10-157"></a><span class="co">#                               Skew      Kurt</span></span>
<span id="cb10-158"><a href="#cb10-158"></a><span class="co"># East Asia &amp; Pacific          0.148   14.9208</span></span>
<span id="cb10-159"><a href="#cb10-159"></a><span class="co"># Europe &amp; Central Asia        2.161   17.7781</span></span>
<span id="cb10-160"><a href="#cb10-160"></a><span class="co"># Latin America &amp; Caribbean   3.4431   37.7999</span></span>
<span id="cb10-161"><a href="#cb10-161"></a><span class="co"># Middle East &amp; North Africa  8.6743  139.5562</span></span>
<span id="cb10-162"><a href="#cb10-162"></a><span class="co"># North America               4.8406   29.1877</span></span>
<span id="cb10-163"><a href="#cb10-163"></a><span class="co"># South Asia                  2.0067   10.5477</span></span>
<span id="cb10-164"><a href="#cb10-164"></a><span class="co"># Sub-Saharan Africa          5.9273  104.1212</span></span></code></pre></div>
<p>Notice that the output here is a 4D array of summary statistics, which we could also subset (<code>[</code>) or permute (<code>aperm</code>) to view these statistics in any convenient way. If we don’t like the array, we can also output as a nested list of statistics matrices:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>l &lt;-<span class="st"> </span><span class="kw">qsu</span>(wlddev, <span class="dt">by =</span> <span class="op">~</span><span class="st"> </span>region, <span class="dt">pid =</span> <span class="op">~</span><span class="st"> </span>iso3c, <span class="dt">cols =</span> <span class="dv">9</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">vlabels =</span> <span class="ot">TRUE</span>, </span>
<span id="cb11-2"><a href="#cb11-2"></a>         <span class="dt">higher =</span> <span class="ot">TRUE</span>, <span class="dt">array =</span> <span class="ot">FALSE</span>)</span>
<span id="cb11-3"><a href="#cb11-3"></a></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="kw">str</span>(l, <span class="dt">give.attr =</span> <span class="ot">FALSE</span>)</span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="co"># List of 4</span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="co">#  $ PCGDP: GDP per capita (constant 2010 US$)      :List of 3</span></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="co">#   ..$ Overall: &#39;qsu&#39; num [1:7, 1:7] 1391 2084 1896 805 170 ...</span></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="co">#   ..$ Between: &#39;qsu&#39; num [1:7, 1:7] 34 56 36 20 3 ...</span></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="co">#   ..$ Within : &#39;qsu&#39; num [1:7, 1:7] 40.9 37.2 52.7 40.2 56.7 ...</span></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="co">#  $ LIFEEX: Life expectancy at birth, total (years):List of 3</span></span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="co">#   ..$ Overall: &#39;qsu&#39; num [1:7, 1:7] 1717 2886 1995 1163 135 ...</span></span>
<span id="cb11-12"><a href="#cb11-12"></a><span class="co">#   ..$ Between: &#39;qsu&#39; num [1:7, 1:7] 32 55 40 21 3 ...</span></span>
<span id="cb11-13"><a href="#cb11-13"></a><span class="co">#   ..$ Within : &#39;qsu&#39; num [1:7, 1:7] 53.7 52.5 49.9 55.4 45 ...</span></span>
<span id="cb11-14"><a href="#cb11-14"></a><span class="co">#  $ GINI: GINI index (World Bank estimate)         :List of 3</span></span>
<span id="cb11-15"><a href="#cb11-15"></a><span class="co">#   ..$ Overall: &#39;qsu&#39; num [1:7, 1:7] 92 588 363 76 22 ...</span></span>
<span id="cb11-16"><a href="#cb11-16"></a><span class="co">#   ..$ Between: &#39;qsu&#39; num [1:7, 1:7] 21 47 25 14 2 ...</span></span>
<span id="cb11-17"><a href="#cb11-17"></a><span class="co">#   ..$ Within : &#39;qsu&#39; num [1:7, 1:7] 4.38 12.51 14.52 5.43 11 ...</span></span>
<span id="cb11-18"><a href="#cb11-18"></a><span class="co">#  $ ODA: Net ODA received (constant 2015 US$)      :List of 3</span></span>
<span id="cb11-19"><a href="#cb11-19"></a><span class="co">#   ..$ Overall: &#39;qsu&#39; num [1:7, 1:7] 1491 751 1918 1079 39 ...</span></span>
<span id="cb11-20"><a href="#cb11-20"></a><span class="co">#   ..$ Between: &#39;qsu&#39; num [1:7, 1:7] 31 32 37 21 1 ...</span></span>
<span id="cb11-21"><a href="#cb11-21"></a><span class="co">#   ..$ Within : &#39;qsu&#39; num [1:7, 1:7] 48.1 23.5 51.8 51.4 39 ...</span></span></code></pre></div>
<p>Such a list of statistics matrices could, for example, be converted into a tidy data frame using <code>unlist2d</code> (more about this in the section on list-processing):</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw">head</span>(<span class="kw">unlist2d</span>(l, <span class="dt">idcols =</span> <span class="kw">c</span>(<span class="st">&quot;Variable&quot;</span>, <span class="st">&quot;Trans&quot;</span>), <span class="dt">row.names =</span> <span class="st">&quot;Region&quot;</span>))</span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="co">#                                    Variable   Trans                     Region    N      Mean</span></span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="co"># 1 PCGDP: GDP per capita (constant 2010 US$) Overall        East Asia &amp; Pacific 1391 10337.046</span></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="co"># 2 PCGDP: GDP per capita (constant 2010 US$) Overall      Europe &amp; Central Asia 2084 25664.806</span></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="co"># 3 PCGDP: GDP per capita (constant 2010 US$) Overall Latin America &amp; Caribbean  1896  6976.065</span></span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="co"># 4 PCGDP: GDP per capita (constant 2010 US$) Overall Middle East &amp; North Africa  805 13760.276</span></span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="co"># 5 PCGDP: GDP per capita (constant 2010 US$) Overall              North America  170 43650.519</span></span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="co"># 6 PCGDP: GDP per capita (constant 2010 US$) Overall                 South Asia  366  1178.345</span></span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="co">#          SD        Min        Max      Skew      Kurt</span></span>
<span id="cb12-10"><a href="#cb12-10"></a><span class="co"># 1 14094.834   131.9634  72183.303 1.6377612  4.754406</span></span>
<span id="cb12-11"><a href="#cb12-11"></a><span class="co"># 2 26181.671   367.0493 191586.640 2.0987365  9.279446</span></span>
<span id="cb12-12"><a href="#cb12-12"></a><span class="co"># 3  6705.538   662.2795  42491.454 2.1357240  7.917158</span></span>
<span id="cb12-13"><a href="#cb12-13"></a><span class="co"># 4 18374.221   570.5574 113682.038 2.4214546  9.666703</span></span>
<span id="cb12-14"><a href="#cb12-14"></a><span class="co"># 5 18345.042 17550.5732  94903.192 0.9047195  3.350085</span></span>
<span id="cb12-15"><a href="#cb12-15"></a><span class="co"># 6  1581.268   267.0736   8971.128 3.0144216 11.898500</span></span></code></pre></div>
<p>This is not yet end of <code>qsu</code>’s functionality, as we can also do all of the above on panel-surveys utilizing weights (<code>w</code> argument).</p>
<p>Finally, we can look at pairwise correlations in this data:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">pwcor</span>(wlddev[<span class="dv">9</span><span class="op">:</span><span class="dv">12</span>], <span class="dt">N =</span> <span class="ot">TRUE</span>, <span class="dt">P =</span> <span class="ot">TRUE</span>)</span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="co">#               PCGDP        LIFEEX         GINI          ODA</span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="co"># PCGDP    1   (8995)   .57* (8398) -.42* (1342) -.16* (6852)</span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="co"># LIFEEX  .57* (8398)   1   (11068) -.34* (1353) -.02* (7746)</span></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="co"># GINI   -.42* (1342)  -.34* (1353)   1   (1356)  -.17* (951)</span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="co"># ODA    -.16* (6852)  -.02* (7746)  -.17* (951)   1   (8336)</span></span></code></pre></div>
<p>which can of course also be computed on averaged and within-transformed data:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw">print</span>(<span class="kw">pwcor</span>(<span class="kw">fmean</span>(wlddev[<span class="dv">9</span><span class="op">:</span><span class="dv">12</span>], wlddev<span class="op">$</span>iso3c), <span class="dt">N =</span> <span class="ot">TRUE</span>, <span class="dt">P =</span> <span class="ot">TRUE</span>), <span class="dt">show =</span> <span class="st">&quot;lower.tri&quot;</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="co">#              PCGDP      LIFEEX        GINI         ODA</span></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="co"># PCGDP    1   (203)                                    </span></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="co"># LIFEEX  .60* (197)   1   (207)                        </span></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="co"># GINI   -.41* (159) -.41* (160)   1   (161)            </span></span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="co"># ODA    -.24* (169) -.18* (172) -.17  (139)   1   (178)</span></span>
<span id="cb14-7"><a href="#cb14-7"></a></span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="co"># N is same as overall N shown above...</span></span>
<span id="cb14-9"><a href="#cb14-9"></a><span class="kw">print</span>(<span class="kw">pwcor</span>(<span class="kw">fwithin</span>(wlddev[<span class="dv">9</span><span class="op">:</span><span class="dv">12</span>], wlddev<span class="op">$</span>iso3c), <span class="dt">P =</span> <span class="ot">TRUE</span>), <span class="dt">show =</span> <span class="st">&quot;lower.tri&quot;</span>)</span>
<span id="cb14-10"><a href="#cb14-10"></a><span class="co">#         PCGDP LIFEEX   GINI    ODA</span></span>
<span id="cb14-11"><a href="#cb14-11"></a><span class="co"># PCGDP     1                       </span></span>
<span id="cb14-12"><a href="#cb14-12"></a><span class="co"># LIFEEX   .30*    1                </span></span>
<span id="cb14-13"><a href="#cb14-13"></a><span class="co"># GINI    -.03   -.15*    1         </span></span>
<span id="cb14-14"><a href="#cb14-14"></a><span class="co"># ODA     -.01    .14*  -.02     1</span></span></code></pre></div>
<p>A useful function called by <code>pwcor</code> is <code>pwNobs</code>, which is very handy to explore the joint observation structure when selecting variables to include in a statistical model:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw">pwNobs</span>(wlddev)</span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="co">#         country iso3c  date  year decade region income  OECD PCGDP LIFEEX GINI  ODA</span></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="co"># country   12744 12744 12744 12744  12744  12744  12744 12744  8995  11068 1356 8336</span></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="co"># iso3c     12744 12744 12744 12744  12744  12744  12744 12744  8995  11068 1356 8336</span></span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="co"># date      12744 12744 12744 12744  12744  12744  12744 12744  8995  11068 1356 8336</span></span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="co"># year      12744 12744 12744 12744  12744  12744  12744 12744  8995  11068 1356 8336</span></span>
<span id="cb15-7"><a href="#cb15-7"></a><span class="co"># decade    12744 12744 12744 12744  12744  12744  12744 12744  8995  11068 1356 8336</span></span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="co"># region    12744 12744 12744 12744  12744  12744  12744 12744  8995  11068 1356 8336</span></span>
<span id="cb15-9"><a href="#cb15-9"></a><span class="co"># income    12744 12744 12744 12744  12744  12744  12744 12744  8995  11068 1356 8336</span></span>
<span id="cb15-10"><a href="#cb15-10"></a><span class="co"># OECD      12744 12744 12744 12744  12744  12744  12744 12744  8995  11068 1356 8336</span></span>
<span id="cb15-11"><a href="#cb15-11"></a><span class="co"># PCGDP      8995  8995  8995  8995   8995   8995   8995  8995  8995   8398 1342 6852</span></span>
<span id="cb15-12"><a href="#cb15-12"></a><span class="co"># LIFEEX    11068 11068 11068 11068  11068  11068  11068 11068  8398  11068 1353 7746</span></span>
<span id="cb15-13"><a href="#cb15-13"></a><span class="co"># GINI       1356  1356  1356  1356   1356   1356   1356  1356  1342   1353 1356  951</span></span>
<span id="cb15-14"><a href="#cb15-14"></a><span class="co"># ODA        8336  8336  8336  8336   8336   8336   8336  8336  6852   7746  951 8336</span></span></code></pre></div>
<p>Note that both <code>pwcor/pwcov</code> and <code>pwNobs</code> are faster on matrices. Weighted correlations are efficiently implemented in <code>weights::wtd.cors</code>.</p>
<!-- *Note:* Other distributional statistics like the *median* and *quantiles* are currently not implemented for reasons having to do with computation speed (>10x faster than `base::summary` and suitable for really large panels) and the algorithm^[`qsu` uses a numerically stable online algorithm generalized from Welford's Algorithm to compute variances.] behind `qsu`, but might come in a further update of `qsu`.  -->
</div>
<div id="ggdc10s---ggdc-10-sector-database" class="section level3">
<h3>1.2 <code>GGDC10S</code> - GGDC 10-Sector Database</h3>
<p>The Groningen Growth and Development Centre 10-Sector Database provides long-run data on sectoral productivity performance in Africa, Asia, and Latin America. Variables covered in the data set are annual series of value added (VA, in local currency), and persons employed (EMP) for 10 broad sectors.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw">head</span>(GGDC10S)</span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="co">#   Country Regioncode             Region Variable Year      AGR      MIN       MAN        PU</span></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="co"># 1     BWA        SSA Sub-saharan Africa       VA 1960       NA       NA        NA        NA</span></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="co"># 2     BWA        SSA Sub-saharan Africa       VA 1961       NA       NA        NA        NA</span></span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="co"># 3     BWA        SSA Sub-saharan Africa       VA 1962       NA       NA        NA        NA</span></span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="co"># 4     BWA        SSA Sub-saharan Africa       VA 1963       NA       NA        NA        NA</span></span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="co"># 5     BWA        SSA Sub-saharan Africa       VA 1964 16.30154 3.494075 0.7365696 0.1043936</span></span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="co"># 6     BWA        SSA Sub-saharan Africa       VA 1965 15.72700 2.495768 1.0181992 0.1350976</span></span>
<span id="cb16-9"><a href="#cb16-9"></a><span class="co">#         CON      WRT      TRA     FIRE      GOV      OTH      SUM</span></span>
<span id="cb16-10"><a href="#cb16-10"></a><span class="co"># 1        NA       NA       NA       NA       NA       NA       NA</span></span>
<span id="cb16-11"><a href="#cb16-11"></a><span class="co"># 2        NA       NA       NA       NA       NA       NA       NA</span></span>
<span id="cb16-12"><a href="#cb16-12"></a><span class="co"># 3        NA       NA       NA       NA       NA       NA       NA</span></span>
<span id="cb16-13"><a href="#cb16-13"></a><span class="co"># 4        NA       NA       NA       NA       NA       NA       NA</span></span>
<span id="cb16-14"><a href="#cb16-14"></a><span class="co"># 5 0.6600454 6.243732 1.658928 1.119194 4.822485 2.341328 37.48229</span></span>
<span id="cb16-15"><a href="#cb16-15"></a><span class="co"># 6 1.3462312 7.064825 1.939007 1.246789 5.695848 2.678338 39.34710</span></span>
<span id="cb16-16"><a href="#cb16-16"></a></span>
<span id="cb16-17"><a href="#cb16-17"></a><span class="kw">namlab</span>(GGDC10S, <span class="dt">class =</span> <span class="ot">TRUE</span>)</span>
<span id="cb16-18"><a href="#cb16-18"></a><span class="co">#      Variable     Class                                                 Label</span></span>
<span id="cb16-19"><a href="#cb16-19"></a><span class="co"># 1     Country character                                               Country</span></span>
<span id="cb16-20"><a href="#cb16-20"></a><span class="co"># 2  Regioncode character                                           Region code</span></span>
<span id="cb16-21"><a href="#cb16-21"></a><span class="co"># 3      Region character                                                Region</span></span>
<span id="cb16-22"><a href="#cb16-22"></a><span class="co"># 4    Variable character                                              Variable</span></span>
<span id="cb16-23"><a href="#cb16-23"></a><span class="co"># 5        Year   numeric                                                  Year</span></span>
<span id="cb16-24"><a href="#cb16-24"></a><span class="co"># 6         AGR   numeric                                          Agriculture </span></span>
<span id="cb16-25"><a href="#cb16-25"></a><span class="co"># 7         MIN   numeric                                                Mining</span></span>
<span id="cb16-26"><a href="#cb16-26"></a><span class="co"># 8         MAN   numeric                                         Manufacturing</span></span>
<span id="cb16-27"><a href="#cb16-27"></a><span class="co"># 9          PU   numeric                                             Utilities</span></span>
<span id="cb16-28"><a href="#cb16-28"></a><span class="co"># 10        CON   numeric                                          Construction</span></span>
<span id="cb16-29"><a href="#cb16-29"></a><span class="co"># 11        WRT   numeric                         Trade, restaurants and hotels</span></span>
<span id="cb16-30"><a href="#cb16-30"></a><span class="co"># 12        TRA   numeric                  Transport, storage and communication</span></span>
<span id="cb16-31"><a href="#cb16-31"></a><span class="co"># 13       FIRE   numeric Finance, insurance, real estate and business services</span></span>
<span id="cb16-32"><a href="#cb16-32"></a><span class="co"># 14        GOV   numeric                                   Government services</span></span>
<span id="cb16-33"><a href="#cb16-33"></a><span class="co"># 15        OTH   numeric               Community, social and personal services</span></span>
<span id="cb16-34"><a href="#cb16-34"></a><span class="co"># 16        SUM   numeric                               Summation of sector GDP</span></span>
<span id="cb16-35"><a href="#cb16-35"></a></span>
<span id="cb16-36"><a href="#cb16-36"></a><span class="kw">fNobs</span>(GGDC10S)</span>
<span id="cb16-37"><a href="#cb16-37"></a><span class="co">#    Country Regioncode     Region   Variable       Year        AGR        MIN        MAN         PU </span></span>
<span id="cb16-38"><a href="#cb16-38"></a><span class="co">#       5027       5027       5027       5027       5027       4364       4355       4355       4354 </span></span>
<span id="cb16-39"><a href="#cb16-39"></a><span class="co">#        CON        WRT        TRA       FIRE        GOV        OTH        SUM </span></span>
<span id="cb16-40"><a href="#cb16-40"></a><span class="co">#       4355       4355       4355       4355       3482       4248       4364</span></span>
<span id="cb16-41"><a href="#cb16-41"></a></span>
<span id="cb16-42"><a href="#cb16-42"></a><span class="kw">fNdistinct</span>(GGDC10S)</span>
<span id="cb16-43"><a href="#cb16-43"></a><span class="co">#    Country Regioncode     Region   Variable       Year        AGR        MIN        MAN         PU </span></span>
<span id="cb16-44"><a href="#cb16-44"></a><span class="co">#         43          6          6          2         67       4353       4224       4353       4237 </span></span>
<span id="cb16-45"><a href="#cb16-45"></a><span class="co">#        CON        WRT        TRA       FIRE        GOV        OTH        SUM </span></span>
<span id="cb16-46"><a href="#cb16-46"></a><span class="co">#       4339       4344       4334       4349       3470       4238       4364</span></span>
<span id="cb16-47"><a href="#cb16-47"></a></span>
<span id="cb16-48"><a href="#cb16-48"></a><span class="co"># The countries included:</span></span>
<span id="cb16-49"><a href="#cb16-49"></a><span class="kw">cat</span>(<span class="kw">funique</span>(GGDC10S<span class="op">$</span>Country, <span class="dt">ordered =</span> <span class="ot">TRUE</span>))</span>
<span id="cb16-50"><a href="#cb16-50"></a><span class="co"># BWA ETH GHA KEN MWI MUS NGA NGA(alt) SEN ZAF TZA ZMB CHN HKG IND IDN JPN KOR MYS PHL SGP TWN THA ARG BOL BRA CHL COL CRI MEX PER VEN USA DEW DNK ESP FRA GBR ITA NLD SWE MOR EGY</span></span></code></pre></div>
<p>The first problem in summarizing this data is that value added (VA) is in local currency, the second that it contains 2 different Variables (VA and EMP) stacked in the same column. One way of solving the first problem could be converting the data to percentages through dividing by the overall VA and EMP contained in the last column. A different solution involving grouped-scaling is introduced in section 6.4. The second problem is again nicely handled by <code>qsu</code>, which can also compute panel-statistics by groups.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># Converting data to percentages of overall VA / EMP, dapply keeps the attributes, see section 6.1</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>pGGDC10S &lt;-<span class="st"> </span><span class="kw">dapply</span>(GGDC10S[<span class="dv">6</span><span class="op">:</span><span class="dv">15</span>], <span class="st">`</span><span class="dt">*</span><span class="st">`</span>, <span class="dv">100</span> <span class="op">/</span><span class="st"> </span>GGDC10S<span class="op">$</span>SUM) </span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="co"># Summarizing the sectoral data by variable, overall, between and within countries</span></span>
<span id="cb17-4"><a href="#cb17-4"></a>su &lt;-<span class="st"> </span><span class="kw">qsu</span>(pGGDC10S, <span class="dt">by =</span> GGDC10S<span class="op">$</span>Variable, <span class="dt">pid =</span> GGDC10S[<span class="kw">c</span>(<span class="st">&quot;Variable&quot;</span>,<span class="st">&quot;Country&quot;</span>)], <span class="dt">higher =</span> <span class="ot">TRUE</span>) </span>
<span id="cb17-5"><a href="#cb17-5"></a></span>
<span id="cb17-6"><a href="#cb17-6"></a><span class="co"># This gives a 4D array of summary statistics</span></span>
<span id="cb17-7"><a href="#cb17-7"></a><span class="kw">str</span>(su)</span>
<span id="cb17-8"><a href="#cb17-8"></a><span class="co">#  &#39;qsu&#39; num [1:2, 1:7, 1:3, 1:10] 2225 2139 35.1 17.3 26.7 ...</span></span>
<span id="cb17-9"><a href="#cb17-9"></a><span class="co">#  - attr(*, &quot;dimnames&quot;)=List of 4</span></span>
<span id="cb17-10"><a href="#cb17-10"></a><span class="co">#   ..$ : chr [1:2] &quot;EMP&quot; &quot;VA&quot;</span></span>
<span id="cb17-11"><a href="#cb17-11"></a><span class="co">#   ..$ : chr [1:7] &quot;N/T&quot; &quot;Mean&quot; &quot;SD&quot; &quot;Min&quot; ...</span></span>
<span id="cb17-12"><a href="#cb17-12"></a><span class="co">#   ..$ : chr [1:3] &quot;Overall&quot; &quot;Between&quot; &quot;Within&quot;</span></span>
<span id="cb17-13"><a href="#cb17-13"></a><span class="co">#   ..$ : chr [1:10] &quot;AGR&quot; &quot;MIN&quot; &quot;MAN&quot; &quot;PU&quot; ...</span></span>
<span id="cb17-14"><a href="#cb17-14"></a></span>
<span id="cb17-15"><a href="#cb17-15"></a><span class="co"># Permuting this array to a more readible format</span></span>
<span id="cb17-16"><a href="#cb17-16"></a><span class="kw">aperm</span>(su, <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb17-17"><a href="#cb17-17"></a><span class="co"># , , Overall, EMP</span></span>
<span id="cb17-18"><a href="#cb17-18"></a><span class="co"># </span></span>
<span id="cb17-19"><a href="#cb17-19"></a><span class="co">#        N/T     Mean       SD     Min      Max     Skew     Kurt</span></span>
<span id="cb17-20"><a href="#cb17-20"></a><span class="co"># AGR   2225  35.0949  26.7235   0.156      100   0.4856   2.0951</span></span>
<span id="cb17-21"><a href="#cb17-21"></a><span class="co"># MIN   2216   1.0349   1.4247  0.0043   9.4097   3.1281  15.0429</span></span>
<span id="cb17-22"><a href="#cb17-22"></a><span class="co"># MAN   2216  14.9768   8.0392  0.5822  45.2974   0.4272   2.8455</span></span>
<span id="cb17-23"><a href="#cb17-23"></a><span class="co"># PU    2215   0.5782   0.3601  0.0154   2.4786   1.2588   5.5822</span></span>
<span id="cb17-24"><a href="#cb17-24"></a><span class="co"># CON   2216   5.6583   2.9252  0.1417  15.9887  -0.0631   2.2725</span></span>
<span id="cb17-25"><a href="#cb17-25"></a><span class="co"># WRT   2216  14.9155   6.5573   0.809  32.8046  -0.1814   2.3226</span></span>
<span id="cb17-26"><a href="#cb17-26"></a><span class="co"># TRA   2216   4.8193    2.652  0.1506  15.0454   0.9477   4.4695</span></span>
<span id="cb17-27"><a href="#cb17-27"></a><span class="co"># FIRE  2216   4.6501   4.3518  0.0799  21.7717   1.2345   4.0831</span></span>
<span id="cb17-28"><a href="#cb17-28"></a><span class="co"># GOV   1780  13.1263   8.0844       0  34.8897   0.6301   2.5338</span></span>
<span id="cb17-29"><a href="#cb17-29"></a><span class="co"># OTH   2109   8.3977   6.6409   0.421  34.8942   1.4028   4.3191</span></span>
<span id="cb17-30"><a href="#cb17-30"></a><span class="co"># </span></span>
<span id="cb17-31"><a href="#cb17-31"></a><span class="co"># , , Between, EMP</span></span>
<span id="cb17-32"><a href="#cb17-32"></a><span class="co"># </span></span>
<span id="cb17-33"><a href="#cb17-33"></a><span class="co">#       N/T     Mean       SD     Min      Max     Skew    Kurt</span></span>
<span id="cb17-34"><a href="#cb17-34"></a><span class="co"># AGR    42  35.0949  24.1204  0.9997  88.3263   0.5202  2.2437</span></span>
<span id="cb17-35"><a href="#cb17-35"></a><span class="co"># MIN    42   1.0349   1.2304  0.0296   6.8532   2.7313  12.331</span></span>
<span id="cb17-36"><a href="#cb17-36"></a><span class="co"># MAN    42  14.9768   7.0375   1.718  32.3439  -0.0164  2.4321</span></span>
<span id="cb17-37"><a href="#cb17-37"></a><span class="co"># PU     42   0.5782   0.3041  0.0671   1.3226   0.5459  2.6905</span></span>
<span id="cb17-38"><a href="#cb17-38"></a><span class="co"># CON    42   5.6583   2.4748  0.5037  10.3691  -0.4442  2.3251</span></span>
<span id="cb17-39"><a href="#cb17-39"></a><span class="co"># WRT    42  14.9155    5.264  4.0003  26.7699  -0.5478  2.7294</span></span>
<span id="cb17-40"><a href="#cb17-40"></a><span class="co"># TRA    42   4.8193   2.4712   0.374  12.3887   0.9782  4.7857</span></span>
<span id="cb17-41"><a href="#cb17-41"></a><span class="co"># FIRE   42   4.6501   3.4468  0.1505  12.4402   0.6052  2.5883</span></span>
<span id="cb17-42"><a href="#cb17-42"></a><span class="co"># GOV    34  13.1263   7.2832  2.0086  29.1577   0.3858  2.1068</span></span>
<span id="cb17-43"><a href="#cb17-43"></a><span class="co"># OTH    40   8.3977    6.266  1.3508  26.4036   1.4349  4.3185</span></span>
<span id="cb17-44"><a href="#cb17-44"></a><span class="co"># </span></span>
<span id="cb17-45"><a href="#cb17-45"></a><span class="co"># , , Within, EMP</span></span>
<span id="cb17-46"><a href="#cb17-46"></a><span class="co"># </span></span>
<span id="cb17-47"><a href="#cb17-47"></a><span class="co">#           N/T     Mean       SD      Min       Max     Skew     Kurt</span></span>
<span id="cb17-48"><a href="#cb17-48"></a><span class="co"># AGR   52.9762  26.3768  11.5044  -5.3234  107.4891   1.6002  11.9683</span></span>
<span id="cb17-49"><a href="#cb17-49"></a><span class="co"># MIN   52.7619   3.4006   0.7182  -1.4068     7.509  -0.1988  15.0343</span></span>
<span id="cb17-50"><a href="#cb17-50"></a><span class="co"># MAN   52.7619   17.476   3.8861  -1.1061   40.3964   -0.082   7.3994</span></span>
<span id="cb17-51"><a href="#cb17-51"></a><span class="co"># PU    52.7381   1.3896   0.1929   0.6346    2.5461   0.5731   7.8523</span></span>
<span id="cb17-52"><a href="#cb17-52"></a><span class="co"># CON   52.7619   5.7633   1.5596   0.8964   12.9663   0.3077   4.1248</span></span>
<span id="cb17-53"><a href="#cb17-53"></a><span class="co"># WRT   52.7619  15.7581     3.91   3.7356   29.7615   0.3339   3.3386</span></span>
<span id="cb17-54"><a href="#cb17-54"></a><span class="co"># TRA   52.7619   6.3486   0.9623   2.3501   11.1064   0.2671   5.7162</span></span>
<span id="cb17-55"><a href="#cb17-55"></a><span class="co"># FIRE  52.7619   5.8228   2.6567  -2.9836   15.9974   0.5486   4.0288</span></span>
<span id="cb17-56"><a href="#cb17-56"></a><span class="co"># GOV   52.3529   13.263   3.5088  -2.1983    23.611  -0.5647   4.7286</span></span>
<span id="cb17-57"><a href="#cb17-57"></a><span class="co"># OTH    52.725   7.3941   2.1999  -2.3286   17.4413   0.2929   6.4631</span></span>
<span id="cb17-58"><a href="#cb17-58"></a><span class="co"># </span></span>
<span id="cb17-59"><a href="#cb17-59"></a><span class="co"># , , Overall, VA</span></span>
<span id="cb17-60"><a href="#cb17-60"></a><span class="co"># </span></span>
<span id="cb17-61"><a href="#cb17-61"></a><span class="co">#        N/T     Mean       SD       Min      Max     Skew     Kurt</span></span>
<span id="cb17-62"><a href="#cb17-62"></a><span class="co"># AGR   2139  17.3082  15.5066    0.0318   95.222   1.3274   4.8827</span></span>
<span id="cb17-63"><a href="#cb17-63"></a><span class="co"># MIN   2139   5.8514   9.0975         0  59.0602   2.7193  10.9184</span></span>
<span id="cb17-64"><a href="#cb17-64"></a><span class="co"># MAN   2139  20.0651   8.0033     0.979  41.6281  -0.0348   2.6831</span></span>
<span id="cb17-65"><a href="#cb17-65"></a><span class="co"># PU    2139   2.2298   1.1088         0   9.1888   0.8899   6.2385</span></span>
<span id="cb17-66"><a href="#cb17-66"></a><span class="co"># CON   2139   5.8721   2.5113    0.5951  25.8575   1.5002   8.9578</span></span>
<span id="cb17-67"><a href="#cb17-67"></a><span class="co"># WRT   2139   16.631   5.1374    4.5187  39.7594   0.3455   3.2655</span></span>
<span id="cb17-68"><a href="#cb17-68"></a><span class="co"># TRA   2139   7.9329   3.1057    0.7957  25.9625   1.0122   5.7137</span></span>
<span id="cb17-69"><a href="#cb17-69"></a><span class="co"># FIRE  2139   7.0377  12.7077  -151.065  39.1705  -6.2254  59.8739</span></span>
<span id="cb17-70"><a href="#cb17-70"></a><span class="co"># GOV   1702   13.406   6.3521    0.7607  32.5107   0.4888   2.9043</span></span>
<span id="cb17-71"><a href="#cb17-71"></a><span class="co"># OTH   2139   6.4046   5.8416    0.2327  31.4474   1.4978   4.2051</span></span>
<span id="cb17-72"><a href="#cb17-72"></a><span class="co"># </span></span>
<span id="cb17-73"><a href="#cb17-73"></a><span class="co"># , , Between, VA</span></span>
<span id="cb17-74"><a href="#cb17-74"></a><span class="co"># </span></span>
<span id="cb17-75"><a href="#cb17-75"></a><span class="co">#       N/T     Mean       SD       Min      Max     Skew     Kurt</span></span>
<span id="cb17-76"><a href="#cb17-76"></a><span class="co"># AGR    43  17.3082  13.1901    0.6058  63.8364   1.1328   4.7111</span></span>
<span id="cb17-77"><a href="#cb17-77"></a><span class="co"># MIN    43   5.8514   7.5705    0.0475  27.9214   1.7113    4.807</span></span>
<span id="cb17-78"><a href="#cb17-78"></a><span class="co"># MAN    43  20.0651   6.6423    4.1869  32.1138  -0.3591    2.619</span></span>
<span id="cb17-79"><a href="#cb17-79"></a><span class="co"># PU     43   2.2298   0.7457    0.4462    4.307   0.6196   3.8724</span></span>
<span id="cb17-80"><a href="#cb17-80"></a><span class="co"># CON    43   5.8721   1.8455    2.9405  12.9279   1.3285    6.505</span></span>
<span id="cb17-81"><a href="#cb17-81"></a><span class="co"># WRT    43   16.631   4.3779    8.4188  26.3876    0.292   2.4553</span></span>
<span id="cb17-82"><a href="#cb17-82"></a><span class="co"># TRA    43   7.9329   2.7222     2.037  14.8892   0.6362   3.6686</span></span>
<span id="cb17-83"><a href="#cb17-83"></a><span class="co"># FIRE   43   7.0377   9.0284  -35.6144  23.8658   -2.674  15.0975</span></span>
<span id="cb17-84"><a href="#cb17-84"></a><span class="co"># GOV    35   13.406    5.875    1.9757  27.7714   0.5198   3.0416</span></span>
<span id="cb17-85"><a href="#cb17-85"></a><span class="co"># OTH    43   6.4046   5.6137    1.1184  19.5299   1.3274   3.2043</span></span>
<span id="cb17-86"><a href="#cb17-86"></a><span class="co"># </span></span>
<span id="cb17-87"><a href="#cb17-87"></a><span class="co"># , , Within, VA</span></span>
<span id="cb17-88"><a href="#cb17-88"></a><span class="co"># </span></span>
<span id="cb17-89"><a href="#cb17-89"></a><span class="co">#           N/T     Mean      SD        Min      Max     Skew     Kurt</span></span>
<span id="cb17-90"><a href="#cb17-90"></a><span class="co"># AGR   49.7442  26.3768  8.1532      5.245  94.3499    1.234   9.5269</span></span>
<span id="cb17-91"><a href="#cb17-91"></a><span class="co"># MIN   49.7442   3.4006  5.0451    -20.051  35.7053    0.341   13.102</span></span>
<span id="cb17-92"><a href="#cb17-92"></a><span class="co"># MAN   49.7442   17.476  4.4647     1.1188  36.3501  -0.1928   3.9339</span></span>
<span id="cb17-93"><a href="#cb17-93"></a><span class="co"># PU    49.7442   1.3896  0.8206    -1.0904   6.2714   0.5258   5.3462</span></span>
<span id="cb17-94"><a href="#cb17-94"></a><span class="co"># CON   49.7442   5.7633  1.7031    -0.3464  18.6929   0.7493   6.3751</span></span>
<span id="cb17-95"><a href="#cb17-95"></a><span class="co"># WRT   49.7442  15.7581  2.6884     4.6513  32.6691   0.2338   4.4953</span></span>
<span id="cb17-96"><a href="#cb17-96"></a><span class="co"># TRA   49.7442   6.3486  1.4951     0.9187  18.5977   0.6995  10.1129</span></span>
<span id="cb17-97"><a href="#cb17-97"></a><span class="co"># FIRE  49.7442   5.8228  8.9428  -109.6278  54.1241  -2.7728  54.5971</span></span>
<span id="cb17-98"><a href="#cb17-98"></a><span class="co"># GOV   48.6286   13.263  2.4153     5.1249  22.8497   0.1663   3.3083</span></span>
<span id="cb17-99"><a href="#cb17-99"></a><span class="co"># OTH   49.7442   7.3941  1.6159    -0.9151  19.3116   0.7301   9.6613</span></span></code></pre></div>
<p>The statistics show that the dataset is very consistent: Employment data cover 42 countries and 53 time-periods in almost all sectors. Agriculture is the largest sector in terms of employment, amounting to a 35% share of employment across countries and time, with a standard deviation (SD) of around 27%. The between-country SD in agricultural employment share is 24% and the within SD is 12%, indicating that processes of structural change are very gradual and most of the variation in structure is between countries. The next largest sectors after agriculture are manufacturing, wholesale and retail trade and government, each claiming an approx. 15% share of the economy. In these sectors the between-country SD is also about twice as large as the within-country SD.</p>
<p>In terms of value added, the data covers 43 countries in 50 time-periods. Agriculture, manufacturing, wholesale and retail trade and government are also the largest sectors in terms of VA, but with a diminished agricultural share (around 17%) and a greater share for manufacturing (around 20%). The variation between countries is again greater than the variation within countries, but it seems that at least in terms of agricultural VA share there is also a considerable within-country SD of 8%. This is also true for the finance and real estate sector with a within SD of 9%, suggesting (using a bit of common sense) that a diminishing VA share in agriculture and increased VA share in finance and real estate was a pattern characterizing most of the countries in this sample.</p>
<!-- Note that these two examples have not yet exhausted the capabilities of `qsu` which can also compute weighted versions of all the above statistics and output to list of matrices instead of higher-dimensional array. It is of course also possible to compute conventional and weighted statistics on cross-sectional data using `qsu`.  -->
<p>As a final step we consider a plot function which can be used to plot the structural transformation of any supported country. Below for Botswana:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">library</span>(data.table)</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb18-3"><a href="#cb18-3"></a></span>
<span id="cb18-4"><a href="#cb18-4"></a>plotGGDC &lt;-<span class="st"> </span><span class="cf">function</span>(ctry) {</span>
<span id="cb18-5"><a href="#cb18-5"></a>dat &lt;-<span class="st"> </span><span class="kw">fsubset</span>(GGDC10S, Country <span class="op">==</span><span class="st"> </span>ctry, Variable, Year, AGR<span class="op">:</span>SUM)</span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="kw">fselect</span>(dat, AGR<span class="op">:</span>OTH) &lt;-<span class="st"> </span><span class="kw">replace_outliers</span>(<span class="kw">dapply</span>(<span class="kw">fselect</span>(dat, AGR<span class="op">:</span>OTH), <span class="st">`</span><span class="dt">*</span><span class="st">`</span>, <span class="dv">1</span> <span class="op">/</span><span class="st"> </span>dat<span class="op">$</span>SUM), <span class="dv">0</span>, <span class="ot">NA</span>, <span class="st">&quot;min&quot;</span>)</span>
<span id="cb18-7"><a href="#cb18-7"></a>dat<span class="op">$</span>SUM &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb18-8"><a href="#cb18-8"></a>dat<span class="op">$</span>Variable &lt;-<span class="st"> </span><span class="kw">recode_char</span>(dat<span class="op">$</span>Variable, <span class="dt">VA =</span> <span class="st">&quot;Value Added Share&quot;</span>, <span class="dt">EMP =</span> <span class="st">&quot;Employment Share&quot;</span>)</span>
<span id="cb18-9"><a href="#cb18-9"></a>dat &lt;-<span class="st"> </span><span class="kw">melt</span>(<span class="kw">qDT</span>(dat), <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">variable.name =</span> <span class="st">&quot;Sector&quot;</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb18-10"><a href="#cb18-10"></a></span>
<span id="cb18-11"><a href="#cb18-11"></a><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> value, <span class="dt">fill =</span> Sector), <span class="dt">data =</span> dat) <span class="op">+</span></span>
<span id="cb18-12"><a href="#cb18-12"></a><span class="st">  </span><span class="kw">geom_area</span>(<span class="dt">position =</span> <span class="st">&quot;fill&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb18-13"><a href="#cb18-13"></a><span class="st">  </span><span class="kw">theme_linedraw</span>(<span class="dt">base_size =</span> <span class="dv">14</span>) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>( <span class="op">~</span><span class="st"> </span>Variable) <span class="op">+</span></span>
<span id="cb18-14"><a href="#cb18-14"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">sub</span>(<span class="st">&quot;#00FF66&quot;</span>, <span class="st">&quot;#00CC66&quot;</span>, <span class="kw">rainbow</span>(<span class="dv">10</span>))) <span class="op">+</span></span>
<span id="cb18-15"><a href="#cb18-15"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> scales<span class="op">::</span><span class="kw">pretty_breaks</span>(<span class="dt">n =</span> <span class="dv">7</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="op">+</span></span>
<span id="cb18-16"><a href="#cb18-16"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> scales<span class="op">::</span><span class="kw">pretty_breaks</span>(<span class="dt">n =</span> <span class="dv">10</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb18-17"><a href="#cb18-17"></a>                     <span class="dt">labels =</span> scales<span class="op">::</span>percent) <span class="op">+</span></span>
<span id="cb18-18"><a href="#cb18-18"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">315</span>, <span class="dt">hjust =</span> <span class="dv">0</span>, <span class="dt">margin =</span> ggplot2<span class="op">::</span><span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>)),</span>
<span id="cb18-19"><a href="#cb18-19"></a>        <span class="dt">strip.background =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey20&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;grey20&quot;</span>),</span>
<span id="cb18-20"><a href="#cb18-20"></a>        <span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>))</span>
<span id="cb18-21"><a href="#cb18-21"></a>}</span>
<span id="cb18-22"><a href="#cb18-22"></a></span>
<span id="cb18-23"><a href="#cb18-23"></a><span class="co"># Plotting the structural transformation of Botswana</span></span>
<span id="cb18-24"><a href="#cb18-24"></a><span class="kw">plotGGDC</span>(<span class="st">&quot;BWA&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
</div>
</div>
<div id="fast-data-manipulation" class="section level2">
<h2>2. Fast Data Manipulation</h2>
<p>A lot of R code is not concerned with statistical computations but with preliminary data wrangling. Very frequent operations include selecting, replacing, subsetting, ordering, adding/computing, and deleting data / columns. For various reasons R development has focused on data frames as the main medium to contain data, although matrices / arrays provide significantly faster methods for common manipulations.</p>
<p>A first essential step towards optimizing R code is thus to speed up very frequent manipulations on data frames. <em>collapse</em> introduces a set of highly optimized functions to efficiently manipulate (mostly) data frames. Most manipulations can be conducted in non-standard evaluation or standard evaluation (utilizing different functions), and all functions preserve the data structure (i.e. they can be used with data.table, tbl_df, grouped_df, pdata.frame etc.).</p>
<!-- Some of these functions (`fselect`, `roworder`, `franame`, `fsubset`, `ss` and `ftransform`) represent improved versions of existing ones (`dplyr::select`, `dplyr::arrange`, `dplyr::rename`, `base::subset`, `base::[.data.frame` and `base::transform`) while others are added in. Also some functions (`fselect`, `roworder`, `frename`, `colorder`, `fsubset`, `ftransform`, `settransform`, `fcompute`) use non-standard evaluation, whereas others (`get_vars`, `roworderv`, `colorderv`, `ss`, `add_vars`, `num_vars`, etc.) offer some of the same functionality with standard evaluation and are thus more programmer friendly. Here we run through all of them briefly: -->
<div id="selecting-and-replacing-columns" class="section level3">
<h3>2.1 Selecting and Replacing Columns</h3>
<p><code>fselect</code> is an analogue to <code>dplyr::select</code>, but executes about 100x faster. It can be used to select variables using expressions involving variable names:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw">library</span>(magrittr) <span class="co"># Pipe operators</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="kw">fselect</span>(wlddev, country, year, PCGDP<span class="op">:</span>ODA) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">2</span>)</span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="co">#       country year PCGDP LIFEEX GINI       ODA</span></span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="co"># 1 Afghanistan 1960    NA 32.292   NA 114440000</span></span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="co"># 2 Afghanistan 1961    NA 32.742   NA 233350000</span></span>
<span id="cb19-6"><a href="#cb19-6"></a></span>
<span id="cb19-7"><a href="#cb19-7"></a><span class="kw">fselect</span>(wlddev, <span class="op">-</span>country, <span class="op">-</span>year, <span class="op">-</span>(PCGDP<span class="op">:</span>ODA)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">2</span>)</span>
<span id="cb19-8"><a href="#cb19-8"></a><span class="co">#   iso3c       date decade     region     income  OECD</span></span>
<span id="cb19-9"><a href="#cb19-9"></a><span class="co"># 1   AFG 1961-01-01   1960 South Asia Low income FALSE</span></span>
<span id="cb19-10"><a href="#cb19-10"></a><span class="co"># 2   AFG 1962-01-01   1960 South Asia Low income FALSE</span></span>
<span id="cb19-11"><a href="#cb19-11"></a></span>
<span id="cb19-12"><a href="#cb19-12"></a><span class="kw">library</span>(microbenchmark)</span>
<span id="cb19-13"><a href="#cb19-13"></a><span class="kw">microbenchmark</span>(<span class="dt">fselect =</span> collapse<span class="op">::</span><span class="kw">fselect</span>(wlddev, country, year, PCGDP<span class="op">:</span>ODA),</span>
<span id="cb19-14"><a href="#cb19-14"></a>               <span class="dt">select =</span> dplyr<span class="op">::</span><span class="kw">select</span>(wlddev, country, year, PCGDP<span class="op">:</span>ODA))</span>
<span id="cb19-15"><a href="#cb19-15"></a><span class="co"># Unit: microseconds</span></span>
<span id="cb19-16"><a href="#cb19-16"></a><span class="co">#     expr      min       lq       mean    median       uq      max neval cld</span></span>
<span id="cb19-17"><a href="#cb19-17"></a><span class="co">#  fselect   19.635   25.437   38.10091   33.0225   50.426   80.771   100  a </span></span>
<span id="cb19-18"><a href="#cb19-18"></a><span class="co">#   select 2818.950 2944.346 3215.83044 3252.7035 3330.351 3977.411   100   b</span></span></code></pre></div>
<p>in contrast to <code>dplyr::select</code>, <code>fselect</code> has a replacement method</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="co"># Computing the log of columns</span></span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="kw">fselect</span>(wlddev, PCGDP<span class="op">:</span>ODA) &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="kw">fselect</span>(wlddev, PCGDP<span class="op">:</span>ODA), log)</span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="kw">head</span>(wlddev, <span class="dv">2</span>)</span>
<span id="cb20-4"><a href="#cb20-4"></a><span class="co">#       country iso3c       date year decade     region     income  OECD PCGDP   LIFEEX GINI      ODA</span></span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="co"># 1 Afghanistan   AFG 1961-01-01 1960   1960 South Asia Low income FALSE    NA 3.474820   NA 18.55556</span></span>
<span id="cb20-6"><a href="#cb20-6"></a><span class="co"># 2 Afghanistan   AFG 1962-01-01 1961   1960 South Asia Low income FALSE    NA 3.488659   NA 19.26805</span></span>
<span id="cb20-7"><a href="#cb20-7"></a><span class="co"># Efficient deleting</span></span>
<span id="cb20-8"><a href="#cb20-8"></a><span class="kw">fselect</span>(wlddev, country, year, PCGDP<span class="op">:</span>ODA) &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb20-9"><a href="#cb20-9"></a><span class="kw">head</span>(wlddev, <span class="dv">2</span>)</span>
<span id="cb20-10"><a href="#cb20-10"></a><span class="co">#   iso3c       date decade     region     income  OECD</span></span>
<span id="cb20-11"><a href="#cb20-11"></a><span class="co"># 1   AFG 1961-01-01   1960 South Asia Low income FALSE</span></span>
<span id="cb20-12"><a href="#cb20-12"></a><span class="co"># 2   AFG 1962-01-01   1960 South Asia Low income FALSE</span></span>
<span id="cb20-13"><a href="#cb20-13"></a><span class="kw">rm</span>(wlddev)</span></code></pre></div>
<p>and it can also return information about the selected columns other than the data itself.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="kw">fselect</span>(wlddev, PCGDP<span class="op">:</span>ODA, <span class="dt">return =</span> <span class="st">&quot;names&quot;</span>)</span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="co"># [1] &quot;PCGDP&quot;  &quot;LIFEEX&quot; &quot;GINI&quot;   &quot;ODA&quot;</span></span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="kw">fselect</span>(wlddev, PCGDP<span class="op">:</span>ODA, <span class="dt">return =</span> <span class="st">&quot;indices&quot;</span>)</span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="co"># [1]  9 10 11 12</span></span>
<span id="cb21-5"><a href="#cb21-5"></a><span class="kw">fselect</span>(wlddev, PCGDP<span class="op">:</span>ODA, <span class="dt">return =</span> <span class="st">&quot;named_indices&quot;</span>)</span>
<span id="cb21-6"><a href="#cb21-6"></a><span class="co">#  PCGDP LIFEEX   GINI    ODA </span></span>
<span id="cb21-7"><a href="#cb21-7"></a><span class="co">#      9     10     11     12</span></span>
<span id="cb21-8"><a href="#cb21-8"></a><span class="kw">fselect</span>(wlddev, PCGDP<span class="op">:</span>ODA, <span class="dt">return =</span> <span class="st">&quot;logical&quot;</span>)</span>
<span id="cb21-9"><a href="#cb21-9"></a><span class="co">#  [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE</span></span>
<span id="cb21-10"><a href="#cb21-10"></a><span class="kw">fselect</span>(wlddev, PCGDP<span class="op">:</span>ODA, <span class="dt">return =</span> <span class="st">&quot;named_logical&quot;</span>)</span>
<span id="cb21-11"><a href="#cb21-11"></a><span class="co"># country   iso3c    date    year  decade  region  income    OECD   PCGDP  LIFEEX    GINI     ODA </span></span>
<span id="cb21-12"><a href="#cb21-12"></a><span class="co">#   FALSE   FALSE   FALSE   FALSE   FALSE   FALSE   FALSE   FALSE    TRUE    TRUE    TRUE    TRUE</span></span></code></pre></div>
<!-- `fselect` is a lot faster than `dplyr::select` and maintains this performance on large data.  -->
<p>While <code>fselect</code> is radically faster and more flexible than <code>dplyr::select</code>, it is also simpler and does not offer special methods for grouped tibbles (e.g. where grouping columns are always selected) and some other <em>dplyr</em>-specific features of <code>select</code>. We will see that this is not a problem at all when working with statistical functions in <em>collapse</em> that have a grouped_df method, but users should be careful replacing <code>dplyr::select</code> with <code>fselect</code> in <em>dplyr</em> scripts.</p>
<!-- For some reason this does not work in build !! -->
<!-- ```{r, error=FALSE, warning=FALSE} -->
<!-- library(microbenchmark) -->
<!-- library(dplyr) -->
<!-- identical(select(wlddev, country, year, PCGDP:ODA), fselect(wlddev, country, year, PCGDP:ODA)) -->
<!-- microbenchmark(select(wlddev, country, year, PCGDP:ODA), fselect(wlddev, country, year, PCGDP:ODA)) -->
<!-- ``` -->
<p>The standard-evaluation analogue to <code>fselect</code> is the function <code>get_vars</code>. <code>get_vars</code> can be used to select variables using names, indices, logical vectors, functions or regular expressions evaluated against column names:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="kw">get_vars</span>(wlddev, <span class="dv">9</span><span class="op">:</span><span class="dv">12</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">1</span>)</span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="co">#   PCGDP LIFEEX GINI       ODA</span></span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="co"># 1    NA 32.292   NA 114440000</span></span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="kw">get_vars</span>(wlddev, <span class="kw">c</span>(<span class="st">&quot;PCGDP&quot;</span>,<span class="st">&quot;LIFEEX&quot;</span>,<span class="st">&quot;GINI&quot;</span>,<span class="st">&quot;ODA&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">1</span>)</span>
<span id="cb22-5"><a href="#cb22-5"></a><span class="co">#   PCGDP LIFEEX GINI       ODA</span></span>
<span id="cb22-6"><a href="#cb22-6"></a><span class="co"># 1    NA 32.292   NA 114440000</span></span>
<span id="cb22-7"><a href="#cb22-7"></a><span class="kw">get_vars</span>(wlddev, <span class="st">&quot;[[:upper:]]&quot;</span>, <span class="dt">regex =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">1</span>)</span>
<span id="cb22-8"><a href="#cb22-8"></a><span class="co">#    OECD PCGDP LIFEEX GINI       ODA</span></span>
<span id="cb22-9"><a href="#cb22-9"></a><span class="co"># 1 FALSE    NA 32.292   NA 114440000</span></span>
<span id="cb22-10"><a href="#cb22-10"></a><span class="kw">get_vars</span>(wlddev, <span class="st">&quot;PC|LI|GI|OD&quot;</span>, <span class="dt">regex =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">1</span>)</span>
<span id="cb22-11"><a href="#cb22-11"></a><span class="co">#   PCGDP LIFEEX GINI       ODA</span></span>
<span id="cb22-12"><a href="#cb22-12"></a><span class="co"># 1    NA 32.292   NA 114440000</span></span>
<span id="cb22-13"><a href="#cb22-13"></a><span class="co"># Same as above, vectors of regular expressions are sequentially passed to grep</span></span>
<span id="cb22-14"><a href="#cb22-14"></a><span class="kw">get_vars</span>(wlddev, <span class="kw">c</span>(<span class="st">&quot;PC&quot;</span>,<span class="st">&quot;LI&quot;</span>,<span class="st">&quot;GI&quot;</span>,<span class="st">&quot;OD&quot;</span>), <span class="dt">regex =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">1</span>)</span>
<span id="cb22-15"><a href="#cb22-15"></a><span class="co">#   PCGDP LIFEEX GINI       ODA</span></span>
<span id="cb22-16"><a href="#cb22-16"></a><span class="co"># 1    NA 32.292   NA 114440000</span></span>
<span id="cb22-17"><a href="#cb22-17"></a><span class="kw">get_vars</span>(wlddev, is.numeric) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">1</span>)</span>
<span id="cb22-18"><a href="#cb22-18"></a><span class="co">#   year decade PCGDP LIFEEX GINI       ODA</span></span>
<span id="cb22-19"><a href="#cb22-19"></a><span class="co"># 1 1960   1960    NA 32.292   NA 114440000</span></span>
<span id="cb22-20"><a href="#cb22-20"></a></span>
<span id="cb22-21"><a href="#cb22-21"></a><span class="co"># Returning other information</span></span>
<span id="cb22-22"><a href="#cb22-22"></a><span class="kw">get_vars</span>(wlddev, is.numeric, <span class="dt">return =</span> <span class="st">&quot;names&quot;</span>)</span>
<span id="cb22-23"><a href="#cb22-23"></a><span class="co"># [1] &quot;year&quot;   &quot;decade&quot; &quot;PCGDP&quot;  &quot;LIFEEX&quot; &quot;GINI&quot;   &quot;ODA&quot;</span></span>
<span id="cb22-24"><a href="#cb22-24"></a><span class="kw">get_vars</span>(wlddev, <span class="st">&quot;[[:upper:]]&quot;</span>, <span class="dt">regex =</span> <span class="ot">TRUE</span>, <span class="dt">return =</span> <span class="st">&quot;named_indices&quot;</span>)</span>
<span id="cb22-25"><a href="#cb22-25"></a><span class="co">#   OECD  PCGDP LIFEEX   GINI    ODA </span></span>
<span id="cb22-26"><a href="#cb22-26"></a><span class="co">#      8      9     10     11     12</span></span></code></pre></div>
<p>Replacing operations are conducted analogous:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw">get_vars</span>(wlddev, <span class="dv">9</span><span class="op">:</span><span class="dv">12</span>) &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="kw">get_vars</span>(wlddev, <span class="dv">9</span><span class="op">:</span><span class="dv">12</span>), log)</span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="kw">get_vars</span>(wlddev, <span class="dv">9</span><span class="op">:</span><span class="dv">12</span>) &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="kw">head</span>(wlddev, <span class="dv">2</span>)</span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="co">#       country iso3c       date year decade     region     income  OECD</span></span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="co"># 1 Afghanistan   AFG 1961-01-01 1960   1960 South Asia Low income FALSE</span></span>
<span id="cb23-6"><a href="#cb23-6"></a><span class="co"># 2 Afghanistan   AFG 1962-01-01 1961   1960 South Asia Low income FALSE</span></span>
<span id="cb23-7"><a href="#cb23-7"></a><span class="kw">rm</span>(wlddev)</span></code></pre></div>
<p><code>get_vars</code> is about 2x faster than <code>[.data.frame</code>, and <code>get_vars&lt;-</code> is about 6-8x faster than <code>[&lt;-.data.frame</code>.</p>
<!-- ```{r} -->
<!-- series <- wlddev[9:12] -->
<!-- microbenchmark(get_vars(wlddev, 9:12), wlddev[9:12]) -->
<!-- microbenchmark(get_vars(wlddev, 9:12) <- series, wlddev[9:12] <- series) -->
<!-- microbenchmark(get_vars(wlddev, 9:12) <- get_vars(wlddev, 9:12), wlddev[9:12] <- wlddev[9:12]) -->
<!-- ``` -->
<p>In addition to <code>get_vars</code>, <em>collapse</em> offers a set of functions to efficiently select and replace data by data type: <code>num_vars</code>, <code>cat_vars</code> (for categorical = non-numeric columns), <code>char_vars</code>, <code>fact_vars</code>, <code>logi_vars</code> and <code>Date_vars</code> (for date and date-time columns).</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="kw">head</span>(<span class="kw">num_vars</span>(wlddev), <span class="dv">2</span>)</span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="co">#   year decade PCGDP LIFEEX GINI       ODA</span></span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="co"># 1 1960   1960    NA 32.292   NA 114440000</span></span>
<span id="cb24-4"><a href="#cb24-4"></a><span class="co"># 2 1961   1960    NA 32.742   NA 233350000</span></span>
<span id="cb24-5"><a href="#cb24-5"></a><span class="kw">head</span>(<span class="kw">cat_vars</span>(wlddev), <span class="dv">2</span>)</span>
<span id="cb24-6"><a href="#cb24-6"></a><span class="co">#       country iso3c       date     region     income  OECD</span></span>
<span id="cb24-7"><a href="#cb24-7"></a><span class="co"># 1 Afghanistan   AFG 1961-01-01 South Asia Low income FALSE</span></span>
<span id="cb24-8"><a href="#cb24-8"></a><span class="co"># 2 Afghanistan   AFG 1962-01-01 South Asia Low income FALSE</span></span>
<span id="cb24-9"><a href="#cb24-9"></a><span class="kw">head</span>(<span class="kw">fact_vars</span>(wlddev), <span class="dv">2</span>)</span>
<span id="cb24-10"><a href="#cb24-10"></a><span class="co">#   iso3c     region     income</span></span>
<span id="cb24-11"><a href="#cb24-11"></a><span class="co"># 1   AFG South Asia Low income</span></span>
<span id="cb24-12"><a href="#cb24-12"></a><span class="co"># 2   AFG South Asia Low income</span></span>
<span id="cb24-13"><a href="#cb24-13"></a></span>
<span id="cb24-14"><a href="#cb24-14"></a><span class="co"># Replacing</span></span>
<span id="cb24-15"><a href="#cb24-15"></a><span class="kw">fact_vars</span>(wlddev) &lt;-<span class="st"> </span><span class="kw">fact_vars</span>(wlddev)</span></code></pre></div>
</div>
<div id="subsetting" class="section level3">
<h3>2.2 Subsetting</h3>
<p><code>fsubset</code> is an enhanced version of <code>base::subset</code> using C functions from the <em>data.table</em> package for fast and micro-optimized subsetting operations. In contrast to <code>base::subset</code>, <code>fsubset</code> allows multiple comma-separated select arguments after the subset argument, and it also preserves all attributes of subsetted columns:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="co"># Returning only value-added data after 1990</span></span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="kw">fsubset</span>(GGDC10S, Variable <span class="op">==</span><span class="st"> &quot;VA&quot;</span> <span class="op">&amp;</span><span class="st"> </span>Year <span class="op">&gt;</span><span class="st"> </span><span class="dv">1990</span>, Country, Year, AGR<span class="op">:</span>GOV) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">2</span>)</span>
<span id="cb25-3"><a href="#cb25-3"></a><span class="co">#   Country Year      AGR      MIN      MAN       PU      CON      WRT      TRA     FIRE      GOV</span></span>
<span id="cb25-4"><a href="#cb25-4"></a><span class="co"># 1     BWA 1991 303.1157 2646.950 472.6488 160.6079 580.0876 806.7509 232.7884 432.6965 1073.263</span></span>
<span id="cb25-5"><a href="#cb25-5"></a><span class="co"># 2     BWA 1992 333.4364 2690.939 537.4274 178.4532 678.7320 725.2577 285.1403 517.2141 1234.012</span></span>
<span id="cb25-6"><a href="#cb25-6"></a><span class="co"># Same thing</span></span>
<span id="cb25-7"><a href="#cb25-7"></a><span class="kw">fsubset</span>(GGDC10S, Variable <span class="op">==</span><span class="st"> &quot;VA&quot;</span> <span class="op">&amp;</span><span class="st"> </span>Year <span class="op">&gt;</span><span class="st"> </span><span class="dv">1990</span>, <span class="op">-</span>(Regioncode<span class="op">:</span>Variable), <span class="op">-</span>(OTH<span class="op">:</span>SUM)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">2</span>)</span>
<span id="cb25-8"><a href="#cb25-8"></a><span class="co">#   Country Year      AGR      MIN      MAN       PU      CON      WRT      TRA     FIRE      GOV</span></span>
<span id="cb25-9"><a href="#cb25-9"></a><span class="co"># 1     BWA 1991 303.1157 2646.950 472.6488 160.6079 580.0876 806.7509 232.7884 432.6965 1073.263</span></span>
<span id="cb25-10"><a href="#cb25-10"></a><span class="co"># 2     BWA 1992 333.4364 2690.939 537.4274 178.4532 678.7320 725.2577 285.1403 517.2141 1234.012</span></span></code></pre></div>
<p>It is also possible to use standard evaluation with <code>fsubset</code>, but for these purposes the function <code>ss</code> exists as a fast and more secure alternative to <code>[.data.frame</code>:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="kw">ss</span>(GGDC10S, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">6</span><span class="op">:</span><span class="dv">16</span>)  <span class="co"># or fsubset(GGDC10S, 1:2, 6:16)</span></span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="co">#   AGR MIN MAN PU CON WRT TRA FIRE GOV OTH SUM</span></span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="co"># 1  NA  NA  NA NA  NA  NA  NA   NA  NA  NA  NA</span></span>
<span id="cb26-4"><a href="#cb26-4"></a><span class="co"># 2  NA  NA  NA NA  NA  NA  NA   NA  NA  NA  NA</span></span>
<span id="cb26-5"><a href="#cb26-5"></a><span class="kw">ss</span>(GGDC10S, <span class="op">-</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>), <span class="kw">c</span>(<span class="st">&quot;AGR&quot;</span>,<span class="st">&quot;MIN&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">2</span>)</span>
<span id="cb26-6"><a href="#cb26-6"></a><span class="co">#   AGR MIN</span></span>
<span id="cb26-7"><a href="#cb26-7"></a><span class="co"># 1  NA  NA</span></span>
<span id="cb26-8"><a href="#cb26-8"></a><span class="co"># 2  NA  NA</span></span></code></pre></div>
<p>Thanks to the <em>data.table</em> C code and optimized R code, <code>fsubset</code> is very fast, and also improves upon <code>[.data.table</code> for small and medium-sized data.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="kw">microbenchmark</span>(<span class="dt">base =</span> <span class="kw">subset</span>(GGDC10S, Variable <span class="op">==</span><span class="st"> &quot;VA&quot;</span> <span class="op">&amp;</span><span class="st"> </span>Year <span class="op">&gt;</span><span class="st"> </span><span class="dv">1990</span>, AGR<span class="op">:</span>SUM), </span>
<span id="cb27-2"><a href="#cb27-2"></a>               <span class="dt">collapse =</span> <span class="kw">fsubset</span>(GGDC10S, Variable <span class="op">==</span><span class="st"> &quot;VA&quot;</span> <span class="op">&amp;</span><span class="st"> </span>Year <span class="op">&gt;</span><span class="st"> </span><span class="dv">1990</span>, AGR<span class="op">:</span>SUM))</span>
<span id="cb27-3"><a href="#cb27-3"></a><span class="co"># Unit: microseconds</span></span>
<span id="cb27-4"><a href="#cb27-4"></a><span class="co">#      expr    min      lq     mean  median       uq     max neval cld</span></span>
<span id="cb27-5"><a href="#cb27-5"></a><span class="co">#      base 352.09 365.924 400.3163 399.393 412.3335 693.024   100   b</span></span>
<span id="cb27-6"><a href="#cb27-6"></a><span class="co">#  collapse 110.67 117.363 131.5854 127.181 134.0980 265.518   100  a</span></span>
<span id="cb27-7"><a href="#cb27-7"></a></span>
<span id="cb27-8"><a href="#cb27-8"></a><span class="kw">microbenchmark</span>(GGDC10S[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>], <span class="kw">ss</span>(GGDC10S, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>))</span>
<span id="cb27-9"><a href="#cb27-9"></a><span class="co"># Unit: microseconds</span></span>
<span id="cb27-10"><a href="#cb27-10"></a><span class="co">#                     expr     min       lq      mean   median      uq     max neval cld</span></span>
<span id="cb27-11"><a href="#cb27-11"></a><span class="co">#      GGDC10S[1:10, 1:10] 118.702 126.2885 137.69464 133.8750 136.106 300.325   100   b</span></span>
<span id="cb27-12"><a href="#cb27-12"></a><span class="co">#  ss(GGDC10S, 1:10, 1:10)   7.140   9.8175  11.84808  11.3795  12.272  38.378   100  a</span></span></code></pre></div>
<p>like <code>base::subset</code>, <code>fsubset</code> is S3 generic with methods for vectors, matrices and data frames. For certain classes such as factors, <code>fsubset.default</code> also improves upon <code>[</code>, but the largest improvements are with the data frame method.</p>
</div>
<div id="reordering-rows-and-columns" class="section level3">
<h3>2.3 Reordering Rows and Columns</h3>
<p><code>roworder</code> is a fast analogue to <code>dplyr::arrange</code> and also brings large performance gains. The syntax is inspired by <code>data.table::setorder</code>, so that negative variable names indicate descending sort.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="kw">roworder</span>(GGDC10S, <span class="op">-</span>Variable, Country) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ss</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">8</span>)</span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="co">#   Country Regioncode        Region Variable Year          AGR MIN         MAN</span></span>
<span id="cb28-3"><a href="#cb28-3"></a><span class="co"># 1     ARG        LAM Latin America       VA 1950 5.887857e-07   0 3.53443e-06</span></span>
<span id="cb28-4"><a href="#cb28-4"></a><span class="co"># 2     ARG        LAM Latin America       VA 1951 9.165327e-07   0 4.77277e-06</span></span>
<span id="cb28-5"><a href="#cb28-5"></a></span>
<span id="cb28-6"><a href="#cb28-6"></a><span class="kw">microbenchmark</span>(<span class="dt">collapse =</span> collapse<span class="op">::</span><span class="kw">roworder</span>(GGDC10S, <span class="op">-</span>Variable, Country), </span>
<span id="cb28-7"><a href="#cb28-7"></a>               <span class="dt">dplyr =</span> dplyr<span class="op">::</span><span class="kw">arrange</span>(GGDC10S, <span class="kw">desc</span>(Variable), Country))</span>
<span id="cb28-8"><a href="#cb28-8"></a><span class="co"># Unit: microseconds</span></span>
<span id="cb28-9"><a href="#cb28-9"></a><span class="co">#      expr      min        lq      mean    median       uq       max neval cld</span></span>
<span id="cb28-10"><a href="#cb28-10"></a><span class="co">#  collapse  373.957  398.0535  460.3098  448.2565  478.155   938.014   100  a </span></span>
<span id="cb28-11"><a href="#cb28-11"></a><span class="co">#     dplyr 8999.043 9233.9925 9626.5796 9493.9320 9778.862 13541.850   100   b</span></span></code></pre></div>
<p>In contrast to <code>data.table::setorder</code>, <code>roworder</code> creates a copy of the data frame (unless data are already sorted). If this copy is not required, <code>data.table::setorder</code> is faster. The function <code>roworderv</code> is a standard evaluation analogue to <code>roworder</code>:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="co"># Same as above</span></span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="kw">roworderv</span>(GGDC10S, <span class="kw">c</span>(<span class="st">&quot;Variable&quot;</span>, <span class="st">&quot;Country&quot;</span>), <span class="dt">decreasing =</span> <span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ss</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">8</span>)</span>
<span id="cb29-3"><a href="#cb29-3"></a><span class="co">#   Country Regioncode        Region Variable Year          AGR MIN         MAN</span></span>
<span id="cb29-4"><a href="#cb29-4"></a><span class="co"># 1     ARG        LAM Latin America       VA 1950 5.887857e-07   0 3.53443e-06</span></span>
<span id="cb29-5"><a href="#cb29-5"></a><span class="co"># 2     ARG        LAM Latin America       VA 1951 9.165327e-07   0 4.77277e-06</span></span></code></pre></div>
<p>With <code>roworderv</code>, it is also possible to move or exchange rows in a data frame:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="co"># If length(neworder) &lt; fnrow(data), the default (pos = &quot;front&quot;) brings rows to the front</span></span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="kw">roworderv</span>(GGDC10S, <span class="dt">neworder =</span> <span class="kw">which</span>(GGDC10S<span class="op">$</span>Country <span class="op">==</span><span class="st"> &quot;GHA&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ss</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">8</span>)</span>
<span id="cb30-3"><a href="#cb30-3"></a><span class="co">#   Country Regioncode             Region Variable Year        AGR         MIN        MAN</span></span>
<span id="cb30-4"><a href="#cb30-4"></a><span class="co"># 1     GHA        SSA Sub-saharan Africa       VA 1960 0.03576160 0.005103683 0.01744687</span></span>
<span id="cb30-5"><a href="#cb30-5"></a><span class="co"># 2     GHA        SSA Sub-saharan Africa       VA 1961 0.03823049 0.005456030 0.01865136</span></span>
<span id="cb30-6"><a href="#cb30-6"></a></span>
<span id="cb30-7"><a href="#cb30-7"></a><span class="co"># pos = &quot;end&quot; brings rows to the end</span></span>
<span id="cb30-8"><a href="#cb30-8"></a><span class="kw">roworderv</span>(GGDC10S, <span class="dt">neworder =</span> <span class="kw">which</span>(GGDC10S<span class="op">$</span>Country <span class="op">==</span><span class="st"> &quot;BWA&quot;</span>), <span class="dt">pos =</span> <span class="st">&quot;end&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ss</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">8</span>)</span>
<span id="cb30-9"><a href="#cb30-9"></a><span class="co">#   Country Regioncode             Region Variable Year      AGR      MIN     MAN</span></span>
<span id="cb30-10"><a href="#cb30-10"></a><span class="co"># 1     ETH        SSA Sub-saharan Africa       VA 1960       NA       NA      NA</span></span>
<span id="cb30-11"><a href="#cb30-11"></a><span class="co"># 2     ETH        SSA Sub-saharan Africa       VA 1961 4495.614 11.86979 109.616</span></span>
<span id="cb30-12"><a href="#cb30-12"></a></span>
<span id="cb30-13"><a href="#cb30-13"></a><span class="co"># pos = &quot;exchange&quot; arranges selected rows in the order they are passed, without affecting other rows</span></span>
<span id="cb30-14"><a href="#cb30-14"></a><span class="kw">roworderv</span>(GGDC10S, <span class="dt">neworder =</span> <span class="kw">with</span>(GGDC10S, <span class="kw">c</span>(<span class="kw">which</span>(Country <span class="op">==</span><span class="st"> &quot;GHA&quot;</span>), </span>
<span id="cb30-15"><a href="#cb30-15"></a>                                              <span class="kw">which</span>(Country <span class="op">==</span><span class="st"> &quot;BWA&quot;</span>))), <span class="dt">pos =</span> <span class="st">&quot;exchange&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ss</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">8</span>)</span>
<span id="cb30-16"><a href="#cb30-16"></a><span class="co">#   Country Regioncode             Region Variable Year        AGR         MIN        MAN</span></span>
<span id="cb30-17"><a href="#cb30-17"></a><span class="co"># 1     GHA        SSA Sub-saharan Africa       VA 1960 0.03576160 0.005103683 0.01744687</span></span>
<span id="cb30-18"><a href="#cb30-18"></a><span class="co"># 2     GHA        SSA Sub-saharan Africa       VA 1961 0.03823049 0.005456030 0.01865136</span></span></code></pre></div>
<p>Similarly, the pair <code>colorder</code> / <code>colorderv</code> facilitates efficient reordering of columns in a data frame. It does not require a copy of the data. To reorder columns by reference, see <code>data.table::setcolorder</code>.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="co"># The default is again pos = &quot;front&quot; which brings selected columns to the front / left</span></span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="kw">colorder</span>(GGDC10S, Variable, Country, Year) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">2</span>)</span>
<span id="cb31-3"><a href="#cb31-3"></a><span class="co">#   Variable Country Year Regioncode             Region AGR MIN MAN PU CON WRT TRA FIRE GOV OTH SUM</span></span>
<span id="cb31-4"><a href="#cb31-4"></a><span class="co"># 1       VA     BWA 1960        SSA Sub-saharan Africa  NA  NA  NA NA  NA  NA  NA   NA  NA  NA  NA</span></span>
<span id="cb31-5"><a href="#cb31-5"></a><span class="co"># 2       VA     BWA 1961        SSA Sub-saharan Africa  NA  NA  NA NA  NA  NA  NA   NA  NA  NA  NA</span></span></code></pre></div>
</div>
<div id="transforming-and-computing-new-columns" class="section level3">
<h3>2.4 Transforming and Computing New Columns</h3>
<p><code>ftransform</code> is an improved version of <code>base::transform</code> for data frames and lists. <code>ftransform</code> can be used to compute new columns or modify and delete existing columns, and always returns the entire data frame.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="kw">ftransform</span>(GGDC10S, <span class="dt">AGR_perc =</span> AGR <span class="op">/</span><span class="st"> </span>SUM <span class="op">*</span><span class="st"> </span><span class="dv">100</span>, <span class="co"># Computing Agricultural percentage</span></span>
<span id="cb32-2"><a href="#cb32-2"></a>                    <span class="dt">Year =</span> <span class="kw">as.integer</span>(Year),    <span class="co"># Coercing Year to integer</span></span>
<span id="cb32-3"><a href="#cb32-3"></a>                    <span class="dt">AGR =</span> <span class="ot">NULL</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tail</span>(<span class="dv">2</span>)     <span class="co"># Deleting column AGR</span></span>
<span id="cb32-4"><a href="#cb32-4"></a><span class="co">#      Country Regioncode                       Region Variable Year      MIN      MAN       PU</span></span>
<span id="cb32-5"><a href="#cb32-5"></a><span class="co"># 5026     EGY       MENA Middle East and North Africa      EMP 2011 27.56394 2373.814 317.9979</span></span>
<span id="cb32-6"><a href="#cb32-6"></a><span class="co"># 5027     EGY       MENA Middle East and North Africa      EMP 2012 24.78083 2348.434 324.9332</span></span>
<span id="cb32-7"><a href="#cb32-7"></a><span class="co">#           CON      WRT      TRA     FIRE      GOV OTH      SUM AGR_perc</span></span>
<span id="cb32-8"><a href="#cb32-8"></a><span class="co"># 5026 2795.264 3020.236 2048.335 814.7403 5635.522  NA 22219.39 23.33961</span></span>
<span id="cb32-9"><a href="#cb32-9"></a><span class="co"># 5027 2931.196 3109.522 2065.004 832.4770 5735.623  NA 22532.56 22.90281</span></span>
<span id="cb32-10"><a href="#cb32-10"></a></span>
<span id="cb32-11"><a href="#cb32-11"></a><span class="co"># Computing scalar results replicates them</span></span>
<span id="cb32-12"><a href="#cb32-12"></a><span class="kw">ftransform</span>(GGDC10S, <span class="dt">MIN_mean =</span> <span class="kw">fmean</span>(MIN), <span class="dt">Intercept =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tail</span>(<span class="dv">2</span>)</span>
<span id="cb32-13"><a href="#cb32-13"></a><span class="co">#      Country Regioncode                       Region Variable Year      AGR      MIN      MAN</span></span>
<span id="cb32-14"><a href="#cb32-14"></a><span class="co"># 5026     EGY       MENA Middle East and North Africa      EMP 2011 5185.919 27.56394 2373.814</span></span>
<span id="cb32-15"><a href="#cb32-15"></a><span class="co"># 5027     EGY       MENA Middle East and North Africa      EMP 2012 5160.590 24.78083 2348.434</span></span>
<span id="cb32-16"><a href="#cb32-16"></a><span class="co">#            PU      CON      WRT      TRA     FIRE      GOV OTH      SUM MIN_mean Intercept</span></span>
<span id="cb32-17"><a href="#cb32-17"></a><span class="co"># 5026 317.9979 2795.264 3020.236 2048.335 814.7403 5635.522  NA 22219.39  1867909         1</span></span>
<span id="cb32-18"><a href="#cb32-18"></a><span class="co"># 5027 324.9332 2931.196 3109.522 2065.004 832.4770 5735.623  NA 22532.56  1867909         1</span></span></code></pre></div>
<p>The modification <code>ftransformv</code> exists to transform specific columns using a function:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="co"># Apply the log to columns 6-16</span></span>
<span id="cb33-2"><a href="#cb33-2"></a>GGDC10S <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ftransformv</span>(<span class="dv">6</span><span class="op">:</span><span class="dv">16</span>, log) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tail</span>(<span class="dv">2</span>)</span>
<span id="cb33-3"><a href="#cb33-3"></a><span class="co">#      Country Regioncode                       Region Variable Year      AGR      MIN      MAN</span></span>
<span id="cb33-4"><a href="#cb33-4"></a><span class="co"># 5026     EGY       MENA Middle East and North Africa      EMP 2011 8.553702 3.316508 7.772253</span></span>
<span id="cb33-5"><a href="#cb33-5"></a><span class="co"># 5027     EGY       MENA Middle East and North Africa      EMP 2012 8.548806 3.210070 7.761504</span></span>
<span id="cb33-6"><a href="#cb33-6"></a><span class="co">#            PU      CON      WRT      TRA     FIRE      GOV OTH      SUM</span></span>
<span id="cb33-7"><a href="#cb33-7"></a><span class="co"># 5026 5.762045 7.935682 8.013090 7.624782 6.702869 8.636845  NA 10.00872</span></span>
<span id="cb33-8"><a href="#cb33-8"></a><span class="co"># 5027 5.783620 7.983166 8.042224 7.632888 6.724406 8.654452  NA 10.02272</span></span>
<span id="cb33-9"><a href="#cb33-9"></a></span>
<span id="cb33-10"><a href="#cb33-10"></a><span class="co"># Convert data to percentage terms </span></span>
<span id="cb33-11"><a href="#cb33-11"></a>GGDC10S <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ftransformv</span>(<span class="dv">6</span><span class="op">:</span><span class="dv">16</span>, <span class="st">`</span><span class="dt">*</span><span class="st">`</span>, <span class="dv">100</span><span class="op">/</span>SUM) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tail</span>(<span class="dv">2</span>)</span>
<span id="cb33-12"><a href="#cb33-12"></a><span class="co">#      Country Regioncode                       Region Variable Year      AGR       MIN      MAN</span></span>
<span id="cb33-13"><a href="#cb33-13"></a><span class="co"># 5026     EGY       MENA Middle East and North Africa      EMP 2011 23.33961 0.1240535 10.68352</span></span>
<span id="cb33-14"><a href="#cb33-14"></a><span class="co"># 5027     EGY       MENA Middle East and North Africa      EMP 2012 22.90281 0.1099779 10.42240</span></span>
<span id="cb33-15"><a href="#cb33-15"></a><span class="co">#            PU      CON      WRT      TRA     FIRE      GOV OTH SUM</span></span>
<span id="cb33-16"><a href="#cb33-16"></a><span class="co"># 5026 1.431173 12.58029 13.59279 9.218680 3.666798 25.36308  NA 100</span></span>
<span id="cb33-17"><a href="#cb33-17"></a><span class="co"># 5027 1.442061 13.00871 13.80013 9.164534 3.694551 25.45482  NA 100</span></span>
<span id="cb33-18"><a href="#cb33-18"></a></span>
<span id="cb33-19"><a href="#cb33-19"></a><span class="co"># Same thing using fselect to get the right indices</span></span>
<span id="cb33-20"><a href="#cb33-20"></a><span class="co"># GGDC10S %&gt;% ftransformv(fselect(., AGR:SUM, return = &quot;indices&quot;), `*`, 100/SUM) %&gt;% tail(2)</span></span>
<span id="cb33-21"><a href="#cb33-21"></a></span>
<span id="cb33-22"><a href="#cb33-22"></a><span class="co"># Apply log to numeric columns</span></span>
<span id="cb33-23"><a href="#cb33-23"></a>GGDC10S <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ftransformv</span>(is.numeric, log) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tail</span>(<span class="dv">2</span>)</span>
<span id="cb33-24"><a href="#cb33-24"></a><span class="co">#      Country Regioncode                       Region Variable     Year      AGR      MIN      MAN</span></span>
<span id="cb33-25"><a href="#cb33-25"></a><span class="co"># 5026     EGY       MENA Middle East and North Africa      EMP 7.606387 8.553702 3.316508 7.772253</span></span>
<span id="cb33-26"><a href="#cb33-26"></a><span class="co"># 5027     EGY       MENA Middle East and North Africa      EMP 7.606885 8.548806 3.210070 7.761504</span></span>
<span id="cb33-27"><a href="#cb33-27"></a><span class="co">#            PU      CON      WRT      TRA     FIRE      GOV OTH      SUM</span></span>
<span id="cb33-28"><a href="#cb33-28"></a><span class="co"># 5026 5.762045 7.935682 8.013090 7.624782 6.702869 8.636845  NA 10.00872</span></span>
<span id="cb33-29"><a href="#cb33-29"></a><span class="co"># 5027 5.783620 7.983166 8.042224 7.632888 6.724406 8.654452  NA 10.02272</span></span></code></pre></div>
<p>Instead of passing comma-separated <code>column = value</code> expressions, it is also possible to bulk-process data with <code>fransform</code> by passing a single list of expressions (such as a data frame). This is useful for more complex transformations involving multiple steps:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="co"># Same as above, but also replacing any generated infinite values with NA</span></span>
<span id="cb34-2"><a href="#cb34-2"></a>GGDC10S <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ftransform</span>(<span class="kw">num_vars</span>(.) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">lapply</span>(log) <span class="op">%&gt;%</span><span class="st"> </span>replace_Inf) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tail</span>(<span class="dv">2</span>)</span>
<span id="cb34-3"><a href="#cb34-3"></a><span class="co">#      Country Regioncode                       Region Variable     Year      AGR      MIN      MAN</span></span>
<span id="cb34-4"><a href="#cb34-4"></a><span class="co"># 5026     EGY       MENA Middle East and North Africa      EMP 7.606387 8.553702 3.316508 7.772253</span></span>
<span id="cb34-5"><a href="#cb34-5"></a><span class="co"># 5027     EGY       MENA Middle East and North Africa      EMP 7.606885 8.548806 3.210070 7.761504</span></span>
<span id="cb34-6"><a href="#cb34-6"></a><span class="co">#            PU      CON      WRT      TRA     FIRE      GOV OTH      SUM</span></span>
<span id="cb34-7"><a href="#cb34-7"></a><span class="co"># 5026 5.762045 7.935682 8.013090 7.624782 6.702869 8.636845  NA 10.00872</span></span>
<span id="cb34-8"><a href="#cb34-8"></a><span class="co"># 5027 5.783620 7.983166 8.042224 7.632888 6.724406 8.654452  NA 10.02272</span></span></code></pre></div>
<p>This mode of usage toggles automatic column matching and replacement. Non-matching columns are added to the data frame. Apart from to <code>ftransform</code>, the function <code>settransform(v)</code> can be used to change the input data frame by reference: <!-- and is a simple wrapper around `X <- ftransform(X, ...)`: --></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="co"># Computing a new column and deleting some others by reference</span></span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="kw">settransform</span>(GGDC10S, <span class="dt">FIRE_MAN =</span> FIRE <span class="op">/</span><span class="st"> </span>MAN,</span>
<span id="cb35-3"><a href="#cb35-3"></a>                      <span class="dt">Regioncode =</span> <span class="ot">NULL</span>, <span class="dt">Region =</span> <span class="ot">NULL</span>)</span>
<span id="cb35-4"><a href="#cb35-4"></a><span class="kw">tail</span>(GGDC10S, <span class="dv">2</span>)</span>
<span id="cb35-5"><a href="#cb35-5"></a><span class="co">#      Country Variable Year      AGR      MIN      MAN       PU      CON      WRT      TRA     FIRE</span></span>
<span id="cb35-6"><a href="#cb35-6"></a><span class="co"># 5026     EGY      EMP 2011 5185.919 27.56394 2373.814 317.9979 2795.264 3020.236 2048.335 814.7403</span></span>
<span id="cb35-7"><a href="#cb35-7"></a><span class="co"># 5027     EGY      EMP 2012 5160.590 24.78083 2348.434 324.9332 2931.196 3109.522 2065.004 832.4770</span></span>
<span id="cb35-8"><a href="#cb35-8"></a><span class="co">#           GOV OTH      SUM  FIRE_MAN</span></span>
<span id="cb35-9"><a href="#cb35-9"></a><span class="co"># 5026 5635.522  NA 22219.39 0.3432200</span></span>
<span id="cb35-10"><a href="#cb35-10"></a><span class="co"># 5027 5735.623  NA 22532.56 0.3544817</span></span>
<span id="cb35-11"><a href="#cb35-11"></a><span class="kw">rm</span>(GGDC10S)</span>
<span id="cb35-12"><a href="#cb35-12"></a></span>
<span id="cb35-13"><a href="#cb35-13"></a><span class="co"># Bulk-processing the data into percentage terms</span></span>
<span id="cb35-14"><a href="#cb35-14"></a><span class="kw">settransformv</span>(GGDC10S, <span class="dv">6</span><span class="op">:</span><span class="dv">16</span>, <span class="st">`</span><span class="dt">*</span><span class="st">`</span>, <span class="dv">100</span><span class="op">/</span>SUM)</span>
<span id="cb35-15"><a href="#cb35-15"></a><span class="kw">tail</span>(GGDC10S, <span class="dv">2</span>)</span>
<span id="cb35-16"><a href="#cb35-16"></a><span class="co">#      Country Regioncode                       Region Variable Year      AGR       MIN      MAN</span></span>
<span id="cb35-17"><a href="#cb35-17"></a><span class="co"># 5026     EGY       MENA Middle East and North Africa      EMP 2011 23.33961 0.1240535 10.68352</span></span>
<span id="cb35-18"><a href="#cb35-18"></a><span class="co"># 5027     EGY       MENA Middle East and North Africa      EMP 2012 22.90281 0.1099779 10.42240</span></span>
<span id="cb35-19"><a href="#cb35-19"></a><span class="co">#            PU      CON      WRT      TRA     FIRE      GOV OTH SUM</span></span>
<span id="cb35-20"><a href="#cb35-20"></a><span class="co"># 5026 1.431173 12.58029 13.59279 9.218680 3.666798 25.36308  NA 100</span></span>
<span id="cb35-21"><a href="#cb35-21"></a><span class="co"># 5027 1.442061 13.00871 13.80013 9.164534 3.694551 25.45482  NA 100</span></span>
<span id="cb35-22"><a href="#cb35-22"></a></span>
<span id="cb35-23"><a href="#cb35-23"></a><span class="co"># Same thing via replacement </span></span>
<span id="cb35-24"><a href="#cb35-24"></a><span class="kw">ftransform</span>(GGDC10S) &lt;-<span class="st"> </span><span class="kw">fselect</span>(GGDC10S, AGR<span class="op">:</span>SUM) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">lapply</span>(<span class="st">`</span><span class="dt">*</span><span class="st">`</span>, <span class="dv">100</span><span class="op">/</span>.<span class="op">$</span>SUM)</span>
<span id="cb35-25"><a href="#cb35-25"></a><span class="co"># Or using double pipes</span></span>
<span id="cb35-26"><a href="#cb35-26"></a>GGDC10S <span class="op">%&lt;&gt;%</span><span class="st"> </span><span class="kw">ftransformv</span>(<span class="dv">6</span><span class="op">:</span><span class="dv">16</span>, <span class="st">`</span><span class="dt">*</span><span class="st">`</span>, <span class="dv">100</span><span class="op">/</span>SUM)</span>
<span id="cb35-27"><a href="#cb35-27"></a><span class="kw">rm</span>(GGDC10S)</span></code></pre></div>
<p>Another convenient addition is provided by the function <code>fcompute</code>, which can be used to compute new columns in a data frame environment and returns the computed columns in a new data frame:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="kw">fcompute</span>(GGDC10S, <span class="dt">AGR_perc =</span> AGR <span class="op">/</span><span class="st"> </span>SUM <span class="op">*</span><span class="st"> </span><span class="dv">100</span>, <span class="dt">FIRE_MAN =</span> FIRE <span class="op">/</span><span class="st"> </span>MAN) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tail</span>(<span class="dv">2</span>)</span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="co">#      AGR_perc  FIRE_MAN</span></span>
<span id="cb36-3"><a href="#cb36-3"></a><span class="co"># 5026 23.33961 0.3432200</span></span>
<span id="cb36-4"><a href="#cb36-4"></a><span class="co"># 5027 22.90281 0.3544817</span></span></code></pre></div>
<p>For more complex tasks see <code>?ftransform</code>.</p>
</div>
<div id="adding-and-binding-columns" class="section level3">
<h3>2.5 Adding and Binding Columns</h3>
<p>For cases where multiple columns are computed and need to be added to a data frame (regardless of whether names are duplicated or not), <em>collapse</em> introduces the predicate <code>add_vars</code>. Together with <code>add_vars</code>, the function <code>add_stub</code> is useful to add a prefix (default) or postfix to computed variables keeping the variable names unique:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="co"># Efficient adding logged versions of some variables</span></span>
<span id="cb37-2"><a href="#cb37-2"></a><span class="kw">add_vars</span>(wlddev) &lt;-<span class="st"> </span><span class="kw">get_vars</span>(wlddev, <span class="dv">9</span><span class="op">:</span><span class="dv">12</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">lapply</span>(log10) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">add_stub</span>(<span class="st">&quot;log10.&quot;</span>)</span>
<span id="cb37-3"><a href="#cb37-3"></a><span class="kw">head</span>(wlddev, <span class="dv">2</span>)</span>
<span id="cb37-4"><a href="#cb37-4"></a><span class="co">#       country iso3c       date year decade     region     income  OECD PCGDP LIFEEX GINI       ODA</span></span>
<span id="cb37-5"><a href="#cb37-5"></a><span class="co"># 1 Afghanistan   AFG 1961-01-01 1960   1960 South Asia Low income FALSE    NA 32.292   NA 114440000</span></span>
<span id="cb37-6"><a href="#cb37-6"></a><span class="co"># 2 Afghanistan   AFG 1962-01-01 1961   1960 South Asia Low income FALSE    NA 32.742   NA 233350000</span></span>
<span id="cb37-7"><a href="#cb37-7"></a><span class="co">#   log10.PCGDP log10.LIFEEX log10.GINI log10.ODA</span></span>
<span id="cb37-8"><a href="#cb37-8"></a><span class="co"># 1          NA     1.509095         NA  8.058578</span></span>
<span id="cb37-9"><a href="#cb37-9"></a><span class="co"># 2          NA     1.515105         NA  8.368008</span></span>
<span id="cb37-10"><a href="#cb37-10"></a><span class="kw">rm</span>(wlddev)</span></code></pre></div>
<p>By default <code>add_vars</code> appends a data frame towards the (right) end, but it can also replace columns in front or at other positions in the data frame:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="kw">add_vars</span>(wlddev, <span class="st">&quot;front&quot;</span>) &lt;-<span class="st"> </span><span class="kw">get_vars</span>(wlddev, <span class="dv">9</span><span class="op">:</span><span class="dv">12</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">lapply</span>(log10) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">add_stub</span>(<span class="st">&quot;log10.&quot;</span>)</span>
<span id="cb38-2"><a href="#cb38-2"></a><span class="kw">head</span>(wlddev, <span class="dv">2</span>)</span>
<span id="cb38-3"><a href="#cb38-3"></a><span class="co">#   log10.PCGDP log10.LIFEEX log10.GINI log10.ODA     country iso3c       date year decade     region</span></span>
<span id="cb38-4"><a href="#cb38-4"></a><span class="co"># 1          NA     1.509095         NA  8.058578 Afghanistan   AFG 1961-01-01 1960   1960 South Asia</span></span>
<span id="cb38-5"><a href="#cb38-5"></a><span class="co"># 2          NA     1.515105         NA  8.368008 Afghanistan   AFG 1962-01-01 1961   1960 South Asia</span></span>
<span id="cb38-6"><a href="#cb38-6"></a><span class="co">#       income  OECD PCGDP LIFEEX GINI       ODA</span></span>
<span id="cb38-7"><a href="#cb38-7"></a><span class="co"># 1 Low income FALSE    NA 32.292   NA 114440000</span></span>
<span id="cb38-8"><a href="#cb38-8"></a><span class="co"># 2 Low income FALSE    NA 32.742   NA 233350000</span></span>
<span id="cb38-9"><a href="#cb38-9"></a><span class="kw">rm</span>(wlddev)</span>
<span id="cb38-10"><a href="#cb38-10"></a></span>
<span id="cb38-11"><a href="#cb38-11"></a><span class="kw">add_vars</span>(wlddev, <span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">14</span>,<span class="dv">16</span>)) &lt;-<span class="st"> </span><span class="kw">get_vars</span>(wlddev, <span class="dv">9</span><span class="op">:</span><span class="dv">12</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">lapply</span>(log10) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">add_stub</span>(<span class="st">&quot;log10.&quot;</span>)</span>
<span id="cb38-12"><a href="#cb38-12"></a><span class="kw">head</span>(wlddev, <span class="dv">2</span>)</span>
<span id="cb38-13"><a href="#cb38-13"></a><span class="co">#       country iso3c       date year decade     region     income  OECD PCGDP log10.PCGDP LIFEEX</span></span>
<span id="cb38-14"><a href="#cb38-14"></a><span class="co"># 1 Afghanistan   AFG 1961-01-01 1960   1960 South Asia Low income FALSE    NA          NA 32.292</span></span>
<span id="cb38-15"><a href="#cb38-15"></a><span class="co"># 2 Afghanistan   AFG 1962-01-01 1961   1960 South Asia Low income FALSE    NA          NA 32.742</span></span>
<span id="cb38-16"><a href="#cb38-16"></a><span class="co">#   log10.LIFEEX GINI log10.GINI       ODA log10.ODA</span></span>
<span id="cb38-17"><a href="#cb38-17"></a><span class="co"># 1     1.509095   NA         NA 114440000  8.058578</span></span>
<span id="cb38-18"><a href="#cb38-18"></a><span class="co"># 2     1.515105   NA         NA 233350000  8.368008</span></span>
<span id="cb38-19"><a href="#cb38-19"></a><span class="kw">rm</span>(wlddev)</span></code></pre></div>
<p><code>add_vars</code> can also be used without replacement, where it serves as a more efficient version of <code>cbind.data.frame</code>, with the difference that the data structure and attributes of the first argument are preserved:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="kw">add_vars</span>(wlddev, <span class="kw">get_vars</span>(wlddev, <span class="dv">9</span><span class="op">:</span><span class="dv">12</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">lapply</span>(log) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">add_stub</span>(<span class="st">&quot;log.&quot;</span>),</span>
<span id="cb39-2"><a href="#cb39-2"></a>                 <span class="kw">get_vars</span>(wlddev, <span class="dv">9</span><span class="op">:</span><span class="dv">12</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">lapply</span>(log10) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">add_stub</span>(<span class="st">&quot;log10.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">2</span>)</span>
<span id="cb39-3"><a href="#cb39-3"></a><span class="co">#       country iso3c       date year decade     region     income  OECD PCGDP LIFEEX GINI       ODA</span></span>
<span id="cb39-4"><a href="#cb39-4"></a><span class="co"># 1 Afghanistan   AFG 1961-01-01 1960   1960 South Asia Low income FALSE    NA 32.292   NA 114440000</span></span>
<span id="cb39-5"><a href="#cb39-5"></a><span class="co"># 2 Afghanistan   AFG 1962-01-01 1961   1960 South Asia Low income FALSE    NA 32.742   NA 233350000</span></span>
<span id="cb39-6"><a href="#cb39-6"></a><span class="co">#   log.PCGDP log.LIFEEX log.GINI  log.ODA log10.PCGDP log10.LIFEEX log10.GINI log10.ODA</span></span>
<span id="cb39-7"><a href="#cb39-7"></a><span class="co"># 1        NA   3.474820       NA 18.55556          NA     1.509095         NA  8.058578</span></span>
<span id="cb39-8"><a href="#cb39-8"></a><span class="co"># 2        NA   3.488659       NA 19.26805          NA     1.515105         NA  8.368008</span></span>
<span id="cb39-9"><a href="#cb39-9"></a></span>
<span id="cb39-10"><a href="#cb39-10"></a><span class="kw">add_vars</span>(wlddev,  <span class="kw">get_vars</span>(wlddev, <span class="dv">9</span><span class="op">:</span><span class="dv">12</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">lapply</span>(log) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">add_stub</span>(<span class="st">&quot;log.&quot;</span>), </span>
<span id="cb39-11"><a href="#cb39-11"></a>                  <span class="kw">get_vars</span>(wlddev, <span class="dv">9</span><span class="op">:</span><span class="dv">12</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">lapply</span>(log10) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">add_stub</span>(<span class="st">&quot;log10.&quot;</span>),</span>
<span id="cb39-12"><a href="#cb39-12"></a>         <span class="dt">pos =</span> <span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">13</span>,<span class="dv">16</span>,<span class="dv">19</span>,<span class="dv">11</span>,<span class="dv">14</span>,<span class="dv">17</span>,<span class="dv">20</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">2</span>)</span>
<span id="cb39-13"><a href="#cb39-13"></a><span class="co">#       country iso3c       date year decade     region     income  OECD PCGDP log.PCGDP log10.PCGDP</span></span>
<span id="cb39-14"><a href="#cb39-14"></a><span class="co"># 1 Afghanistan   AFG 1961-01-01 1960   1960 South Asia Low income FALSE    NA        NA          NA</span></span>
<span id="cb39-15"><a href="#cb39-15"></a><span class="co"># 2 Afghanistan   AFG 1962-01-01 1961   1960 South Asia Low income FALSE    NA        NA          NA</span></span>
<span id="cb39-16"><a href="#cb39-16"></a><span class="co">#   LIFEEX log.LIFEEX log10.LIFEEX GINI log.GINI log10.GINI       ODA  log.ODA log10.ODA</span></span>
<span id="cb39-17"><a href="#cb39-17"></a><span class="co"># 1 32.292   3.474820     1.509095   NA       NA         NA 114440000 18.55556  8.058578</span></span>
<span id="cb39-18"><a href="#cb39-18"></a><span class="co"># 2 32.742   3.488659     1.515105   NA       NA         NA 233350000 19.26805  8.368008</span></span>
<span id="cb39-19"><a href="#cb39-19"></a></span>
<span id="cb39-20"><a href="#cb39-20"></a><span class="kw">identical</span>(<span class="kw">cbind</span>(wlddev, wlddev), <span class="kw">add_vars</span>(wlddev, wlddev))</span>
<span id="cb39-21"><a href="#cb39-21"></a><span class="co"># [1] TRUE</span></span>
<span id="cb39-22"><a href="#cb39-22"></a><span class="kw">microbenchmark</span>(<span class="kw">cbind</span>(wlddev, wlddev), <span class="kw">add_vars</span>(wlddev, wlddev))</span>
<span id="cb39-23"><a href="#cb39-23"></a><span class="co"># Unit: microseconds</span></span>
<span id="cb39-24"><a href="#cb39-24"></a><span class="co">#                      expr    min     lq     mean median      uq     max neval cld</span></span>
<span id="cb39-25"><a href="#cb39-25"></a><span class="co">#     cbind(wlddev, wlddev) 50.872 52.211 55.31276 53.104 54.4425 158.864   100   b</span></span>
<span id="cb39-26"><a href="#cb39-26"></a><span class="co">#  add_vars(wlddev, wlddev)  8.033  8.926 10.83515 10.710 11.8260  31.684   100  a</span></span></code></pre></div>
</div>
<div id="renaming-columns" class="section level3">
<h3>2.6 Renaming Columns</h3>
<p><code>frename</code> is a fast substitute for <code>dplyr::rename</code>:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="kw">frename</span>(GGDC10S, <span class="dt">AGR =</span> Agriculture, <span class="dt">MIN =</span> Mining) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">2</span>)</span>
<span id="cb40-2"><a href="#cb40-2"></a><span class="co">#   Country Regioncode             Region Variable Year Agriculture Mining MAN PU CON WRT TRA FIRE GOV</span></span>
<span id="cb40-3"><a href="#cb40-3"></a><span class="co"># 1     BWA        SSA Sub-saharan Africa       VA 1960          NA     NA  NA NA  NA  NA  NA   NA  NA</span></span>
<span id="cb40-4"><a href="#cb40-4"></a><span class="co"># 2     BWA        SSA Sub-saharan Africa       VA 1961          NA     NA  NA NA  NA  NA  NA   NA  NA</span></span>
<span id="cb40-5"><a href="#cb40-5"></a><span class="co">#   OTH SUM</span></span>
<span id="cb40-6"><a href="#cb40-6"></a><span class="co"># 1  NA  NA</span></span>
<span id="cb40-7"><a href="#cb40-7"></a><span class="co"># 2  NA  NA</span></span>
<span id="cb40-8"><a href="#cb40-8"></a><span class="kw">frename</span>(GGDC10S, tolower) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">2</span>)</span>
<span id="cb40-9"><a href="#cb40-9"></a><span class="co">#   country regioncode             region variable year agr min man pu con wrt tra fire gov oth sum</span></span>
<span id="cb40-10"><a href="#cb40-10"></a><span class="co"># 1     BWA        SSA Sub-saharan Africa       VA 1960  NA  NA  NA NA  NA  NA  NA   NA  NA  NA  NA</span></span>
<span id="cb40-11"><a href="#cb40-11"></a><span class="co"># 2     BWA        SSA Sub-saharan Africa       VA 1961  NA  NA  NA NA  NA  NA  NA   NA  NA  NA  NA</span></span>
<span id="cb40-12"><a href="#cb40-12"></a><span class="kw">frename</span>(GGDC10S, tolower, <span class="dt">cols =</span> <span class="kw">.c</span>(AGR, MIN)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">2</span>)</span>
<span id="cb40-13"><a href="#cb40-13"></a><span class="co">#   Country Regioncode             Region Variable Year agr min MAN PU CON WRT TRA FIRE GOV OTH SUM</span></span>
<span id="cb40-14"><a href="#cb40-14"></a><span class="co"># 1     BWA        SSA Sub-saharan Africa       VA 1960  NA  NA  NA NA  NA  NA  NA   NA  NA  NA  NA</span></span>
<span id="cb40-15"><a href="#cb40-15"></a><span class="co"># 2     BWA        SSA Sub-saharan Africa       VA 1961  NA  NA  NA NA  NA  NA  NA   NA  NA  NA  NA</span></span></code></pre></div>
<p>The function <code>setrename</code> does this by reference:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="kw">setrename</span>(GGDC10S, <span class="dt">AGR =</span> Agriculture, <span class="dt">MIN =</span> Mining)</span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="kw">head</span>(GGDC10S, <span class="dv">2</span>)</span>
<span id="cb41-3"><a href="#cb41-3"></a><span class="co">#   Country Regioncode             Region Variable Year Agriculture Mining MAN PU CON WRT TRA FIRE GOV</span></span>
<span id="cb41-4"><a href="#cb41-4"></a><span class="co"># 1     BWA        SSA Sub-saharan Africa       VA 1960          NA     NA  NA NA  NA  NA  NA   NA  NA</span></span>
<span id="cb41-5"><a href="#cb41-5"></a><span class="co"># 2     BWA        SSA Sub-saharan Africa       VA 1961          NA     NA  NA NA  NA  NA  NA   NA  NA</span></span>
<span id="cb41-6"><a href="#cb41-6"></a><span class="co">#   OTH SUM</span></span>
<span id="cb41-7"><a href="#cb41-7"></a><span class="co"># 1  NA  NA</span></span>
<span id="cb41-8"><a href="#cb41-8"></a><span class="co"># 2  NA  NA</span></span>
<span id="cb41-9"><a href="#cb41-9"></a><span class="kw">rm</span>(GGDC10S)</span></code></pre></div>
<p>Both functions are not limited to data frames but can be applied to any R object with a ‘names’ attribute.</p>
</div>
<div id="using-shortcuts" class="section level3">
<h3>2.7 Using Shortcuts</h3>
<p>The most frequently required among the functions introduced above can be abbreviated as follows: <code>fselect -&gt; slt</code>, <code>fsubset -&gt; sbt</code>, <code>ftransform(v) -&gt; tfm(v)</code>, <code>settransform(v) -&gt; settfm(v)</code>, <code>get_vars -&gt; gv</code>, <code>num_vars -&gt; nv</code>, <code>add_vars -&gt; av</code>. This was done to make it possible to write faster and more parsimonious code, and to facilitate the avoidance of piped <code>%&gt;%</code> expressions. Needless to say pipes <code>%&gt;%</code> have become a very convenient feature of the R language and do a great job avoiding complex nested calls. They do however require reconstructing the entire call before evaluating it, and thus take out a lot of speed:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="kw">microbenchmark</span>(<span class="dt">standard =</span> <span class="kw">tfm</span>(<span class="kw">gv</span>(wlddev, <span class="dv">9</span><span class="op">:</span><span class="dv">12</span>), <span class="dt">ODA_GDP =</span> ODA<span class="op">/</span>PCGDP),</span>
<span id="cb42-2"><a href="#cb42-2"></a>               <span class="dt">piped =</span> <span class="kw">get_vars</span>(wlddev, <span class="dv">9</span><span class="op">:</span><span class="dv">12</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ftransform</span>(<span class="dt">ODA_GDP =</span> ODA<span class="op">/</span>PCGDP))</span>
<span id="cb42-3"><a href="#cb42-3"></a><span class="co"># Unit: microseconds</span></span>
<span id="cb42-4"><a href="#cb42-4"></a><span class="co">#      expr     min      lq      mean  median      uq     max neval cld</span></span>
<span id="cb42-5"><a href="#cb42-5"></a><span class="co">#  standard  57.566  59.798  66.37971  60.913  62.029 311.035   100  a </span></span>
<span id="cb42-6"><a href="#cb42-6"></a><span class="co">#     piped 166.451 170.244 185.79572 172.252 176.492 447.587   100   b</span></span></code></pre></div>
</div>
<div id="missing-values-rows" class="section level3">
<h3>2.8 Missing Values / Rows</h3>
<p>The function <code>na_omit</code> is a much faster alternative to <code>stats::na.omit</code> for vectors, matrices and data frames. By default the ‘na.action’ attribute containing the removed cases is omitted, but it can be added with the option <code>na.attr = TRUE</code>. Like <code>fsubset</code>, <code>na_omit</code> preserves all column attributes as well as attributes of the data frame itself.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="kw">microbenchmark</span>(<span class="kw">na_omit</span>(wlddev, <span class="dt">na.attr =</span> <span class="ot">TRUE</span>), <span class="kw">na.omit</span>(wlddev))</span>
<span id="cb43-2"><a href="#cb43-2"></a><span class="co"># Unit: microseconds</span></span>
<span id="cb43-3"><a href="#cb43-3"></a><span class="co">#                             expr      min        lq      mean   median       uq      max neval cld</span></span>
<span id="cb43-4"><a href="#cb43-4"></a><span class="co">#  na_omit(wlddev, na.attr = TRUE)  355.660  365.2545  390.5567  379.311  397.607  608.683   100  a </span></span>
<span id="cb43-5"><a href="#cb43-5"></a><span class="co">#                  na.omit(wlddev) 1422.193 1460.1250 1553.6404 1493.593 1633.046 1882.722   100   b</span></span></code></pre></div>
<p>Another added feature is the removal of cases missing on certain columns only:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="kw">na_omit</span>(wlddev, <span class="dt">cols =</span> <span class="kw">.c</span>(PCGDP, LIFEEX)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">2</span>)</span>
<span id="cb44-2"><a href="#cb44-2"></a><span class="co">#       country iso3c       date year decade     region     income  OECD    PCGDP LIFEEX GINI</span></span>
<span id="cb44-3"><a href="#cb44-3"></a><span class="co"># 1 Afghanistan   AFG 2003-01-01 2002   2000 South Asia Low income FALSE 339.6333 56.637   NA</span></span>
<span id="cb44-4"><a href="#cb44-4"></a><span class="co"># 2 Afghanistan   AFG 2004-01-01 2003   2000 South Asia Low income FALSE 352.2440 57.250   NA</span></span>
<span id="cb44-5"><a href="#cb44-5"></a><span class="co">#          ODA</span></span>
<span id="cb44-6"><a href="#cb44-6"></a><span class="co"># 1 1797060000</span></span>
<span id="cb44-7"><a href="#cb44-7"></a><span class="co"># 2 1928200000</span></span>
<span id="cb44-8"><a href="#cb44-8"></a><span class="co"># only removing missing data from numeric columns -&gt; same and slightly faster than na_omit(wlddev) </span></span>
<span id="cb44-9"><a href="#cb44-9"></a><span class="kw">na_omit</span>(wlddev, <span class="dt">cols =</span> is.numeric) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">2</span>)</span>
<span id="cb44-10"><a href="#cb44-10"></a><span class="co">#   country iso3c       date year decade                region              income  OECD    PCGDP</span></span>
<span id="cb44-11"><a href="#cb44-11"></a><span class="co"># 1 Albania   ALB 1997-01-01 1996   2000 Europe &amp; Central Asia Upper middle income FALSE 1869.817</span></span>
<span id="cb44-12"><a href="#cb44-12"></a><span class="co"># 2 Albania   ALB 2003-01-01 2002   2000 Europe &amp; Central Asia Upper middle income FALSE 2572.652</span></span>
<span id="cb44-13"><a href="#cb44-13"></a><span class="co">#   LIFEEX GINI       ODA</span></span>
<span id="cb44-14"><a href="#cb44-14"></a><span class="co"># 1 72.495 27.0 273050000</span></span>
<span id="cb44-15"><a href="#cb44-15"></a><span class="co"># 2 74.575 31.7 425830000</span></span></code></pre></div>
<p>As mentioned above, <code>na_omit</code> also efficiently removes missing values from vectors and matrices. For vectors the function <code>na_rm</code> also exists wrapping the expression <code>x[!is.na(x)]</code>. There is also a function <code>na_insert</code> to randomly insert missing values into vectors, matrices and data frames. The default is <code>na_insert(X, prop = 0.1)</code> so that 10% of values are randomly set to missing.</p>
</div>
<div id="unique-values-rows" class="section level3">
<h3>2.9 Unique Values / Rows</h3>
<p>Similar to <code>na_omit</code>, the function <code>funique</code> is a much faster alternative to <code>base::unique</code> for atomic vectors and data frames. Like most <em>collapse</em> functions it also seeks to preserve attributes.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="kw">funique</span>(GGDC10S<span class="op">$</span>Variable)              <span class="co"># Unique values in order of appearance</span></span>
<span id="cb45-2"><a href="#cb45-2"></a><span class="co"># [1] &quot;VA&quot;  &quot;EMP&quot;</span></span>
<span id="cb45-3"><a href="#cb45-3"></a><span class="co"># attr(,&quot;label&quot;)</span></span>
<span id="cb45-4"><a href="#cb45-4"></a><span class="co"># [1] &quot;Variable&quot;</span></span>
<span id="cb45-5"><a href="#cb45-5"></a><span class="co"># attr(,&quot;format.stata&quot;)</span></span>
<span id="cb45-6"><a href="#cb45-6"></a><span class="co"># [1] &quot;%9s&quot;</span></span>
<span id="cb45-7"><a href="#cb45-7"></a><span class="kw">funique</span>(GGDC10S<span class="op">$</span>Variable, <span class="dt">sort =</span> <span class="ot">TRUE</span>) <span class="co"># Sorted unique values</span></span>
<span id="cb45-8"><a href="#cb45-8"></a><span class="co"># [1] &quot;EMP&quot; &quot;VA&quot; </span></span>
<span id="cb45-9"><a href="#cb45-9"></a><span class="co"># attr(,&quot;label&quot;)</span></span>
<span id="cb45-10"><a href="#cb45-10"></a><span class="co"># [1] &quot;Variable&quot;</span></span>
<span id="cb45-11"><a href="#cb45-11"></a><span class="co"># attr(,&quot;format.stata&quot;)</span></span>
<span id="cb45-12"><a href="#cb45-12"></a><span class="co"># [1] &quot;%9s&quot;</span></span>
<span id="cb45-13"><a href="#cb45-13"></a></span>
<span id="cb45-14"><a href="#cb45-14"></a><span class="co"># If all values/rows are unique, the original data is returned (no copy)</span></span>
<span id="cb45-15"><a href="#cb45-15"></a><span class="kw">identical</span>(<span class="kw">funique</span>(GGDC10S), GGDC10S)</span>
<span id="cb45-16"><a href="#cb45-16"></a><span class="co"># [1] TRUE</span></span>
<span id="cb45-17"><a href="#cb45-17"></a></span>
<span id="cb45-18"><a href="#cb45-18"></a><span class="co"># Can remove duplicate rows by a subset of columns</span></span>
<span id="cb45-19"><a href="#cb45-19"></a><span class="kw">funique</span>(GGDC10S, <span class="dt">cols =</span> <span class="kw">.c</span>(Country, Variable)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ss</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">8</span>)</span>
<span id="cb45-20"><a href="#cb45-20"></a><span class="co">#   Country Regioncode             Region Variable Year AGR MIN MAN</span></span>
<span id="cb45-21"><a href="#cb45-21"></a><span class="co"># 1     BWA        SSA Sub-saharan Africa       VA 1960  NA  NA  NA</span></span>
<span id="cb45-22"><a href="#cb45-22"></a><span class="co"># 2     BWA        SSA Sub-saharan Africa      EMP 1960  NA  NA  NA</span></span>
<span id="cb45-23"><a href="#cb45-23"></a><span class="kw">funique</span>(GGDC10S, <span class="dt">cols =</span> <span class="kw">.c</span>(Country, Variable), <span class="dt">sort =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ss</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">8</span>)</span>
<span id="cb45-24"><a href="#cb45-24"></a><span class="co">#   Country Regioncode        Region Variable Year          AGR      MIN          MAN</span></span>
<span id="cb45-25"><a href="#cb45-25"></a><span class="co"># 1     ARG        LAM Latin America      EMP 1950 1.799565e+03 32.71936 1.603249e+03</span></span>
<span id="cb45-26"><a href="#cb45-26"></a><span class="co"># 2     ARG        LAM Latin America       VA 1950 5.887857e-07  0.00000 3.534430e-06</span></span></code></pre></div>
</div>
<div id="recoding-and-replacing-values" class="section level3">
<h3>2.10 Recoding and Replacing Values</h3>
<p>With <code>recode_num</code>, <code>recode_char</code>, <code>replace_NA</code>, <code>replace_Inf</code> and <code>replace_outliers</code>, <em>collapse</em> also introduces a set of functions to efficiently recode and replace numeric and character values in matrix-like objects (vectors, matrices, arrays, data frames, lists of atomic objects). When called on a data frame, <code>recode_num</code>, <code>replace_Inf</code> and <code>replace_outliers</code> will skip non-numeric columns, and <code>recode_char</code> skips non-character columns, whereas <code>replace_NA</code> replaces missing values in all columns.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="co"># Efficient replacing missing values with NA</span></span>
<span id="cb46-2"><a href="#cb46-2"></a><span class="kw">microbenchmark</span>(<span class="kw">replace_NA</span>(GGDC10S, <span class="dv">0</span>))</span>
<span id="cb46-3"><a href="#cb46-3"></a><span class="co"># Unit: microseconds</span></span>
<span id="cb46-4"><a href="#cb46-4"></a><span class="co">#                    expr     min      lq     mean   median       uq    max neval</span></span>
<span id="cb46-5"><a href="#cb46-5"></a><span class="co">#  replace_NA(GGDC10S, 0) 354.321 364.585 385.3356 368.3785 373.9565 757.73   100</span></span>
<span id="cb46-6"><a href="#cb46-6"></a></span>
<span id="cb46-7"><a href="#cb46-7"></a><span class="co"># Adding log-transformed sectoral data: Some NaN and Inf values generated</span></span>
<span id="cb46-8"><a href="#cb46-8"></a><span class="kw">add_vars</span>(GGDC10S, <span class="dv">6</span><span class="op">:</span><span class="dv">16</span><span class="op">*</span><span class="dv">2-5</span>) &lt;-<span class="st"> </span><span class="kw">fselect</span>(GGDC10S, AGR<span class="op">:</span>SUM) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">lapply</span>(log) <span class="op">%&gt;%</span><span class="st"> </span>replace_Inf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">add_stub</span>(<span class="st">&quot;log.&quot;</span>) </span>
<span id="cb46-9"><a href="#cb46-9"></a><span class="kw">head</span>(GGDC10S, <span class="dv">2</span>)</span>
<span id="cb46-10"><a href="#cb46-10"></a><span class="co">#   Country Regioncode             Region Variable Year AGR log.AGR MIN log.MIN MAN log.MAN PU log.PU</span></span>
<span id="cb46-11"><a href="#cb46-11"></a><span class="co"># 1     BWA        SSA Sub-saharan Africa       VA 1960  NA      NA  NA      NA  NA      NA NA     NA</span></span>
<span id="cb46-12"><a href="#cb46-12"></a><span class="co"># 2     BWA        SSA Sub-saharan Africa       VA 1961  NA      NA  NA      NA  NA      NA NA     NA</span></span>
<span id="cb46-13"><a href="#cb46-13"></a><span class="co">#   CON log.CON WRT log.WRT TRA log.TRA FIRE log.FIRE GOV log.GOV OTH log.OTH SUM log.SUM</span></span>
<span id="cb46-14"><a href="#cb46-14"></a><span class="co"># 1  NA      NA  NA      NA  NA      NA   NA       NA  NA      NA  NA      NA  NA      NA</span></span>
<span id="cb46-15"><a href="#cb46-15"></a><span class="co"># 2  NA      NA  NA      NA  NA      NA   NA       NA  NA      NA  NA      NA  NA      NA</span></span>
<span id="cb46-16"><a href="#cb46-16"></a><span class="kw">rm</span>(GGDC10S)</span></code></pre></div>
<p><code>recode_num</code> and <code>recode_char</code> follow the syntax of <code>dplyr::recode</code> and provide more or less the same functionality except that they can efficiently be applied to matrices and data frames, and that <code>recode_char</code> allows for regular expression matching implemented via <code>base::grepl</code>:</p>
<!-- that `dplyr::recode` offers a method for factors not provided in *collapse*,  -->
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a>month.name</span>
<span id="cb47-2"><a href="#cb47-2"></a><span class="co">#  [1] &quot;January&quot;   &quot;February&quot;  &quot;March&quot;     &quot;April&quot;     &quot;May&quot;       &quot;June&quot;      &quot;July&quot;      &quot;August&quot;   </span></span>
<span id="cb47-3"><a href="#cb47-3"></a><span class="co">#  [9] &quot;September&quot; &quot;October&quot;   &quot;November&quot;  &quot;December&quot;</span></span>
<span id="cb47-4"><a href="#cb47-4"></a><span class="kw">recode_char</span>(month.name, <span class="dt">ber =</span> <span class="st">&quot;C&quot;</span>, <span class="st">&quot;^J&quot;</span> =<span class="st"> &quot;A&quot;</span>, <span class="dt">default =</span> <span class="st">&quot;B&quot;</span>, <span class="dt">regex =</span> <span class="ot">TRUE</span>)</span>
<span id="cb47-5"><a href="#cb47-5"></a><span class="co">#  [1] &quot;A&quot; &quot;B&quot; &quot;B&quot; &quot;B&quot; &quot;B&quot; &quot;A&quot; &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;C&quot; &quot;C&quot; &quot;C&quot;</span></span></code></pre></div>
<p>The perhaps most interesting function in this ensemble is <code>replace_outliers</code>, which replaces values falling outside a 1- or 2-sided numeric threshold or outside a certain number of column- standard deviations with a value (default is <code>NA</code>).</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="co"># replace all values below 2 and above 100 with NA</span></span>
<span id="cb48-2"><a href="#cb48-2"></a><span class="kw">replace_outliers</span>(mtcars, <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">100</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">3</span>)        </span>
<span id="cb48-3"><a href="#cb48-3"></a><span class="co">#                mpg cyl disp hp drat    wt  qsec vs am gear carb</span></span>
<span id="cb48-4"><a href="#cb48-4"></a><span class="co"># Mazda RX4     21.0   6   NA NA 3.90 2.620 16.46 NA NA    4    4</span></span>
<span id="cb48-5"><a href="#cb48-5"></a><span class="co"># Mazda RX4 Wag 21.0   6   NA NA 3.90 2.875 17.02 NA NA    4    4</span></span>
<span id="cb48-6"><a href="#cb48-6"></a><span class="co"># Datsun 710    22.8   4   NA 93 3.85 2.320 18.61 NA NA    4   NA</span></span>
<span id="cb48-7"><a href="#cb48-7"></a></span>
<span id="cb48-8"><a href="#cb48-8"></a><span class="co"># replace all value smaller than 2 with NA</span></span>
<span id="cb48-9"><a href="#cb48-9"></a><span class="kw">replace_outliers</span>(mtcars, <span class="dv">2</span>, <span class="dt">single.limit =</span> <span class="st">&quot;min&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">3</span>)</span>
<span id="cb48-10"><a href="#cb48-10"></a><span class="co">#                mpg cyl disp  hp drat    wt  qsec vs am gear carb</span></span>
<span id="cb48-11"><a href="#cb48-11"></a><span class="co"># Mazda RX4     21.0   6  160 110 3.90 2.620 16.46 NA NA    4    4</span></span>
<span id="cb48-12"><a href="#cb48-12"></a><span class="co"># Mazda RX4 Wag 21.0   6  160 110 3.90 2.875 17.02 NA NA    4    4</span></span>
<span id="cb48-13"><a href="#cb48-13"></a><span class="co"># Datsun 710    22.8   4  108  93 3.85 2.320 18.61 NA NA    4   NA</span></span>
<span id="cb48-14"><a href="#cb48-14"></a></span>
<span id="cb48-15"><a href="#cb48-15"></a><span class="co"># replace all value larger than 100 with NA</span></span>
<span id="cb48-16"><a href="#cb48-16"></a><span class="kw">replace_outliers</span>(mtcars, <span class="dv">100</span>, <span class="dt">single.limit =</span> <span class="st">&quot;max&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">3</span>)</span>
<span id="cb48-17"><a href="#cb48-17"></a><span class="co">#                mpg cyl disp hp drat    wt  qsec vs am gear carb</span></span>
<span id="cb48-18"><a href="#cb48-18"></a><span class="co"># Mazda RX4     21.0   6   NA NA 3.90 2.620 16.46  0  1    4    4</span></span>
<span id="cb48-19"><a href="#cb48-19"></a><span class="co"># Mazda RX4 Wag 21.0   6   NA NA 3.90 2.875 17.02  0  1    4    4</span></span>
<span id="cb48-20"><a href="#cb48-20"></a><span class="co"># Datsun 710    22.8   4   NA 93 3.85 2.320 18.61  1  1    4    1</span></span>
<span id="cb48-21"><a href="#cb48-21"></a></span>
<span id="cb48-22"><a href="#cb48-22"></a><span class="co"># replace all values above or below 3 column-standard-deviations from the column-mean with NA</span></span>
<span id="cb48-23"><a href="#cb48-23"></a><span class="kw">replace_outliers</span>(mtcars, <span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tail</span>(<span class="dv">3</span>)                        </span>
<span id="cb48-24"><a href="#cb48-24"></a><span class="co">#                mpg cyl disp  hp drat   wt qsec vs am gear carb</span></span>
<span id="cb48-25"><a href="#cb48-25"></a><span class="co"># Ferrari Dino  19.7   6  145 175 3.62 2.77 15.5  0  1    5    6</span></span>
<span id="cb48-26"><a href="#cb48-26"></a><span class="co"># Maserati Bora 15.0   8  301 335 3.54 3.57 14.6  0  1    5   NA</span></span>
<span id="cb48-27"><a href="#cb48-27"></a><span class="co"># Volvo 142E    21.4   4  121 109 4.11 2.78 18.6  1  1    4    2</span></span></code></pre></div>
</div>
</div>
<div id="quick-data-object-conversions" class="section level2">
<h2>3. Quick Data Object Conversions</h2>
<p>Apart from code employed for manipulation of data and the actual statistical computations performed, frequently used data object conversions with base functions like <code>as.data.frame</code>, <code>as.matrix</code> or <code>as.factor</code> have a significant share in slowing down R code. Optimally code would be written without such conversions, but sometimes they are necessary and thus <em>collapse</em> provides a set of functions (<code>qDF</code>, <code>qDT</code>, <code>qM</code>, <code>qF</code>, <code>mrtl</code> and <code>mctl</code>) to speed these conversions up quite a bit. These functions are fast because they are non-generic and dispatch different objects internally, perform critical steps in C++, and, when passed lists of objects, they only check the length of the first column.</p>
<p><code>qDF</code> and <code>qDT</code> efficiently convert vectors, matrices, higher-dimensional arrays and suitable lists to data.frame and <em>data.table</em> respectively.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="kw">str</span>(EuStockMarkets)</span>
<span id="cb49-2"><a href="#cb49-2"></a><span class="co">#  Time-Series [1:1860, 1:4] from 1991 to 1999: 1629 1614 1607 1621 1618 ...</span></span>
<span id="cb49-3"><a href="#cb49-3"></a><span class="co">#  - attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb49-4"><a href="#cb49-4"></a><span class="co">#   ..$ : NULL</span></span>
<span id="cb49-5"><a href="#cb49-5"></a><span class="co">#   ..$ : chr [1:4] &quot;DAX&quot; &quot;SMI&quot; &quot;CAC&quot; &quot;FTSE&quot;</span></span>
<span id="cb49-6"><a href="#cb49-6"></a><span class="co"># Efficient Conversion of data frames and matrices to data.table</span></span>
<span id="cb49-7"><a href="#cb49-7"></a><span class="kw">microbenchmark</span>(<span class="kw">qDT</span>(wlddev), <span class="kw">qDT</span>(EuStockMarkets), <span class="kw">as.data.table</span>(wlddev), <span class="kw">as.data.frame</span>(EuStockMarkets))</span>
<span id="cb49-8"><a href="#cb49-8"></a><span class="co"># Unit: microseconds</span></span>
<span id="cb49-9"><a href="#cb49-9"></a><span class="co">#                           expr     min      lq      mean   median      uq     max neval  cld</span></span>
<span id="cb49-10"><a href="#cb49-10"></a><span class="co">#                    qDT(wlddev)   6.694   8.479  14.10169  13.8340  16.958  89.696   100 a   </span></span>
<span id="cb49-11"><a href="#cb49-11"></a><span class="co">#            qDT(EuStockMarkets)  18.296  24.544  34.14273  34.5850  40.608  84.787   100  b  </span></span>
<span id="cb49-12"><a href="#cb49-12"></a><span class="co">#          as.data.table(wlddev) 333.348 360.123 391.52959 378.4190 389.129 648.846   100    d</span></span>
<span id="cb49-13"><a href="#cb49-13"></a><span class="co">#  as.data.frame(EuStockMarkets) 251.238 294.970 332.99065 321.2995 359.899 569.859   100   c</span></span>
<span id="cb49-14"><a href="#cb49-14"></a></span>
<span id="cb49-15"><a href="#cb49-15"></a><span class="co"># Converting a time series to data.frame</span></span>
<span id="cb49-16"><a href="#cb49-16"></a><span class="kw">head</span>(<span class="kw">qDF</span>(AirPassengers))</span>
<span id="cb49-17"><a href="#cb49-17"></a><span class="co">#   AirPassengers</span></span>
<span id="cb49-18"><a href="#cb49-18"></a><span class="co"># 1           112</span></span>
<span id="cb49-19"><a href="#cb49-19"></a><span class="co"># 2           118</span></span>
<span id="cb49-20"><a href="#cb49-20"></a><span class="co"># 3           132</span></span>
<span id="cb49-21"><a href="#cb49-21"></a><span class="co"># 4           129</span></span>
<span id="cb49-22"><a href="#cb49-22"></a><span class="co"># 5           121</span></span>
<span id="cb49-23"><a href="#cb49-23"></a><span class="co"># 6           135</span></span></code></pre></div>
<p>A useful additional feature of <code>qDF</code> and <code>qDT</code> is the <code>row.names.col</code> argument, enabling the saving of names / row-names in a column when converting from vector, matrix, array or data frame:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="co"># This saves the row-names in a column named &#39;car&#39;</span></span>
<span id="cb50-2"><a href="#cb50-2"></a><span class="kw">head</span>(<span class="kw">qDT</span>(mtcars, <span class="st">&quot;car&quot;</span>))</span>
<span id="cb50-3"><a href="#cb50-3"></a><span class="co">#                  car  mpg cyl disp  hp drat    wt  qsec vs am gear carb</span></span>
<span id="cb50-4"><a href="#cb50-4"></a><span class="co"># 1:         Mazda RX4 21.0   6  160 110 3.90 2.620 16.46  0  1    4    4</span></span>
<span id="cb50-5"><a href="#cb50-5"></a><span class="co"># 2:     Mazda RX4 Wag 21.0   6  160 110 3.90 2.875 17.02  0  1    4    4</span></span>
<span id="cb50-6"><a href="#cb50-6"></a><span class="co"># 3:        Datsun 710 22.8   4  108  93 3.85 2.320 18.61  1  1    4    1</span></span>
<span id="cb50-7"><a href="#cb50-7"></a><span class="co"># 4:    Hornet 4 Drive 21.4   6  258 110 3.08 3.215 19.44  1  0    3    1</span></span>
<span id="cb50-8"><a href="#cb50-8"></a><span class="co"># 5: Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2</span></span>
<span id="cb50-9"><a href="#cb50-9"></a><span class="co"># 6:           Valiant 18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</span></span>
<span id="cb50-10"><a href="#cb50-10"></a></span>
<span id="cb50-11"><a href="#cb50-11"></a>N_distinct &lt;-<span class="st"> </span><span class="kw">fNdistinct</span>(GGDC10S)</span>
<span id="cb50-12"><a href="#cb50-12"></a>N_distinct</span>
<span id="cb50-13"><a href="#cb50-13"></a><span class="co">#    Country Regioncode     Region   Variable       Year        AGR        MIN        MAN         PU </span></span>
<span id="cb50-14"><a href="#cb50-14"></a><span class="co">#         43          6          6          2         67       4353       4224       4353       4237 </span></span>
<span id="cb50-15"><a href="#cb50-15"></a><span class="co">#        CON        WRT        TRA       FIRE        GOV        OTH        SUM </span></span>
<span id="cb50-16"><a href="#cb50-16"></a><span class="co">#       4339       4344       4334       4349       3470       4238       4364</span></span>
<span id="cb50-17"><a href="#cb50-17"></a><span class="co"># Converting a vector to data.frame, saving names</span></span>
<span id="cb50-18"><a href="#cb50-18"></a><span class="kw">head</span>(<span class="kw">qDF</span>(N_distinct, <span class="st">&quot;variable&quot;</span>))</span>
<span id="cb50-19"><a href="#cb50-19"></a><span class="co">#     variable N_distinct</span></span>
<span id="cb50-20"><a href="#cb50-20"></a><span class="co"># 1    Country         43</span></span>
<span id="cb50-21"><a href="#cb50-21"></a><span class="co"># 2 Regioncode          6</span></span>
<span id="cb50-22"><a href="#cb50-22"></a><span class="co"># 3     Region          6</span></span>
<span id="cb50-23"><a href="#cb50-23"></a><span class="co"># 4   Variable          2</span></span>
<span id="cb50-24"><a href="#cb50-24"></a><span class="co"># 5       Year         67</span></span>
<span id="cb50-25"><a href="#cb50-25"></a><span class="co"># 6        AGR       4353</span></span></code></pre></div>
<p>For the conversion of matrices to list there are also the programmers functions <code>mrtl</code> and <code>mctl</code>, which row- or column- wise convert a matrix into a plain list, data.frame or data.table.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="co"># This converts the matrix to a list of 1860 row-vectors of length 4.</span></span>
<span id="cb51-2"><a href="#cb51-2"></a><span class="kw">microbenchmark</span>(<span class="kw">mrtl</span>(EuStockMarkets))</span>
<span id="cb51-3"><a href="#cb51-3"></a><span class="co"># Unit: microseconds</span></span>
<span id="cb51-4"><a href="#cb51-4"></a><span class="co">#                  expr     min       lq     mean  median      uq      max neval</span></span>
<span id="cb51-5"><a href="#cb51-5"></a><span class="co">#  mrtl(EuStockMarkets) 155.294 166.2275 191.8647 168.459 173.591 1625.683   100</span></span></code></pre></div>
<p>For the reverse operation, <code>qM</code> converts vectors, higher-dimensional arrays, data frames and suitable lists to matrix. For example probably the most efficient way to calculate row-sums from a data frame is:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="kw">microbenchmark</span>(<span class="kw">rowSums</span>(<span class="kw">qM</span>(mtcars)), <span class="kw">rowSums</span>(mtcars))</span>
<span id="cb52-2"><a href="#cb52-2"></a><span class="co"># Unit: microseconds</span></span>
<span id="cb52-3"><a href="#cb52-3"></a><span class="co">#                 expr     min      lq      mean  median      uq     max neval cld</span></span>
<span id="cb52-4"><a href="#cb52-4"></a><span class="co">#  rowSums(qM(mtcars))  17.404  18.742  24.65551  20.974  22.313 376.634   100  a </span></span>
<span id="cb52-5"><a href="#cb52-5"></a><span class="co">#      rowSums(mtcars) 117.809 119.595 126.94895 120.933 126.288 270.873   100   b</span></span></code></pre></div>
<p>At last, <code>qF</code> converts vectors to factor and is quite a bit faster than <code>as.factor</code>:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="co"># Converting from character</span></span>
<span id="cb53-2"><a href="#cb53-2"></a><span class="kw">str</span>(wlddev<span class="op">$</span>country)</span>
<span id="cb53-3"><a href="#cb53-3"></a><span class="co">#  chr [1:12744] &quot;Afghanistan&quot; &quot;Afghanistan&quot; &quot;Afghanistan&quot; &quot;Afghanistan&quot; &quot;Afghanistan&quot; ...</span></span>
<span id="cb53-4"><a href="#cb53-4"></a><span class="co">#  - attr(*, &quot;label&quot;)= chr &quot;Country Name&quot;</span></span>
<span id="cb53-5"><a href="#cb53-5"></a><span class="kw">fNdistinct</span>(wlddev<span class="op">$</span>country)</span>
<span id="cb53-6"><a href="#cb53-6"></a><span class="co"># [1] 216</span></span>
<span id="cb53-7"><a href="#cb53-7"></a><span class="kw">microbenchmark</span>(<span class="kw">qF</span>(wlddev<span class="op">$</span>country), <span class="kw">as.factor</span>(wlddev<span class="op">$</span>country))</span>
<span id="cb53-8"><a href="#cb53-8"></a><span class="co"># Unit: microseconds</span></span>
<span id="cb53-9"><a href="#cb53-9"></a><span class="co">#                       expr     min       lq     mean  median       uq     max neval cld</span></span>
<span id="cb53-10"><a href="#cb53-10"></a><span class="co">#         qF(wlddev$country) 181.623 184.9705 200.2631 189.879 205.4980 349.413   100  a </span></span>
<span id="cb53-11"><a href="#cb53-11"></a><span class="co">#  as.factor(wlddev$country) 429.737 442.2320 464.2278 447.587 459.4125 631.887   100   b</span></span>
<span id="cb53-12"><a href="#cb53-12"></a></span>
<span id="cb53-13"><a href="#cb53-13"></a><span class="co"># Converting from numeric</span></span>
<span id="cb53-14"><a href="#cb53-14"></a><span class="kw">str</span>(wlddev<span class="op">$</span>PCGDP)</span>
<span id="cb53-15"><a href="#cb53-15"></a><span class="co">#  num [1:12744] NA NA NA NA NA NA NA NA NA NA ...</span></span>
<span id="cb53-16"><a href="#cb53-16"></a><span class="co">#  - attr(*, &quot;label&quot;)= chr &quot;GDP per capita (constant 2010 US$)&quot;</span></span>
<span id="cb53-17"><a href="#cb53-17"></a><span class="kw">fNdistinct</span>(wlddev<span class="op">$</span>PCGDP)</span>
<span id="cb53-18"><a href="#cb53-18"></a><span class="co"># [1] 8995</span></span>
<span id="cb53-19"><a href="#cb53-19"></a><span class="kw">microbenchmark</span>(<span class="kw">qF</span>(wlddev<span class="op">$</span>PCGDP), <span class="kw">as.factor</span>(wlddev<span class="op">$</span>PCGDP))</span>
<span id="cb53-20"><a href="#cb53-20"></a><span class="co"># Unit: milliseconds</span></span>
<span id="cb53-21"><a href="#cb53-21"></a><span class="co">#                     expr       min        lq      mean    median        uq       max neval cld</span></span>
<span id="cb53-22"><a href="#cb53-22"></a><span class="co">#         qF(wlddev$PCGDP)  1.216919  1.264444  1.364561  1.322904  1.425763  2.037569   100  a </span></span>
<span id="cb53-23"><a href="#cb53-23"></a><span class="co">#  as.factor(wlddev$PCGDP) 33.410162 34.015498 35.375824 34.837041 36.101486 54.791257   100   b</span></span></code></pre></div>
<!-- by default `qF` converts vectors to ordered factor, regulated by the default argument `ordered = TRUE`. This behavior is the same as `as.factor`, but `as.factor` does not attach a class 'ordered'. `qF(x, ordered = FALSE)` will not sort the levels and is slightly faster. Another difference to `as.factor` is that `qF` always adds a `NA` level for missing values, however by default an integer missing value (`NA_integer_`) is provided as the value for that level (thus `qF` behaves identical to `as.factor` with exception of the added level). a slight modification of this behavior can be achieved with `qF(x, na.exclude = FALSE)`, which will still have the `NA` level but now also assigns a positive integer value to the level (implying that missing values can no longer be detected using `is.na`), and attaches an additional class 'na.included'. Factor generation using `qF(x, na.exclude = FALSE)` is advised when using factors to carry out grouped computations with *collapse*'s fast functions, as the class 'na.included' prevents *collapse* functions to execute a missing value check on the factor, and thus yields a performance improvement. -->
</div>
<div id="advanced-statistical-programming" class="section level2">
<h2>4. Advanced Statistical Programming</h2>
<p>Having introduced some of the more basic <em>collapse</em> infrastructure in the preceding chapters, this chapter introduces some of the packages core functionality for programming with data.</p>
<div id="fast-grouped-weighted-statistical-functions" class="section level3">
<h3>4.1 Fast (Grouped, Weighted) Statistical Functions</h3>
<p>A key feature of <em>collapse</em> is it’s broad set of <em>Fast Statistical Functions</em> (<code>fsum, fprod, fmean, fmedian, fmode, fvar, fsd, fmin, fmax, fnth, ffirst, flast, fNobs, fNdistinct</code>), which are able to tangibly speed-up column-wise, grouped and weighted statistical computations on vectors, matrices or data frames. The basic syntax common to all of these functions is:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="kw">FUN</span>(x, <span class="dt">g =</span> <span class="ot">NULL</span>, [<span class="dt">w =</span> <span class="ot">NULL</span>,] <span class="dt">TRA =</span> <span class="ot">NULL</span>, [<span class="dt">na.rm =</span> <span class="ot">TRUE</span>,] <span class="dt">use.g.names =</span> <span class="ot">TRUE</span>, <span class="dt">drop =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p>where <code>x</code> is a vector, matrix or data frame, <code>g</code> takes groups supplied as vector, factor, list of vectors or <em>GRP</em> object, and <code>w</code> takes a weight vector (supported by <code>fsum, fprod, fmean, fmedian, fmode, fnth, fvar</code> and <code>fsd</code>). <code>TRA</code> can be used to transform <code>x</code> using the computed statistics and one of 10 available transformations (<code>&quot;replace_fill&quot;, &quot;replace&quot;, &quot;-&quot;, &quot;-+&quot;, &quot;/&quot;, &quot;%&quot;, &quot;+&quot;, &quot;*&quot;, &quot;%%, &quot;-%%&quot;</code>, discussed in section 6.3). <code>na.rm</code> efficiently removes missing values and is <code>TRUE</code> by default. <code>use.g.names = TRUE</code> generates new row-names from the unique groups supplied to <code>g</code>, and <code>drop = TRUE</code> returns a vector when performing simple (non-grouped) computations on matrix or data frame columns.</p>
<p>With that in mind, let’s start with some simple examples. To calculate simple column-wise means, it is sufficient to type:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="kw">fmean</span>(mtcars<span class="op">$</span>mpg) <span class="co"># Vector</span></span>
<span id="cb55-2"><a href="#cb55-2"></a><span class="co"># [1] 20.09062</span></span>
<span id="cb55-3"><a href="#cb55-3"></a></span>
<span id="cb55-4"><a href="#cb55-4"></a><span class="kw">fmean</span>(mtcars)</span>
<span id="cb55-5"><a href="#cb55-5"></a><span class="co">#        mpg        cyl       disp         hp       drat         wt       qsec         vs         am </span></span>
<span id="cb55-6"><a href="#cb55-6"></a><span class="co">#  20.090625   6.187500 230.721875 146.687500   3.596562   3.217250  17.848750   0.437500   0.406250 </span></span>
<span id="cb55-7"><a href="#cb55-7"></a><span class="co">#       gear       carb </span></span>
<span id="cb55-8"><a href="#cb55-8"></a><span class="co">#   3.687500   2.812500</span></span>
<span id="cb55-9"><a href="#cb55-9"></a></span>
<span id="cb55-10"><a href="#cb55-10"></a><span class="kw">fmean</span>(mtcars, <span class="dt">drop =</span> <span class="ot">FALSE</span>)  <span class="co"># This returns a 1-row data-frame</span></span>
<span id="cb55-11"><a href="#cb55-11"></a><span class="co">#        mpg    cyl     disp       hp     drat      wt     qsec     vs      am   gear   carb</span></span>
<span id="cb55-12"><a href="#cb55-12"></a><span class="co"># 1 20.09062 6.1875 230.7219 146.6875 3.596562 3.21725 17.84875 0.4375 0.40625 3.6875 2.8125</span></span>
<span id="cb55-13"><a href="#cb55-13"></a></span>
<span id="cb55-14"><a href="#cb55-14"></a>m &lt;-<span class="st"> </span><span class="kw">qM</span>(mtcars) <span class="co"># Generate matrix</span></span>
<span id="cb55-15"><a href="#cb55-15"></a><span class="kw">fmean</span>(m)</span>
<span id="cb55-16"><a href="#cb55-16"></a><span class="co">#        mpg        cyl       disp         hp       drat         wt       qsec         vs         am </span></span>
<span id="cb55-17"><a href="#cb55-17"></a><span class="co">#  20.090625   6.187500 230.721875 146.687500   3.596562   3.217250  17.848750   0.437500   0.406250 </span></span>
<span id="cb55-18"><a href="#cb55-18"></a><span class="co">#       gear       carb </span></span>
<span id="cb55-19"><a href="#cb55-19"></a><span class="co">#   3.687500   2.812500</span></span>
<span id="cb55-20"><a href="#cb55-20"></a></span>
<span id="cb55-21"><a href="#cb55-21"></a><span class="kw">fmean</span>(m, <span class="dt">drop =</span> <span class="ot">FALSE</span>)  <span class="co"># This returns a 1-row matrix</span></span>
<span id="cb55-22"><a href="#cb55-22"></a><span class="co">#           mpg    cyl     disp       hp     drat      wt     qsec     vs      am   gear   carb</span></span>
<span id="cb55-23"><a href="#cb55-23"></a><span class="co"># [1,] 20.09062 6.1875 230.7219 146.6875 3.596562 3.21725 17.84875 0.4375 0.40625 3.6875 2.8125</span></span></code></pre></div>
<p>Note that separate methods for vectors, matrices and data frames are written in C++, thus no conversions are needed and computations on matrices and data frames are equally efficient. If we had a weight vector, weighted statistics are easily computed:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a>weights &lt;-<span class="st"> </span><span class="kw">abs</span>(<span class="kw">rnorm</span>(<span class="kw">fnrow</span>(mtcars))) <span class="co"># fnrow is a bit faster for data frames</span></span>
<span id="cb56-2"><a href="#cb56-2"></a></span>
<span id="cb56-3"><a href="#cb56-3"></a><span class="kw">fmean</span>(mtcars, <span class="dt">w =</span> weights) <span class="co"># Weighted mean</span></span>
<span id="cb56-4"><a href="#cb56-4"></a><span class="co">#         mpg         cyl        disp          hp        drat          wt        qsec          vs </span></span>
<span id="cb56-5"><a href="#cb56-5"></a><span class="co">#  20.1041061   6.2412847 240.5391664 143.2688893   3.5825612   3.1872211  17.8351222   0.4262895 </span></span>
<span id="cb56-6"><a href="#cb56-6"></a><span class="co">#          am        gear        carb </span></span>
<span id="cb56-7"><a href="#cb56-7"></a><span class="co">#   0.3964721   3.6878178   2.6160392</span></span>
<span id="cb56-8"><a href="#cb56-8"></a><span class="kw">fmedian</span>(mtcars, <span class="dt">w =</span> weights) <span class="co"># Weighted median</span></span>
<span id="cb56-9"><a href="#cb56-9"></a><span class="co">#     mpg     cyl    disp      hp    drat      wt    qsec      vs      am    gear    carb </span></span>
<span id="cb56-10"><a href="#cb56-10"></a><span class="co">#  19.200   6.000 167.600 123.000   3.770   3.435  17.400   0.000   0.000   4.000   2.000</span></span>
<span id="cb56-11"><a href="#cb56-11"></a><span class="kw">fsd</span>(mtcars, <span class="dt">w =</span> weights) <span class="co"># Frequency-weighted standard deviation</span></span>
<span id="cb56-12"><a href="#cb56-12"></a><span class="co">#         mpg         cyl        disp          hp        drat          wt        qsec          vs </span></span>
<span id="cb56-13"><a href="#cb56-13"></a><span class="co">#   5.7217239   1.7619583 129.0222926  60.9549752   0.5314225   0.9421773   1.7265067   0.5037345 </span></span>
<span id="cb56-14"><a href="#cb56-14"></a><span class="co">#          am        gear        carb </span></span>
<span id="cb56-15"><a href="#cb56-15"></a><span class="co">#   0.4982623   0.7336692   1.4626090</span></span>
<span id="cb56-16"><a href="#cb56-16"></a><span class="kw">fmode</span>(mtcars, <span class="dt">w =</span> weights) <span class="co"># Weighted statistical mode (i.e. the value with the largest sum of weights)</span></span>
<span id="cb56-17"><a href="#cb56-17"></a><span class="co">#    mpg    cyl   disp     hp   drat     wt   qsec     vs     am   gear   carb </span></span>
<span id="cb56-18"><a href="#cb56-18"></a><span class="co">#  19.20   8.00 360.00 175.00   3.15   3.44  17.02   0.00   0.00   3.00   2.00</span></span></code></pre></div>
<p>Fast grouped statistics can be calculated by simply passing grouping vectors or lists of grouping vectors to the fast functions:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="kw">fmean</span>(mtcars, mtcars<span class="op">$</span>cyl)</span>
<span id="cb57-2"><a href="#cb57-2"></a><span class="co">#        mpg cyl     disp        hp     drat       wt     qsec        vs        am     gear     carb</span></span>
<span id="cb57-3"><a href="#cb57-3"></a><span class="co"># 4 26.66364   4 105.1364  82.63636 4.070909 2.285727 19.13727 0.9090909 0.7272727 4.090909 1.545455</span></span>
<span id="cb57-4"><a href="#cb57-4"></a><span class="co"># 6 19.74286   6 183.3143 122.28571 3.585714 3.117143 17.97714 0.5714286 0.4285714 3.857143 3.428571</span></span>
<span id="cb57-5"><a href="#cb57-5"></a><span class="co"># 8 15.10000   8 353.1000 209.21429 3.229286 3.999214 16.77214 0.0000000 0.1428571 3.285714 3.500000</span></span>
<span id="cb57-6"><a href="#cb57-6"></a></span>
<span id="cb57-7"><a href="#cb57-7"></a><span class="kw">fmean</span>(mtcars, <span class="kw">fselect</span>(mtcars, cyl, vs, am))</span>
<span id="cb57-8"><a href="#cb57-8"></a><span class="co">#            mpg cyl     disp        hp     drat       wt     qsec vs am     gear     carb</span></span>
<span id="cb57-9"><a href="#cb57-9"></a><span class="co"># 4.0.1 26.00000   4 120.3000  91.00000 4.430000 2.140000 16.70000  0  1 5.000000 2.000000</span></span>
<span id="cb57-10"><a href="#cb57-10"></a><span class="co"># 4.1.0 22.90000   4 135.8667  84.66667 3.770000 2.935000 20.97000  1  0 3.666667 1.666667</span></span>
<span id="cb57-11"><a href="#cb57-11"></a><span class="co"># 4.1.1 28.37143   4  89.8000  80.57143 4.148571 2.028286 18.70000  1  1 4.142857 1.428571</span></span>
<span id="cb57-12"><a href="#cb57-12"></a><span class="co"># 6.0.1 20.56667   6 155.0000 131.66667 3.806667 2.755000 16.32667  0  1 4.333333 4.666667</span></span>
<span id="cb57-13"><a href="#cb57-13"></a><span class="co"># 6.1.0 19.12500   6 204.5500 115.25000 3.420000 3.388750 19.21500  1  0 3.500000 2.500000</span></span>
<span id="cb57-14"><a href="#cb57-14"></a><span class="co"># 8.0.0 15.05000   8 357.6167 194.16667 3.120833 4.104083 17.14250  0  0 3.000000 3.083333</span></span>
<span id="cb57-15"><a href="#cb57-15"></a><span class="co"># 8.0.1 15.40000   8 326.0000 299.50000 3.880000 3.370000 14.55000  0  1 5.000000 6.000000</span></span>
<span id="cb57-16"><a href="#cb57-16"></a></span>
<span id="cb57-17"><a href="#cb57-17"></a><span class="co"># Getting column indices </span></span>
<span id="cb57-18"><a href="#cb57-18"></a>ind &lt;-<span class="st"> </span><span class="kw">fselect</span>(mtcars, cyl, vs, am, <span class="dt">return =</span> <span class="st">&quot;indices&quot;</span>)</span>
<span id="cb57-19"><a href="#cb57-19"></a><span class="kw">fmean</span>(<span class="kw">get_vars</span>(mtcars, <span class="op">-</span>ind), <span class="kw">get_vars</span>(mtcars, ind))  </span>
<span id="cb57-20"><a href="#cb57-20"></a><span class="co">#            mpg     disp        hp     drat       wt     qsec     gear     carb</span></span>
<span id="cb57-21"><a href="#cb57-21"></a><span class="co"># 4.0.1 26.00000 120.3000  91.00000 4.430000 2.140000 16.70000 5.000000 2.000000</span></span>
<span id="cb57-22"><a href="#cb57-22"></a><span class="co"># 4.1.0 22.90000 135.8667  84.66667 3.770000 2.935000 20.97000 3.666667 1.666667</span></span>
<span id="cb57-23"><a href="#cb57-23"></a><span class="co"># 4.1.1 28.37143  89.8000  80.57143 4.148571 2.028286 18.70000 4.142857 1.428571</span></span>
<span id="cb57-24"><a href="#cb57-24"></a><span class="co"># 6.0.1 20.56667 155.0000 131.66667 3.806667 2.755000 16.32667 4.333333 4.666667</span></span>
<span id="cb57-25"><a href="#cb57-25"></a><span class="co"># 6.1.0 19.12500 204.5500 115.25000 3.420000 3.388750 19.21500 3.500000 2.500000</span></span>
<span id="cb57-26"><a href="#cb57-26"></a><span class="co"># 8.0.0 15.05000 357.6167 194.16667 3.120833 4.104083 17.14250 3.000000 3.083333</span></span>
<span id="cb57-27"><a href="#cb57-27"></a><span class="co"># 8.0.1 15.40000 326.0000 299.50000 3.880000 3.370000 14.55000 5.000000 6.000000</span></span></code></pre></div>
<!-- `get_vars` also subsets data.table columns and other data.frame-like classes, and is about 2x the speed of `[.data.frame`. Replacements of the form `get_vars(data, ind) <- newcols` are about 4x as fast as `data[ind] <- newcols`. It is also possible to subset with functions i.e. `get_vars(mtcars, is.ordered)` and regular expressions i.e. `get_vars(mtcars, c("c","v","a"), regex = TRUE)` or  `get_vars(mtcars, "c|v|a", regex = TRUE)`. Next to `get_vars` there are also the predicates `num_vars`, `cat_vars`, `char_vars`, `fact_vars`, `logi_vars` and `Date_vars` to subset and replace data by type. -->
</div>
<div id="factors-grouping-objects-and-grouped-data-frames" class="section level3">
<h3>4.2 Factors, Grouping Objects and Grouped Data Frames</h3>
<p>This programming can becomes more efficient when passing <em>factors</em> or <em>grouping objects</em> to the <code>g</code> argument, as otherwise vectors and lists of vectors are grouped internally.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="co"># This creates a factor, na.exclude = FALSE attaches a class &#39;na.included&#39;</span></span>
<span id="cb58-2"><a href="#cb58-2"></a>f &lt;-<span class="st"> </span><span class="kw">qF</span>(mtcars<span class="op">$</span>cyl, <span class="dt">na.exclude =</span> <span class="ot">FALSE</span>)</span>
<span id="cb58-3"><a href="#cb58-3"></a><span class="co"># The &#39;na.included&#39; attribute skips a missing value check on this factor</span></span>
<span id="cb58-4"><a href="#cb58-4"></a><span class="kw">attributes</span>(f)</span>
<span id="cb58-5"><a href="#cb58-5"></a><span class="co"># $levels</span></span>
<span id="cb58-6"><a href="#cb58-6"></a><span class="co"># [1] &quot;4&quot; &quot;6&quot; &quot;8&quot;</span></span>
<span id="cb58-7"><a href="#cb58-7"></a><span class="co"># </span></span>
<span id="cb58-8"><a href="#cb58-8"></a><span class="co"># $class</span></span>
<span id="cb58-9"><a href="#cb58-9"></a><span class="co"># [1] &quot;factor&quot;      &quot;na.included&quot;</span></span>
<span id="cb58-10"><a href="#cb58-10"></a><span class="co"># Saving data without grouping columns</span></span>
<span id="cb58-11"><a href="#cb58-11"></a>dat &lt;-<span class="st"> </span><span class="kw">get_vars</span>(mtcars, <span class="op">-</span>ind)</span>
<span id="cb58-12"><a href="#cb58-12"></a><span class="co"># Grouped standard-deviation</span></span>
<span id="cb58-13"><a href="#cb58-13"></a><span class="kw">fsd</span>(dat, f)</span>
<span id="cb58-14"><a href="#cb58-14"></a><span class="co">#        mpg     disp       hp      drat        wt     qsec      gear     carb</span></span>
<span id="cb58-15"><a href="#cb58-15"></a><span class="co"># 4 4.509828 26.87159 20.93453 0.3654711 0.5695637 1.682445 0.5393599 0.522233</span></span>
<span id="cb58-16"><a href="#cb58-16"></a><span class="co"># 6 1.453567 41.56246 24.26049 0.4760552 0.3563455 1.706866 0.6900656 1.812654</span></span>
<span id="cb58-17"><a href="#cb58-17"></a><span class="co"># 8 2.560048 67.77132 50.97689 0.3723618 0.7594047 1.196014 0.7262730 1.556624</span></span>
<span id="cb58-18"><a href="#cb58-18"></a></span>
<span id="cb58-19"><a href="#cb58-19"></a><span class="co"># Without option na.exclude = FALSE, anyNA needs to be called on the factor (noticeable on larger data).</span></span>
<span id="cb58-20"><a href="#cb58-20"></a>f2 &lt;-<span class="st"> </span><span class="kw">qF</span>(mtcars<span class="op">$</span>cyl)</span>
<span id="cb58-21"><a href="#cb58-21"></a><span class="kw">microbenchmark</span>(<span class="kw">fsd</span>(dat, f), <span class="kw">fsd</span>(dat, f2))</span>
<span id="cb58-22"><a href="#cb58-22"></a><span class="co"># Unit: microseconds</span></span>
<span id="cb58-23"><a href="#cb58-23"></a><span class="co">#          expr    min     lq     mean  median     uq    max neval cld</span></span>
<span id="cb58-24"><a href="#cb58-24"></a><span class="co">#   fsd(dat, f) 13.834 14.726 15.57437 15.1725 15.173 64.260   100   a</span></span>
<span id="cb58-25"><a href="#cb58-25"></a><span class="co">#  fsd(dat, f2) 14.726 15.173 15.85987 15.6190 16.065 30.791   100   a</span></span></code></pre></div>
<p>For programming purposes <em>GRP</em> objects are preferable over factors because they never require further checks and they provide additional information about the grouping (such as group sizes and the original unique values in each group). The <code>GRP</code> function creates grouping objects (of class <em>GRP</em>) from vectors or lists of columns. Grouping is done very efficiently via radix ordering in C (using the <code>radixorder</code> function):</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="co"># This creates a &#39;GRP&#39; object. </span></span>
<span id="cb59-2"><a href="#cb59-2"></a>g &lt;-<span class="st"> </span><span class="kw">GRP</span>(mtcars, <span class="op">~</span><span class="st"> </span>cyl <span class="op">+</span><span class="st"> </span>vs <span class="op">+</span><span class="st"> </span>am) <span class="co"># Using the formula interface, could also use c(&quot;cyl&quot;,&quot;vs&quot;,&quot;am&quot;) or c(2,8:9)</span></span>
<span id="cb59-3"><a href="#cb59-3"></a><span class="kw">str</span>(g)</span>
<span id="cb59-4"><a href="#cb59-4"></a><span class="co"># List of 8</span></span>
<span id="cb59-5"><a href="#cb59-5"></a><span class="co">#  $ N.groups   : int 7</span></span>
<span id="cb59-6"><a href="#cb59-6"></a><span class="co">#  $ group.id   : int [1:32] 4 4 3 5 6 5 6 2 2 5 ...</span></span>
<span id="cb59-7"><a href="#cb59-7"></a><span class="co">#  $ group.sizes: int [1:7] 1 3 7 3 4 12 2</span></span>
<span id="cb59-8"><a href="#cb59-8"></a><span class="co">#  $ groups     :&#39;data.frame&#39;:  7 obs. of  3 variables:</span></span>
<span id="cb59-9"><a href="#cb59-9"></a><span class="co">#   ..$ cyl: num [1:7] 4 4 4 6 6 8 8</span></span>
<span id="cb59-10"><a href="#cb59-10"></a><span class="co">#   ..$ vs : num [1:7] 0 1 1 0 1 0 0</span></span>
<span id="cb59-11"><a href="#cb59-11"></a><span class="co">#   ..$ am : num [1:7] 1 0 1 1 0 0 1</span></span>
<span id="cb59-12"><a href="#cb59-12"></a><span class="co">#  $ group.vars : chr [1:3] &quot;cyl&quot; &quot;vs&quot; &quot;am&quot;</span></span>
<span id="cb59-13"><a href="#cb59-13"></a><span class="co">#  $ ordered    : Named logi [1:2] TRUE FALSE</span></span>
<span id="cb59-14"><a href="#cb59-14"></a><span class="co">#   ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;GRP.sort&quot; &quot;initially.ordered&quot;</span></span>
<span id="cb59-15"><a href="#cb59-15"></a><span class="co">#  $ order      : NULL</span></span>
<span id="cb59-16"><a href="#cb59-16"></a><span class="co">#  $ call       : language GRP.default(X = mtcars, by = ~cyl + vs + am)</span></span>
<span id="cb59-17"><a href="#cb59-17"></a><span class="co">#  - attr(*, &quot;class&quot;)= chr &quot;GRP&quot;</span></span></code></pre></div>
<p>The first three elements of this object provide information about the number of groups, the group to which each row belongs, and the size of each group. A print and a plot method provide further information about the grouping:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="kw">print</span>(g)</span>
<span id="cb60-2"><a href="#cb60-2"></a><span class="co"># collapse grouping object of length 32 with 7 ordered groups</span></span>
<span id="cb60-3"><a href="#cb60-3"></a><span class="co"># </span></span>
<span id="cb60-4"><a href="#cb60-4"></a><span class="co"># Call: GRP.default(X = mtcars, by = ~cyl + vs + am), X is unordered</span></span>
<span id="cb60-5"><a href="#cb60-5"></a><span class="co"># </span></span>
<span id="cb60-6"><a href="#cb60-6"></a><span class="co"># Distribution of group sizes: </span></span>
<span id="cb60-7"><a href="#cb60-7"></a><span class="co">#    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb60-8"><a href="#cb60-8"></a><span class="co">#   1.000   2.500   3.000   4.571   5.500  12.000 </span></span>
<span id="cb60-9"><a href="#cb60-9"></a><span class="co"># </span></span>
<span id="cb60-10"><a href="#cb60-10"></a><span class="co"># Groups with sizes: </span></span>
<span id="cb60-11"><a href="#cb60-11"></a><span class="co"># 4.0.1 4.1.0 4.1.1 6.0.1 6.1.0 8.0.0 8.0.1 </span></span>
<span id="cb60-12"><a href="#cb60-12"></a><span class="co">#     1     3     7     3     4    12     2</span></span>
<span id="cb60-13"><a href="#cb60-13"></a><span class="kw">plot</span>(g)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
<p>The important elements of the <em>GRP</em> object are directly handed down to the compiled C++ code of the statistical functions, making repeated computations over the same groups very efficient.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="kw">fsd</span>(dat, g)</span>
<span id="cb61-2"><a href="#cb61-2"></a><span class="co">#             mpg      disp       hp      drat        wt       qsec      gear      carb</span></span>
<span id="cb61-3"><a href="#cb61-3"></a><span class="co"># 4.0.1        NA        NA       NA        NA        NA         NA        NA        NA</span></span>
<span id="cb61-4"><a href="#cb61-4"></a><span class="co"># 4.1.0 1.4525839 13.969371 19.65536 0.1300000 0.4075230 1.67143651 0.5773503 0.5773503</span></span>
<span id="cb61-5"><a href="#cb61-5"></a><span class="co"># 4.1.1 4.7577005 18.802128 24.14441 0.3783926 0.4400840 0.94546285 0.3779645 0.5345225</span></span>
<span id="cb61-6"><a href="#cb61-6"></a><span class="co"># 6.0.1 0.7505553  8.660254 37.52777 0.1616581 0.1281601 0.76872188 0.5773503 1.1547005</span></span>
<span id="cb61-7"><a href="#cb61-7"></a><span class="co"># 6.1.0 1.6317169 44.742634  9.17878 0.5919459 0.1162164 0.81590441 0.5773503 1.7320508</span></span>
<span id="cb61-8"><a href="#cb61-8"></a><span class="co"># 8.0.0 2.7743959 71.823494 33.35984 0.2302749 0.7683069 0.80164745 0.0000000 0.9003366</span></span>
<span id="cb61-9"><a href="#cb61-9"></a><span class="co"># 8.0.1 0.5656854 35.355339 50.20458 0.4808326 0.2828427 0.07071068 0.0000000 2.8284271</span></span>
<span id="cb61-10"><a href="#cb61-10"></a></span>
<span id="cb61-11"><a href="#cb61-11"></a><span class="co"># Grouped computation with and without prior grouping</span></span>
<span id="cb61-12"><a href="#cb61-12"></a><span class="kw">microbenchmark</span>(<span class="kw">fsd</span>(dat, g), <span class="kw">fsd</span>(dat, <span class="kw">get_vars</span>(mtcars, ind)))</span>
<span id="cb61-13"><a href="#cb61-13"></a><span class="co"># Unit: microseconds</span></span>
<span id="cb61-14"><a href="#cb61-14"></a><span class="co">#                             expr     min      lq      mean  median      uq     max neval cld</span></span>
<span id="cb61-15"><a href="#cb61-15"></a><span class="co">#                      fsd(dat, g)  59.352  62.921  68.79389  68.276  69.615 144.138   100  a </span></span>
<span id="cb61-16"><a href="#cb61-16"></a><span class="co">#  fsd(dat, get_vars(mtcars, ind)) 100.406 103.530 117.61351 114.240 116.471 299.879   100   b</span></span></code></pre></div>
<!-- Note at this point that by default (`sort = TRUE`, `order = 1L`), groups are sorted in ascending order, corresponding to *data.table* grouping with `keyby`. The ordering can be reversed (`order = -1L`), or set individually for each of the 3 grouping columns (i.e. `order = c(1L, -1L, -1L)`). If `sort = FALSE`, the grouping is unordered corresponding to *data.table* grouping with `by`.  -->
<p>Yet another possibility is creating a grouped data frame (class <em>grouped_df</em>). This can either be done using <code>dplyr::group_by</code>, which creates a grouped tibble and requires a conversion of the grouping object using <code>GRP.grouped_df</code>, or using the more efficient <code>fgroup_by</code> provided in <em>collapse</em>:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a>gmtcars &lt;-<span class="st"> </span><span class="kw">fgroup_by</span>(mtcars, cyl, vs, am)</span>
<span id="cb62-2"><a href="#cb62-2"></a><span class="kw">fmedian</span>(gmtcars)</span>
<span id="cb62-3"><a href="#cb62-3"></a><span class="co">#   cyl vs am   mpg  disp    hp  drat    wt  qsec gear carb</span></span>
<span id="cb62-4"><a href="#cb62-4"></a><span class="co"># 1   4  0  1 26.00 120.3  91.0 4.430 2.140 16.70  5.0  2.0</span></span>
<span id="cb62-5"><a href="#cb62-5"></a><span class="co"># 2   4  1  0 22.80 140.8  95.0 3.700 3.150 20.01  4.0  2.0</span></span>
<span id="cb62-6"><a href="#cb62-6"></a><span class="co"># 3   4  1  1 30.40  79.0  66.0 4.080 1.935 18.61  4.0  1.0</span></span>
<span id="cb62-7"><a href="#cb62-7"></a><span class="co"># 4   6  0  1 21.00 160.0 110.0 3.900 2.770 16.46  4.0  4.0</span></span>
<span id="cb62-8"><a href="#cb62-8"></a><span class="co"># 5   6  1  0 18.65 196.3 116.5 3.500 3.440 19.17  3.5  2.5</span></span>
<span id="cb62-9"><a href="#cb62-9"></a><span class="co"># 6   8  0  0 15.20 355.0 180.0 3.075 3.810 17.35  3.0  3.0</span></span>
<span id="cb62-10"><a href="#cb62-10"></a><span class="co"># 7   8  0  1 15.40 326.0 299.5 3.880 3.370 14.55  5.0  6.0</span></span>
<span id="cb62-11"><a href="#cb62-11"></a></span>
<span id="cb62-12"><a href="#cb62-12"></a><span class="kw">head</span>(<span class="kw">fgroup_vars</span>(gmtcars))</span>
<span id="cb62-13"><a href="#cb62-13"></a><span class="co">#                   cyl vs am</span></span>
<span id="cb62-14"><a href="#cb62-14"></a><span class="co"># Mazda RX4           6  0  1</span></span>
<span id="cb62-15"><a href="#cb62-15"></a><span class="co"># Mazda RX4 Wag       6  0  1</span></span>
<span id="cb62-16"><a href="#cb62-16"></a><span class="co"># Datsun 710          4  1  1</span></span>
<span id="cb62-17"><a href="#cb62-17"></a><span class="co"># Hornet 4 Drive      6  1  0</span></span>
<span id="cb62-18"><a href="#cb62-18"></a><span class="co"># Hornet Sportabout   8  0  0</span></span>
<span id="cb62-19"><a href="#cb62-19"></a><span class="co"># Valiant             6  1  0</span></span>
<span id="cb62-20"><a href="#cb62-20"></a></span>
<span id="cb62-21"><a href="#cb62-21"></a><span class="kw">fmedian</span>(gmtcars, <span class="dt">keep.group_vars =</span> <span class="ot">FALSE</span>)</span>
<span id="cb62-22"><a href="#cb62-22"></a><span class="co">#     mpg  disp    hp  drat    wt  qsec gear carb</span></span>
<span id="cb62-23"><a href="#cb62-23"></a><span class="co"># 1 26.00 120.3  91.0 4.430 2.140 16.70  5.0  2.0</span></span>
<span id="cb62-24"><a href="#cb62-24"></a><span class="co"># 2 22.80 140.8  95.0 3.700 3.150 20.01  4.0  2.0</span></span>
<span id="cb62-25"><a href="#cb62-25"></a><span class="co"># 3 30.40  79.0  66.0 4.080 1.935 18.61  4.0  1.0</span></span>
<span id="cb62-26"><a href="#cb62-26"></a><span class="co"># 4 21.00 160.0 110.0 3.900 2.770 16.46  4.0  4.0</span></span>
<span id="cb62-27"><a href="#cb62-27"></a><span class="co"># 5 18.65 196.3 116.5 3.500 3.440 19.17  3.5  2.5</span></span>
<span id="cb62-28"><a href="#cb62-28"></a><span class="co"># 6 15.20 355.0 180.0 3.075 3.810 17.35  3.0  3.0</span></span>
<span id="cb62-29"><a href="#cb62-29"></a><span class="co"># 7 15.40 326.0 299.5 3.880 3.370 14.55  5.0  6.0</span></span></code></pre></div>
<!-- By default, both are ordered, but must not be. For multiple variables, `GRP` is always superior to creating multiple factors and interacting them, and it is also faster than `base::interaction` for lists of factors. -->
<!-- With factors or *GRP* objects, computations are faster since the fast functions would otherwise internally group the vectors every time they are executed. Compared to factors, grouped computations using `GRP` objects are a bit more efficient, primarily because they require no further checks, while factors are checked for missing values^[Because missing values are stored as the smallest integer in C++, and the values of the factor are used directly to index result vectors in grouped computations. Subsetting a vector with the smallest integer would break the C++ code of the *Fast Statistical Functions* and terminate the R session, which must be avoided.] unless a class '*na.included*' is attached. By default `qF` acts just like `as.factor` and preserves missing values when generating factors. Therefore the most effective way of programming with factors is to use `qF(x, na.exclude = FALSE)` to create the factor. This will create an underlying integer for `NA`'s and attach a class '*na.included*', so that no further checks are run on that factor in the *collapse* ecosystem. -->
<!-- Using the objects just created, it is easy to compute over the same groups with multiple functions: -->
<p>Now suppose we wanted to create a new dataset which contains the <em>mean</em>, <em>sd</em>, <em>min</em> and <em>max</em> of the variables <em>mpg</em> and <em>disp</em> grouped by <em>cyl</em>, <em>vs</em> and <em>am</em>:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="co"># Standard evaluation</span></span>
<span id="cb63-2"><a href="#cb63-2"></a>dat &lt;-<span class="st"> </span><span class="kw">get_vars</span>(mtcars, <span class="kw">c</span>(<span class="st">&quot;mpg&quot;</span>, <span class="st">&quot;disp&quot;</span>))</span>
<span id="cb63-3"><a href="#cb63-3"></a><span class="kw">add_vars</span>(g[[<span class="st">&quot;groups&quot;</span>]],</span>
<span id="cb63-4"><a href="#cb63-4"></a>         <span class="kw">add_stub</span>(<span class="kw">fmean</span>(dat, g, <span class="dt">use.g.names =</span> <span class="ot">FALSE</span>), <span class="st">&quot;mean_&quot;</span>),</span>
<span id="cb63-5"><a href="#cb63-5"></a>         <span class="kw">add_stub</span>(<span class="kw">fsd</span>(dat, g, <span class="dt">use.g.names =</span> <span class="ot">FALSE</span>), <span class="st">&quot;sd_&quot;</span>),</span>
<span id="cb63-6"><a href="#cb63-6"></a>         <span class="kw">add_stub</span>(<span class="kw">fmin</span>(dat, g, <span class="dt">use.g.names =</span> <span class="ot">FALSE</span>), <span class="st">&quot;min_&quot;</span>),</span>
<span id="cb63-7"><a href="#cb63-7"></a>         <span class="kw">add_stub</span>(<span class="kw">fmax</span>(dat, g, <span class="dt">use.g.names =</span> <span class="ot">FALSE</span>), <span class="st">&quot;max_&quot;</span>))</span>
<span id="cb63-8"><a href="#cb63-8"></a><span class="co">#   cyl vs am mean_mpg mean_disp    sd_mpg   sd_disp min_mpg min_disp max_mpg max_disp</span></span>
<span id="cb63-9"><a href="#cb63-9"></a><span class="co"># 1   4  0  1 26.00000  120.3000        NA        NA    26.0    120.3    26.0    120.3</span></span>
<span id="cb63-10"><a href="#cb63-10"></a><span class="co"># 2   4  1  0 22.90000  135.8667 1.4525839 13.969371    21.5    120.1    24.4    146.7</span></span>
<span id="cb63-11"><a href="#cb63-11"></a><span class="co"># 3   4  1  1 28.37143   89.8000 4.7577005 18.802128    21.4     71.1    33.9    121.0</span></span>
<span id="cb63-12"><a href="#cb63-12"></a><span class="co"># 4   6  0  1 20.56667  155.0000 0.7505553  8.660254    19.7    145.0    21.0    160.0</span></span>
<span id="cb63-13"><a href="#cb63-13"></a><span class="co"># 5   6  1  0 19.12500  204.5500 1.6317169 44.742634    17.8    167.6    21.4    258.0</span></span>
<span id="cb63-14"><a href="#cb63-14"></a><span class="co"># 6   8  0  0 15.05000  357.6167 2.7743959 71.823494    10.4    275.8    19.2    472.0</span></span>
<span id="cb63-15"><a href="#cb63-15"></a><span class="co"># 7   8  0  1 15.40000  326.0000 0.5656854 35.355339    15.0    301.0    15.8    351.0</span></span>
<span id="cb63-16"><a href="#cb63-16"></a></span>
<span id="cb63-17"><a href="#cb63-17"></a><span class="co"># Non-Standard evaluation</span></span>
<span id="cb63-18"><a href="#cb63-18"></a><span class="kw">fgroup_by</span>(mtcars, cyl, vs, am) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">fselect</span>(mpg, disp) <span class="op">%&gt;%</span><span class="st"> </span>{</span>
<span id="cb63-19"><a href="#cb63-19"></a>  <span class="kw">add_vars</span>(<span class="kw">fgroup_vars</span>(., <span class="st">&quot;unique&quot;</span>),</span>
<span id="cb63-20"><a href="#cb63-20"></a>           <span class="kw">fmean</span>(., <span class="dt">keep.group_vars =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">add_stub</span>(<span class="st">&quot;mean_&quot;</span>),</span>
<span id="cb63-21"><a href="#cb63-21"></a>           <span class="kw">fsd</span>(., <span class="dt">keep.group_vars =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">add_stub</span>(<span class="st">&quot;sd_&quot;</span>),</span>
<span id="cb63-22"><a href="#cb63-22"></a>           <span class="kw">fmin</span>(., <span class="dt">keep.group_vars =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">add_stub</span>(<span class="st">&quot;min_&quot;</span>),</span>
<span id="cb63-23"><a href="#cb63-23"></a>           <span class="kw">fmax</span>(., <span class="dt">keep.group_vars =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">add_stub</span>(<span class="st">&quot;max_&quot;</span>))</span>
<span id="cb63-24"><a href="#cb63-24"></a>}</span>
<span id="cb63-25"><a href="#cb63-25"></a><span class="co">#   cyl vs am mean_mpg mean_disp    sd_mpg   sd_disp min_mpg min_disp max_mpg max_disp</span></span>
<span id="cb63-26"><a href="#cb63-26"></a><span class="co"># 1   4  0  1 26.00000  120.3000        NA        NA    26.0    120.3    26.0    120.3</span></span>
<span id="cb63-27"><a href="#cb63-27"></a><span class="co"># 2   4  1  0 22.90000  135.8667 1.4525839 13.969371    21.5    120.1    24.4    146.7</span></span>
<span id="cb63-28"><a href="#cb63-28"></a><span class="co"># 3   4  1  1 28.37143   89.8000 4.7577005 18.802128    21.4     71.1    33.9    121.0</span></span>
<span id="cb63-29"><a href="#cb63-29"></a><span class="co"># 4   6  0  1 20.56667  155.0000 0.7505553  8.660254    19.7    145.0    21.0    160.0</span></span>
<span id="cb63-30"><a href="#cb63-30"></a><span class="co"># 5   6  1  0 19.12500  204.5500 1.6317169 44.742634    17.8    167.6    21.4    258.0</span></span>
<span id="cb63-31"><a href="#cb63-31"></a><span class="co"># 6   8  0  0 15.05000  357.6167 2.7743959 71.823494    10.4    275.8    19.2    472.0</span></span>
<span id="cb63-32"><a href="#cb63-32"></a><span class="co"># 7   8  0  1 15.40000  326.0000 0.5656854 35.355339    15.0    301.0    15.8    351.0</span></span></code></pre></div>
</div>
<div id="grouped-and-weighted-computations" class="section level3">
<h3>4.3 Grouped and Weighted Computations</h3>
<!-- , and we could decide to include the original grouping columns and omit the generated row-names, as shown below -->
<p>We could also calculate groupwise-frequency weighted means and standard-deviations using a weight vector<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>.</p>
<!-- There is also a *collapse* predicate `add_vars` which serves as a much faster and more versatile alternative to `cbind.data.frame`. The intention behind `add_vars` is to be able to efficiently add multiple columns to an existing data.frame. Thus in a call `add_vars(data, newcols1, newcols2)`, `newcols1` and `newcols2` are added (by default) at the end of `data`, while preserving all attributes of `data`. -->
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="co"># Grouped and weighted mean and sd and grouped min and max</span></span>
<span id="cb64-2"><a href="#cb64-2"></a><span class="kw">add_vars</span>(g[[<span class="st">&quot;groups&quot;</span>]],</span>
<span id="cb64-3"><a href="#cb64-3"></a>         <span class="kw">add_stub</span>(<span class="kw">fmean</span>(dat, g, weights, <span class="dt">use.g.names =</span> <span class="ot">FALSE</span>), <span class="st">&quot;w_mean_&quot;</span>),</span>
<span id="cb64-4"><a href="#cb64-4"></a>         <span class="kw">add_stub</span>(<span class="kw">fsd</span>(dat, g, weights, <span class="dt">use.g.names =</span> <span class="ot">FALSE</span>), <span class="st">&quot;w_sd_&quot;</span>),</span>
<span id="cb64-5"><a href="#cb64-5"></a>         <span class="kw">add_stub</span>(<span class="kw">fmin</span>(dat, g, <span class="dt">use.g.names =</span> <span class="ot">FALSE</span>), <span class="st">&quot;min_&quot;</span>),</span>
<span id="cb64-6"><a href="#cb64-6"></a>         <span class="kw">add_stub</span>(<span class="kw">fmax</span>(dat, g, <span class="dt">use.g.names =</span> <span class="ot">FALSE</span>), <span class="st">&quot;max_&quot;</span>))</span>
<span id="cb64-7"><a href="#cb64-7"></a><span class="co">#   cyl vs am w_mean_mpg w_mean_disp  w_sd_mpg w_sd_disp min_mpg min_disp max_mpg max_disp</span></span>
<span id="cb64-8"><a href="#cb64-8"></a><span class="co"># 1   4  0  1   26.00000   120.30000 0.0000000  0.000000    26.0    120.3    26.0    120.3</span></span>
<span id="cb64-9"><a href="#cb64-9"></a><span class="co"># 2   4  1  0   22.40856   133.08559 1.2135069 15.279500    21.5    120.1    24.4    146.7</span></span>
<span id="cb64-10"><a href="#cb64-10"></a><span class="co"># 3   4  1  1   27.89791    92.16107 5.1154761 18.535844    21.4     71.1    33.9    121.0</span></span>
<span id="cb64-11"><a href="#cb64-11"></a><span class="co"># 4   6  0  1   20.90036   158.85035 0.4604889  5.313334    19.7    145.0    21.0    160.0</span></span>
<span id="cb64-12"><a href="#cb64-12"></a><span class="co"># 5   6  1  0   18.99825   194.02436 1.3547482 40.942574    17.8    167.6    21.4    258.0</span></span>
<span id="cb64-13"><a href="#cb64-13"></a><span class="co"># 6   8  0  0   15.78964   376.41862 3.3911088 62.540934    10.4    275.8    19.2    472.0</span></span>
<span id="cb64-14"><a href="#cb64-14"></a><span class="co"># 7   8  0  1   15.52423   333.76415 0.5886977 36.793605    15.0    301.0    15.8    351.0</span></span>
<span id="cb64-15"><a href="#cb64-15"></a></span>
<span id="cb64-16"><a href="#cb64-16"></a><span class="co"># Binding and reordering columns in a single step: Add columns in specific positions</span></span>
<span id="cb64-17"><a href="#cb64-17"></a><span class="kw">add_vars</span>(g[[<span class="st">&quot;groups&quot;</span>]],</span>
<span id="cb64-18"><a href="#cb64-18"></a>         <span class="kw">add_stub</span>(<span class="kw">fmean</span>(dat, g, weights, <span class="dt">use.g.names =</span> <span class="ot">FALSE</span>), <span class="st">&quot;w_mean_&quot;</span>),</span>
<span id="cb64-19"><a href="#cb64-19"></a>         <span class="kw">add_stub</span>(<span class="kw">fsd</span>(dat, g, weights, <span class="dt">use.g.names =</span> <span class="ot">FALSE</span>), <span class="st">&quot;w_sd_&quot;</span>),</span>
<span id="cb64-20"><a href="#cb64-20"></a>         <span class="kw">add_stub</span>(<span class="kw">fmin</span>(dat, g, <span class="dt">use.g.names =</span> <span class="ot">FALSE</span>), <span class="st">&quot;min_&quot;</span>),</span>
<span id="cb64-21"><a href="#cb64-21"></a>         <span class="kw">add_stub</span>(<span class="kw">fmax</span>(dat, g, <span class="dt">use.g.names =</span> <span class="ot">FALSE</span>), <span class="st">&quot;max_&quot;</span>),</span>
<span id="cb64-22"><a href="#cb64-22"></a>         <span class="dt">pos =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">8</span>,<span class="dv">5</span>,<span class="dv">9</span>,<span class="dv">6</span>,<span class="dv">10</span>,<span class="dv">7</span>,<span class="dv">11</span>))</span>
<span id="cb64-23"><a href="#cb64-23"></a><span class="co">#   cyl vs am w_mean_mpg  w_sd_mpg min_mpg max_mpg w_mean_disp w_sd_disp min_disp max_disp</span></span>
<span id="cb64-24"><a href="#cb64-24"></a><span class="co"># 1   4  0  1   26.00000 0.0000000    26.0    26.0   120.30000  0.000000    120.3    120.3</span></span>
<span id="cb64-25"><a href="#cb64-25"></a><span class="co"># 2   4  1  0   22.40856 1.2135069    21.5    24.4   133.08559 15.279500    120.1    146.7</span></span>
<span id="cb64-26"><a href="#cb64-26"></a><span class="co"># 3   4  1  1   27.89791 5.1154761    21.4    33.9    92.16107 18.535844     71.1    121.0</span></span>
<span id="cb64-27"><a href="#cb64-27"></a><span class="co"># 4   6  0  1   20.90036 0.4604889    19.7    21.0   158.85035  5.313334    145.0    160.0</span></span>
<span id="cb64-28"><a href="#cb64-28"></a><span class="co"># 5   6  1  0   18.99825 1.3547482    17.8    21.4   194.02436 40.942574    167.6    258.0</span></span>
<span id="cb64-29"><a href="#cb64-29"></a><span class="co"># 6   8  0  0   15.78964 3.3911088    10.4    19.2   376.41862 62.540934    275.8    472.0</span></span>
<span id="cb64-30"><a href="#cb64-30"></a><span class="co"># 7   8  0  1   15.52423 0.5886977    15.0    15.8   333.76415 36.793605    301.0    351.0</span></span></code></pre></div>
<!-- We can also use `add_vars` to bind columns in a different order than as they are passed. Specifying `add_vars(data, newcols1, newcols2, pos = "front")` would be equivalent to `add_vars(newcols1, newcols2, data)` while keeping the attributes of `data`. Moreover it is also possible to pass a vector of positions that the new columns should have in the combined data: -->
<p>The R overhead of this kind of programming in standard-evaluation is very low:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="kw">microbenchmark</span>(<span class="dt">call =</span> <span class="kw">add_vars</span>(g[[<span class="st">&quot;groups&quot;</span>]],</span>
<span id="cb65-2"><a href="#cb65-2"></a>         <span class="kw">add_stub</span>(<span class="kw">fmean</span>(dat, g, weights, <span class="dt">use.g.names =</span> <span class="ot">FALSE</span>), <span class="st">&quot;w_mean_&quot;</span>),</span>
<span id="cb65-3"><a href="#cb65-3"></a>         <span class="kw">add_stub</span>(<span class="kw">fsd</span>(dat, g, weights, <span class="dt">use.g.names =</span> <span class="ot">FALSE</span>), <span class="st">&quot;w_sd_&quot;</span>),</span>
<span id="cb65-4"><a href="#cb65-4"></a>         <span class="kw">add_stub</span>(<span class="kw">fmin</span>(dat, g, <span class="dt">use.g.names =</span> <span class="ot">FALSE</span>), <span class="st">&quot;min_&quot;</span>),</span>
<span id="cb65-5"><a href="#cb65-5"></a>         <span class="kw">add_stub</span>(<span class="kw">fmax</span>(dat, g, <span class="dt">use.g.names =</span> <span class="ot">FALSE</span>), <span class="st">&quot;max_&quot;</span>)))</span>
<span id="cb65-6"><a href="#cb65-6"></a><span class="co"># Unit: microseconds</span></span>
<span id="cb65-7"><a href="#cb65-7"></a><span class="co">#  expr     min      lq     mean  median      uq     max neval</span></span>
<span id="cb65-8"><a href="#cb65-8"></a><span class="co">#  call 112.902 114.686 121.6788 115.579 117.364 281.583   100</span></span></code></pre></div>
</div>
<div id="transformations-using-the-tra-argument" class="section level3">
<h3>4.4 Transformations Using the <code>TRA</code> Argument</h3>
<p>As a final layer of added complexity, we could utilize the <code>TRA</code> argument to generate groupwise-weighted demeaned, and scaled data, with additional columns giving the group-minimum and maximum values:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="kw">head</span>(<span class="kw">add_vars</span>(<span class="kw">get_vars</span>(mtcars, ind),</span>
<span id="cb66-2"><a href="#cb66-2"></a>              <span class="kw">add_stub</span>(<span class="kw">fmean</span>(dat, g, weights, <span class="st">&quot;-&quot;</span>), <span class="st">&quot;w_demean_&quot;</span>), <span class="co"># This calculates weighted group means and uses them to demean the data</span></span>
<span id="cb66-3"><a href="#cb66-3"></a>              <span class="kw">add_stub</span>(<span class="kw">fsd</span>(dat, g, weights, <span class="st">&quot;/&quot;</span>), <span class="st">&quot;w_scale_&quot;</span>),    <span class="co"># This calculates weighted group sd&#39;s and uses them to scale the data</span></span>
<span id="cb66-4"><a href="#cb66-4"></a>              <span class="kw">add_stub</span>(<span class="kw">fmin</span>(dat, g, <span class="st">&quot;replace&quot;</span>), <span class="st">&quot;min_&quot;</span>),          <span class="co"># This replaces all observations by their group-minimum</span></span>
<span id="cb66-5"><a href="#cb66-5"></a>              <span class="kw">add_stub</span>(<span class="kw">fmax</span>(dat, g, <span class="st">&quot;replace&quot;</span>), <span class="st">&quot;max_&quot;</span>)))         <span class="co"># This replaces all observations by their group-maximum</span></span>
<span id="cb66-6"><a href="#cb66-6"></a><span class="co">#                   cyl vs am w_demean_mpg w_demean_disp w_scale_mpg w_scale_disp min_mpg min_disp</span></span>
<span id="cb66-7"><a href="#cb66-7"></a><span class="co"># Mazda RX4           6  0  1   0.09963591      1.149645   45.603704    30.112922    19.7    145.0</span></span>
<span id="cb66-8"><a href="#cb66-8"></a><span class="co"># Mazda RX4 Wag       6  0  1   0.09963591      1.149645   45.603704    30.112922    19.7    145.0</span></span>
<span id="cb66-9"><a href="#cb66-9"></a><span class="co"># Datsun 710          4  1  1  -5.09790706     15.838930    4.457063     5.826549    21.4     71.1</span></span>
<span id="cb66-10"><a href="#cb66-10"></a><span class="co"># Hornet 4 Drive      6  1  0   2.40175356     63.975643   15.796293     6.301509    17.8    167.6</span></span>
<span id="cb66-11"><a href="#cb66-11"></a><span class="co"># Hornet Sportabout   8  0  0   2.91035760    -16.418615    5.514420     5.756230    10.4    275.8</span></span>
<span id="cb66-12"><a href="#cb66-12"></a><span class="co"># Valiant             6  1  0  -0.89824644     30.975643   13.360416     5.495502    17.8    167.6</span></span>
<span id="cb66-13"><a href="#cb66-13"></a><span class="co">#                   max_mpg max_disp</span></span>
<span id="cb66-14"><a href="#cb66-14"></a><span class="co"># Mazda RX4            21.0      160</span></span>
<span id="cb66-15"><a href="#cb66-15"></a><span class="co"># Mazda RX4 Wag        21.0      160</span></span>
<span id="cb66-16"><a href="#cb66-16"></a><span class="co"># Datsun 710           33.9      121</span></span>
<span id="cb66-17"><a href="#cb66-17"></a><span class="co"># Hornet 4 Drive       21.4      258</span></span>
<span id="cb66-18"><a href="#cb66-18"></a><span class="co"># Hornet Sportabout    19.2      472</span></span>
<span id="cb66-19"><a href="#cb66-19"></a><span class="co"># Valiant              21.4      258</span></span></code></pre></div>
<p>It is also possible to <code>add_vars&lt;-</code> to <code>mtcars</code> itself. The default option would add these columns at the end, but we could also specify positions:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="co"># This defines the positions where we want to add these columns</span></span>
<span id="cb67-2"><a href="#cb67-2"></a>pos &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">8</span>,<span class="dv">3</span>,<span class="dv">9</span>,<span class="dv">4</span>,<span class="dv">10</span>,<span class="dv">5</span>,<span class="dv">11</span>)</span>
<span id="cb67-3"><a href="#cb67-3"></a></span>
<span id="cb67-4"><a href="#cb67-4"></a><span class="kw">add_vars</span>(mtcars, pos) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">add_stub</span>(<span class="kw">fmean</span>(dat, g, weights, <span class="st">&quot;-&quot;</span>), <span class="st">&quot;w_demean_&quot;</span>),</span>
<span id="cb67-5"><a href="#cb67-5"></a>                           <span class="kw">add_stub</span>(<span class="kw">fsd</span>(dat, g, weights, <span class="st">&quot;/&quot;</span>), <span class="st">&quot;w_scale_&quot;</span>),</span>
<span id="cb67-6"><a href="#cb67-6"></a>                           <span class="kw">add_stub</span>(<span class="kw">fmin</span>(dat, g, <span class="st">&quot;replace&quot;</span>), <span class="st">&quot;min_&quot;</span>),</span>
<span id="cb67-7"><a href="#cb67-7"></a>                           <span class="kw">add_stub</span>(<span class="kw">fmax</span>(dat, g, <span class="st">&quot;replace&quot;</span>), <span class="st">&quot;max_&quot;</span>))</span>
<span id="cb67-8"><a href="#cb67-8"></a><span class="kw">head</span>(mtcars)</span>
<span id="cb67-9"><a href="#cb67-9"></a><span class="co">#                    mpg w_demean_mpg w_scale_mpg min_mpg max_mpg cyl disp w_demean_disp w_scale_disp</span></span>
<span id="cb67-10"><a href="#cb67-10"></a><span class="co"># Mazda RX4         21.0   0.09963591   45.603704    19.7    21.0   6  160      1.149645    30.112922</span></span>
<span id="cb67-11"><a href="#cb67-11"></a><span class="co"># Mazda RX4 Wag     21.0   0.09963591   45.603704    19.7    21.0   6  160      1.149645    30.112922</span></span>
<span id="cb67-12"><a href="#cb67-12"></a><span class="co"># Datsun 710        22.8  -5.09790706    4.457063    21.4    33.9   4  108     15.838930     5.826549</span></span>
<span id="cb67-13"><a href="#cb67-13"></a><span class="co"># Hornet 4 Drive    21.4   2.40175356   15.796293    17.8    21.4   6  258     63.975643     6.301509</span></span>
<span id="cb67-14"><a href="#cb67-14"></a><span class="co"># Hornet Sportabout 18.7   2.91035760    5.514420    10.4    19.2   8  360    -16.418615     5.756230</span></span>
<span id="cb67-15"><a href="#cb67-15"></a><span class="co"># Valiant           18.1  -0.89824644   13.360416    17.8    21.4   6  225     30.975643     5.495502</span></span>
<span id="cb67-16"><a href="#cb67-16"></a><span class="co">#                   min_disp max_disp  hp drat    wt  qsec vs am gear carb</span></span>
<span id="cb67-17"><a href="#cb67-17"></a><span class="co"># Mazda RX4            145.0      160 110 3.90 2.620 16.46  0  1    4    4</span></span>
<span id="cb67-18"><a href="#cb67-18"></a><span class="co"># Mazda RX4 Wag        145.0      160 110 3.90 2.875 17.02  0  1    4    4</span></span>
<span id="cb67-19"><a href="#cb67-19"></a><span class="co"># Datsun 710            71.1      121  93 3.85 2.320 18.61  1  1    4    1</span></span>
<span id="cb67-20"><a href="#cb67-20"></a><span class="co"># Hornet 4 Drive       167.6      258 110 3.08 3.215 19.44  1  0    3    1</span></span>
<span id="cb67-21"><a href="#cb67-21"></a><span class="co"># Hornet Sportabout    275.8      472 175 3.15 3.440 17.02  0  0    3    2</span></span>
<span id="cb67-22"><a href="#cb67-22"></a><span class="co"># Valiant              167.6      258 105 2.76 3.460 20.22  1  0    3    1</span></span>
<span id="cb67-23"><a href="#cb67-23"></a><span class="kw">rm</span>(mtcars)</span></code></pre></div>
<p>Together with <code>ftransform</code>, things can become arbitrarily more complex:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="co"># 2 different grouped and weighted computations (mutate operations) performed in one call</span></span>
<span id="cb68-2"><a href="#cb68-2"></a><span class="kw">settransform</span>(mtcars, <span class="dt">carb_dwmed_cyl =</span> <span class="kw">fmedian</span>(carb, cyl, weights, <span class="st">&quot;-&quot;</span>),</span>
<span id="cb68-3"><a href="#cb68-3"></a>                     <span class="dt">carb_wsd_vs_am =</span> <span class="kw">fsd</span>(carb, <span class="kw">list</span>(vs, am), weights, <span class="st">&quot;replace&quot;</span>))</span>
<span id="cb68-4"><a href="#cb68-4"></a></span>
<span id="cb68-5"><a href="#cb68-5"></a><span class="co"># Multivariate</span></span>
<span id="cb68-6"><a href="#cb68-6"></a><span class="kw">settransform</span>(mtcars, <span class="kw">c</span>(<span class="kw">fmedian</span>(<span class="kw">list</span>(<span class="dt">carb_dwmed_cyl =</span> carb, <span class="dt">mpg_dwmed_cyl =</span> mpg), cyl, weights, <span class="st">&quot;-&quot;</span>),</span>
<span id="cb68-7"><a href="#cb68-7"></a>                      <span class="kw">fsd</span>(<span class="kw">list</span>(<span class="dt">carb_wsd_vs_am =</span> carb, <span class="dt">mpg_wsd_vs_am =</span> mpg), <span class="kw">list</span>(vs, am), weights, <span class="st">&quot;replace&quot;</span>)))</span>
<span id="cb68-8"><a href="#cb68-8"></a></span>
<span id="cb68-9"><a href="#cb68-9"></a><span class="co"># Nested (Computing the weighted 3rd quartile of mpg, grouped by cyl and carb being greater than it&#39;s weighted median, grouped by vs)</span></span>
<span id="cb68-10"><a href="#cb68-10"></a><span class="kw">settransform</span>(mtcars, </span>
<span id="cb68-11"><a href="#cb68-11"></a> <span class="dt">mpg_gwQ3_cyl =</span> <span class="kw">fnth</span>(mpg, <span class="fl">0.75</span>, <span class="kw">list</span>(cyl, carb <span class="op">&gt;</span><span class="st"> </span><span class="kw">fmedian</span>(carb, vs, weights, 1L)), weights, 1L))</span>
<span id="cb68-12"><a href="#cb68-12"></a></span>
<span id="cb68-13"><a href="#cb68-13"></a><span class="kw">head</span>(mtcars)</span>
<span id="cb68-14"><a href="#cb68-14"></a><span class="co">#                    mpg cyl disp  hp drat    wt  qsec vs am gear carb carb_dwmed_cyl carb_wsd_vs_am</span></span>
<span id="cb68-15"><a href="#cb68-15"></a><span class="co"># Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4              0      1.8898141</span></span>
<span id="cb68-16"><a href="#cb68-16"></a><span class="co"># Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4              0      1.8898141</span></span>
<span id="cb68-17"><a href="#cb68-17"></a><span class="co"># Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1              0      0.5159768</span></span>
<span id="cb68-18"><a href="#cb68-18"></a><span class="co"># Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1             -3      1.4948326</span></span>
<span id="cb68-19"><a href="#cb68-19"></a><span class="co"># Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2              0      0.9629051</span></span>
<span id="cb68-20"><a href="#cb68-20"></a><span class="co"># Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1             -3      1.4948326</span></span>
<span id="cb68-21"><a href="#cb68-21"></a><span class="co">#                   mpg_dwmed_cyl mpg_wsd_vs_am mpg_gwQ3_cyl</span></span>
<span id="cb68-22"><a href="#cb68-22"></a><span class="co"># Mazda RX4                   1.8      4.396835         21.0</span></span>
<span id="cb68-23"><a href="#cb68-23"></a><span class="co"># Mazda RX4 Wag               1.8      4.396835         21.0</span></span>
<span id="cb68-24"><a href="#cb68-24"></a><span class="co"># Datsun 710                 -3.2      5.115476         32.4</span></span>
<span id="cb68-25"><a href="#cb68-25"></a><span class="co"># Hornet 4 Drive              2.2      2.094660         21.4</span></span>
<span id="cb68-26"><a href="#cb68-26"></a><span class="co"># Hornet Sportabout           3.2      3.391109         19.2</span></span>
<span id="cb68-27"><a href="#cb68-27"></a><span class="co"># Valiant                    -1.1      2.094660         21.4</span></span>
<span id="cb68-28"><a href="#cb68-28"></a><span class="kw">rm</span>(mtcars)</span></code></pre></div>
<p>With the full set of 14 <em>Fast Statistical Functions</em>, and additional vector- valued functions and operators (<code>fscale/STD, fbetween/B, fwithin/W, fHDbetween/HDB, fHDwithin/HDW, flag/L/F, fdiff/D, fgrowth/G</code>) discussed later, <em>collapse</em> provides extraordinary new possibilities for highly complex and efficient statistical programming in R. Computation speeds generally exceed those of packages like <em>dplyr</em> or <em>data.table</em>, sometimes by orders of magnitude. Column-wise matrix computations are also highly efficient and comparable to packages like <code>matrixStats</code> and base R functions like <code>colSums</code>. Note that the above examples provide merely suggestions for use of these features and are focused on programming with data frames (as the predicates <code>get_vars</code>, <code>add_vars</code> etc. are made for data frames). Equivalently efficient code could be written using vector or matrices.</p>
<!-- comparable to `column-wise computations on matrices are also slightly faster than `base` functions like `colMeans`, `colSums` etc. especially in the presence of missing values.  -->
<!-- Not really discussed so far were a set of functions `qDF, qDT, qM` which deliver very fast conversions between matrices, data frames and data.tables. -->
<!-- Using *collapse*'s fast functions and the programming principles laid out here can speed up grouped computations by orders of magnitude - even compared to packages like *dplyr* or *data.table*. Simple column-wise computations on matrices are also slightly faster than `base` functions like `colMeans`, `colSums` etc. especially in the presence of missing values.  -->
<!-- .  -->
<!-- , and of course a lot faster than applying these base functions to data.frame's (which involves a conversion to matrix).  -->
<!-- Fast row-wise operations are not really the focus of *collapse* for the moment, also provided that they are not so common. Using conversions with `qM` together with base functions like `rowSums` however does a very decent job of speeding them up (i.e. evaluate the speed of `rowSums(qM(mtcars))` against `rowSums(mtcars)`). -->
</div>
</div>
<div id="advanced-data-aggregation" class="section level2">
<h2>5. Advanced Data Aggregation</h2>
<p>The grouped statistical programming introduced in the previous section is the fastest and most customizable way of dealing with many data transformation problems. Some tasks such as multivariate aggregations on a single data frame are however so common that this demands for a more compact solution which efficiently integrates multiple computational steps.</p>
<p>For such purposes <code>collap</code> was created as a fast multi-purpose aggregation command designed to solve complex aggregation problems efficiently and with a minimum of coding. <code>collap</code> performs optimally together with the <em>Fast Statistical Functions</em>, but will also work with other functions.</p>
<p>To perform the above aggregation with <code>collap</code>, one would simply need to type:</p>
<!-- ^[One can also add a weight-argument `w = weights` here, but `fmin` and `fmax` don't support weights and all S3 methods in this package give errors when encountering unknown arguments. To do a weighted aggregation one would have to either only use `fmean` and `fsd`, or employ a named list of functions wrapping `fmin` and `fmax` in a way that additional arguments are silently swallowed.]: -->
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a><span class="kw">collap</span>(mtcars, mpg <span class="op">+</span><span class="st"> </span>disp <span class="op">~</span><span class="st"> </span>cyl <span class="op">+</span><span class="st"> </span>vs <span class="op">+</span><span class="st"> </span>am, <span class="kw">list</span>(fmean, fsd, fmin, fmax), <span class="dt">w =</span> weights, <span class="dt">keep.col.order =</span> <span class="ot">FALSE</span>)</span>
<span id="cb69-2"><a href="#cb69-2"></a><span class="co">#   cyl vs am   weights fmean.mpg fmean.disp   fsd.mpg  fsd.disp fmin.mpg fmin.disp fmax.mpg fmax.disp</span></span>
<span id="cb69-3"><a href="#cb69-3"></a><span class="co"># 1   4  0  1  1.356868  26.00000  120.30000 0.0000000  0.000000     26.0     120.3     26.0     120.3</span></span>
<span id="cb69-4"><a href="#cb69-4"></a><span class="co"># 2   4  1  0  1.922929  22.40856  133.08559 1.2135069 15.279500     21.5     120.1     24.4     146.7</span></span>
<span id="cb69-5"><a href="#cb69-5"></a><span class="co"># 3   4  1  1  5.590805  27.89791   92.16107 5.1154761 18.535844     21.4      71.1     33.9     121.0</span></span>
<span id="cb69-6"><a href="#cb69-6"></a><span class="co"># 4   6  0  1  2.293656  20.90036  158.85035 0.4604889  5.313334     19.7     145.0     21.0     160.0</span></span>
<span id="cb69-7"><a href="#cb69-7"></a><span class="co"># 5   6  1  0  4.267331  18.99825  194.02436 1.3547482 40.942574     17.8     167.6     21.4     258.0</span></span>
<span id="cb69-8"><a href="#cb69-8"></a><span class="co"># 6   8  0  0 10.489018  15.78964  376.41862 3.3911088 62.540934     10.4     275.8     19.2     472.0</span></span>
<span id="cb69-9"><a href="#cb69-9"></a><span class="co"># 7   8  0  1  1.715692  15.52423  333.76415 0.5886977 36.793605     15.0     301.0     15.8     351.0</span></span></code></pre></div>
<p><code>collap</code> here also saves the sum of the weights in a column. The original idea behind <code>collap</code> is however better demonstrated with a different dataset. Consider the <em>World Development Dataset</em> <code>wlddev</code> included in the package and introduced in section 1:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="kw">head</span>(wlddev)</span>
<span id="cb70-2"><a href="#cb70-2"></a><span class="co">#       country iso3c       date year decade     region     income  OECD PCGDP LIFEEX GINI       ODA</span></span>
<span id="cb70-3"><a href="#cb70-3"></a><span class="co"># 1 Afghanistan   AFG 1961-01-01 1960   1960 South Asia Low income FALSE    NA 32.292   NA 114440000</span></span>
<span id="cb70-4"><a href="#cb70-4"></a><span class="co"># 2 Afghanistan   AFG 1962-01-01 1961   1960 South Asia Low income FALSE    NA 32.742   NA 233350000</span></span>
<span id="cb70-5"><a href="#cb70-5"></a><span class="co"># 3 Afghanistan   AFG 1963-01-01 1962   1960 South Asia Low income FALSE    NA 33.185   NA 114880000</span></span>
<span id="cb70-6"><a href="#cb70-6"></a><span class="co"># 4 Afghanistan   AFG 1964-01-01 1963   1960 South Asia Low income FALSE    NA 33.624   NA 236450000</span></span>
<span id="cb70-7"><a href="#cb70-7"></a><span class="co"># 5 Afghanistan   AFG 1965-01-01 1964   1960 South Asia Low income FALSE    NA 34.060   NA 302480000</span></span>
<span id="cb70-8"><a href="#cb70-8"></a><span class="co"># 6 Afghanistan   AFG 1966-01-01 1965   1960 South Asia Low income FALSE    NA 34.495   NA 370250000</span></span></code></pre></div>
<p>Suppose we would like to aggregate this data by country and decade, but keep all that categorical information. With <code>collap</code> this is extremely simple:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="kw">head</span>(<span class="kw">collap</span>(wlddev, <span class="op">~</span><span class="st"> </span>iso3c <span class="op">+</span><span class="st"> </span>decade))</span>
<span id="cb71-2"><a href="#cb71-2"></a><span class="co">#   country iso3c       date   year decade                     region      income  OECD    PCGDP</span></span>
<span id="cb71-3"><a href="#cb71-3"></a><span class="co"># 1   Aruba   ABW 1961-01-01 1962.5   1960 Latin America &amp; Caribbean  High income FALSE       NA</span></span>
<span id="cb71-4"><a href="#cb71-4"></a><span class="co"># 2   Aruba   ABW 1967-01-01 1970.0   1970 Latin America &amp; Caribbean  High income FALSE       NA</span></span>
<span id="cb71-5"><a href="#cb71-5"></a><span class="co"># 3   Aruba   ABW 1976-01-01 1980.0   1980 Latin America &amp; Caribbean  High income FALSE       NA</span></span>
<span id="cb71-6"><a href="#cb71-6"></a><span class="co"># 4   Aruba   ABW 1987-01-01 1990.0   1990 Latin America &amp; Caribbean  High income FALSE 23677.09</span></span>
<span id="cb71-7"><a href="#cb71-7"></a><span class="co"># 5   Aruba   ABW 1996-01-01 2000.0   2000 Latin America &amp; Caribbean  High income FALSE 26766.93</span></span>
<span id="cb71-8"><a href="#cb71-8"></a><span class="co"># 6   Aruba   ABW 2007-01-01 2010.0   2010 Latin America &amp; Caribbean  High income FALSE 25238.80</span></span>
<span id="cb71-9"><a href="#cb71-9"></a><span class="co">#     LIFEEX GINI      ODA</span></span>
<span id="cb71-10"><a href="#cb71-10"></a><span class="co"># 1 66.58583   NA       NA</span></span>
<span id="cb71-11"><a href="#cb71-11"></a><span class="co"># 2 69.14178   NA       NA</span></span>
<span id="cb71-12"><a href="#cb71-12"></a><span class="co"># 3 72.17600   NA 33630000</span></span>
<span id="cb71-13"><a href="#cb71-13"></a><span class="co"># 4 73.45356   NA 41563333</span></span>
<span id="cb71-14"><a href="#cb71-14"></a><span class="co"># 5 73.85773   NA 19857000</span></span>
<span id="cb71-15"><a href="#cb71-15"></a><span class="co"># 6 75.01078   NA       NA</span></span></code></pre></div>
<p>Note that the columns of the data are in the original order and also retain all their attributes. To understand this result let us briefly examine the syntax of <code>collap</code>:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a><span class="kw">collap</span>(X, by, <span class="dt">FUN =</span> fmean, <span class="dt">catFUN =</span> fmode, <span class="dt">cols =</span> <span class="ot">NULL</span>, <span class="dt">w =</span> <span class="ot">NULL</span>, <span class="dt">wFUN =</span> fsum,</span>
<span id="cb72-2"><a href="#cb72-2"></a>       <span class="dt">custom =</span> <span class="ot">NULL</span>, <span class="dt">keep.by =</span> <span class="ot">TRUE</span>, <span class="dt">keep.w =</span> <span class="ot">TRUE</span>, <span class="dt">keep.col.order =</span> <span class="ot">TRUE</span>, </span>
<span id="cb72-3"><a href="#cb72-3"></a>       <span class="dt">sort.row =</span> <span class="ot">TRUE</span>, <span class="dt">parallel =</span> <span class="ot">FALSE</span>, <span class="dt">mc.cores =</span> 1L,</span>
<span id="cb72-4"><a href="#cb72-4"></a>       <span class="dt">return =</span> <span class="kw">c</span>(<span class="st">&quot;wide&quot;</span>,<span class="st">&quot;list&quot;</span>,<span class="st">&quot;long&quot;</span>,<span class="st">&quot;long_dupl&quot;</span>), <span class="dt">give.names =</span> <span class="st">&quot;auto&quot;</span>) <span class="co"># , ...</span></span></code></pre></div>
<p>It is clear that <code>X</code> is the data and <code>by</code> supplies the grouping information, which can be a one- or two-sided formula or alternatively grouping vectors, factors, lists and <code>GRP</code> objects (like the <em>Fast Statistical Functions</em>). Then <code>FUN</code> provides the function(s) applied only to numeric variables in <code>X</code> and defaults to <code>fmean</code>, while <code>catFUN</code> provides the function(s) applied only to categorical variables in <code>X</code> and defaults to <code>fmode</code><a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>. <code>keep.col.order = TRUE</code> specifies that the data is to be returned with the original column-order. Thus in the above example it was sufficient to supply <code>X</code> and <code>by</code> and <code>collap</code> did the rest for us.</p>
<p>Suppose we only want to aggregate the 4 series in this dataset. This can be done either through a two-sided formula or utilizing the <code>cols</code> argument:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a><span class="co"># Same as collap(wlddev, ~ iso3c + decade, cols = 9:12)</span></span>
<span id="cb73-2"><a href="#cb73-2"></a><span class="kw">head</span>(<span class="kw">collap</span>(wlddev, PCGDP <span class="op">+</span><span class="st"> </span>LIFEEX <span class="op">+</span><span class="st"> </span>GINI <span class="op">+</span><span class="st"> </span>ODA <span class="op">~</span><span class="st"> </span>iso3c <span class="op">+</span><span class="st"> </span>decade))</span>
<span id="cb73-3"><a href="#cb73-3"></a><span class="co">#   iso3c decade    PCGDP   LIFEEX GINI      ODA</span></span>
<span id="cb73-4"><a href="#cb73-4"></a><span class="co"># 1   ABW   1960       NA 66.58583   NA       NA</span></span>
<span id="cb73-5"><a href="#cb73-5"></a><span class="co"># 2   ABW   1970       NA 69.14178   NA       NA</span></span>
<span id="cb73-6"><a href="#cb73-6"></a><span class="co"># 3   ABW   1980       NA 72.17600   NA 33630000</span></span>
<span id="cb73-7"><a href="#cb73-7"></a><span class="co"># 4   ABW   1990 23677.09 73.45356   NA 41563333</span></span>
<span id="cb73-8"><a href="#cb73-8"></a><span class="co"># 5   ABW   2000 26766.93 73.85773   NA 19857000</span></span>
<span id="cb73-9"><a href="#cb73-9"></a><span class="co"># 6   ABW   2010 25238.80 75.01078   NA       NA</span></span></code></pre></div>
<p>As before we could use multiple functions by putting them in a named or unnamed list<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a><span class="kw">head</span>(<span class="kw">collap</span>(wlddev, <span class="op">~</span><span class="st"> </span>iso3c <span class="op">+</span><span class="st"> </span>decade, <span class="kw">list</span>(fmean, fmedian, fsd), <span class="dt">cols =</span> <span class="dv">9</span><span class="op">:</span><span class="dv">12</span>))</span>
<span id="cb74-2"><a href="#cb74-2"></a><span class="co">#   iso3c decade fmean.PCGDP fmedian.PCGDP fsd.PCGDP fmean.LIFEEX fmedian.LIFEEX fsd.LIFEEX fmean.GINI</span></span>
<span id="cb74-3"><a href="#cb74-3"></a><span class="co"># 1   ABW   1960          NA            NA        NA     66.58583        66.6155  0.6595475         NA</span></span>
<span id="cb74-4"><a href="#cb74-4"></a><span class="co"># 2   ABW   1970          NA            NA        NA     69.14178        69.1400  0.9521791         NA</span></span>
<span id="cb74-5"><a href="#cb74-5"></a><span class="co"># 3   ABW   1980          NA            NA        NA     72.17600        72.2930  0.8054561         NA</span></span>
<span id="cb74-6"><a href="#cb74-6"></a><span class="co"># 4   ABW   1990    23677.09      25357.79 4100.7901     73.45356        73.4680  0.1152921         NA</span></span>
<span id="cb74-7"><a href="#cb74-7"></a><span class="co"># 5   ABW   2000    26766.93      26966.05  834.3735     73.85773        73.7870  0.2217034         NA</span></span>
<span id="cb74-8"><a href="#cb74-8"></a><span class="co"># 6   ABW   2010    25238.80      24629.08 1580.8698     75.01078        75.0160  0.3942914         NA</span></span>
<span id="cb74-9"><a href="#cb74-9"></a><span class="co">#   fmedian.GINI fsd.GINI fmean.ODA fmedian.ODA  fsd.ODA</span></span>
<span id="cb74-10"><a href="#cb74-10"></a><span class="co"># 1           NA       NA        NA          NA       NA</span></span>
<span id="cb74-11"><a href="#cb74-11"></a><span class="co"># 2           NA       NA        NA          NA       NA</span></span>
<span id="cb74-12"><a href="#cb74-12"></a><span class="co"># 3           NA       NA  33630000    33630000       NA</span></span>
<span id="cb74-13"><a href="#cb74-13"></a><span class="co"># 4           NA       NA  41563333    36710000 16691094</span></span>
<span id="cb74-14"><a href="#cb74-14"></a><span class="co"># 5           NA       NA  19857000    16530000 28602034</span></span>
<span id="cb74-15"><a href="#cb74-15"></a><span class="co"># 6           NA       NA        NA          NA       NA</span></span></code></pre></div>
<p>With multiple functions, we could also request <code>collap</code> to return a long-format of the data:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="kw">head</span>(<span class="kw">collap</span>(wlddev, <span class="op">~</span><span class="st"> </span>iso3c <span class="op">+</span><span class="st"> </span>decade, <span class="kw">list</span>(fmean, fmedian, fsd), <span class="dt">cols =</span> <span class="dv">9</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">return =</span> <span class="st">&quot;long&quot;</span>))</span>
<span id="cb75-2"><a href="#cb75-2"></a><span class="co">#   Function iso3c decade    PCGDP   LIFEEX GINI      ODA</span></span>
<span id="cb75-3"><a href="#cb75-3"></a><span class="co"># 1    fmean   ABW   1960       NA 66.58583   NA       NA</span></span>
<span id="cb75-4"><a href="#cb75-4"></a><span class="co"># 2    fmean   ABW   1970       NA 69.14178   NA       NA</span></span>
<span id="cb75-5"><a href="#cb75-5"></a><span class="co"># 3    fmean   ABW   1980       NA 72.17600   NA 33630000</span></span>
<span id="cb75-6"><a href="#cb75-6"></a><span class="co"># 4    fmean   ABW   1990 23677.09 73.45356   NA 41563333</span></span>
<span id="cb75-7"><a href="#cb75-7"></a><span class="co"># 5    fmean   ABW   2000 26766.93 73.85773   NA 19857000</span></span>
<span id="cb75-8"><a href="#cb75-8"></a><span class="co"># 6    fmean   ABW   2010 25238.80 75.01078   NA       NA</span></span></code></pre></div>
<p>The final feature of <code>collap</code> to highlight at this point is the <code>custom</code> argument, which allows the user to circumvent the broad distinction into numeric and categorical data (and the associated <code>FUN</code> and <code>catFUN</code> arguments) and specify exactly which columns to aggregate using which functions:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a><span class="kw">head</span>(<span class="kw">collap</span>(wlddev, <span class="op">~</span><span class="st"> </span>iso3c <span class="op">+</span><span class="st"> </span>decade,</span>
<span id="cb76-2"><a href="#cb76-2"></a>            <span class="dt">custom =</span> <span class="kw">list</span>(<span class="dt">fmean =</span> <span class="dv">9</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">fsd =</span> <span class="dv">9</span><span class="op">:</span><span class="dv">12</span>,</span>
<span id="cb76-3"><a href="#cb76-3"></a>                          <span class="dt">ffirst =</span> <span class="kw">c</span>(<span class="st">&quot;country&quot;</span>,<span class="st">&quot;region&quot;</span>,<span class="st">&quot;income&quot;</span>),</span>
<span id="cb76-4"><a href="#cb76-4"></a>                          <span class="dt">flast =</span> <span class="kw">c</span>(<span class="st">&quot;year&quot;</span>,<span class="st">&quot;date&quot;</span>),</span>
<span id="cb76-5"><a href="#cb76-5"></a>                          <span class="dt">fmode =</span> <span class="st">&quot;OECD&quot;</span>)))</span>
<span id="cb76-6"><a href="#cb76-6"></a><span class="co">#   ffirst.country iso3c flast.date flast.year decade              ffirst.region ffirst.income</span></span>
<span id="cb76-7"><a href="#cb76-7"></a><span class="co"># 1          Aruba   ABW 1966-01-01       1965   1960 Latin America &amp; Caribbean    High income</span></span>
<span id="cb76-8"><a href="#cb76-8"></a><span class="co"># 2          Aruba   ABW 1975-01-01       1974   1970 Latin America &amp; Caribbean    High income</span></span>
<span id="cb76-9"><a href="#cb76-9"></a><span class="co"># 3          Aruba   ABW 1986-01-01       1985   1980 Latin America &amp; Caribbean    High income</span></span>
<span id="cb76-10"><a href="#cb76-10"></a><span class="co"># 4          Aruba   ABW 1995-01-01       1994   1990 Latin America &amp; Caribbean    High income</span></span>
<span id="cb76-11"><a href="#cb76-11"></a><span class="co"># 5          Aruba   ABW 2006-01-01       2005   2000 Latin America &amp; Caribbean    High income</span></span>
<span id="cb76-12"><a href="#cb76-12"></a><span class="co"># 6          Aruba   ABW 2015-01-01       2014   2010 Latin America &amp; Caribbean    High income</span></span>
<span id="cb76-13"><a href="#cb76-13"></a><span class="co">#   fmode.OECD fmean.PCGDP fsd.PCGDP fmean.LIFEEX fsd.LIFEEX fmean.GINI fsd.GINI fmean.ODA  fsd.ODA</span></span>
<span id="cb76-14"><a href="#cb76-14"></a><span class="co"># 1      FALSE          NA        NA     66.58583  0.6595475         NA       NA        NA       NA</span></span>
<span id="cb76-15"><a href="#cb76-15"></a><span class="co"># 2      FALSE          NA        NA     69.14178  0.9521791         NA       NA        NA       NA</span></span>
<span id="cb76-16"><a href="#cb76-16"></a><span class="co"># 3      FALSE          NA        NA     72.17600  0.8054561         NA       NA  33630000       NA</span></span>
<span id="cb76-17"><a href="#cb76-17"></a><span class="co"># 4      FALSE    23677.09 4100.7901     73.45356  0.1152921         NA       NA  41563333 16691094</span></span>
<span id="cb76-18"><a href="#cb76-18"></a><span class="co"># 5      FALSE    26766.93  834.3735     73.85773  0.2217034         NA       NA  19857000 28602034</span></span>
<span id="cb76-19"><a href="#cb76-19"></a><span class="co"># 6      FALSE    25238.80 1580.8698     75.01078  0.3942914         NA       NA        NA       NA</span></span></code></pre></div>
<p>Through setting the argument <code>give.names = FALSE</code>, the output can also be generated without changing the column names. Next to <code>collap</code>, the functions <code>collapv</code> provides a programmers alternative allowing grouping and weighting columns to be passed using column names or indices, and the function <code>collapg</code> operates on grouped data frames (class ‘grouped_df’).</p>
</div>
<div id="data-transformations" class="section level2">
<h2>6. Data Transformations</h2>
<p>While <code>ftransform</code> and the <code>TRA</code> argument to the <em>Fast Statistical Functions</em> introduced earlier already provide a significant scope for transforming data, this section introduces some further specialized functions covering some advanced and common use cases, sometimes with greater efficiency.</p>
<!-- *collapse* also provides an ensemble of function to perform common data transformations extremely efficiently and user friendly.  -->
<!-- I start off this section by briefly introducing two apply functions I thought were missing in the base R ensemble, and then quickly move to the more involved functions to carry out extremely fast grouped transformations. -->
<div id="row-and-column-data-apply" class="section level3">
<h3>6.1 Row and Column Data Apply</h3>
<p><code>dapply</code> is an efficient apply command for matrices and data frames. It can be used to apply functions to rows or (by default) columns of matrices or data frames and by default returns objects of the same type and with the same attributes unless the result of each computation is a scalar.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a><span class="kw">dapply</span>(mtcars, median)</span>
<span id="cb77-2"><a href="#cb77-2"></a><span class="co">#     mpg     cyl    disp      hp    drat      wt    qsec      vs      am    gear    carb </span></span>
<span id="cb77-3"><a href="#cb77-3"></a><span class="co">#  19.200   6.000 196.300 123.000   3.695   3.325  17.710   0.000   0.000   4.000   2.000</span></span>
<span id="cb77-4"><a href="#cb77-4"></a></span>
<span id="cb77-5"><a href="#cb77-5"></a><span class="kw">dapply</span>(mtcars, median, <span class="dt">MARGIN =</span> <span class="dv">1</span>)</span>
<span id="cb77-6"><a href="#cb77-6"></a><span class="co">#           Mazda RX4       Mazda RX4 Wag          Datsun 710      Hornet 4 Drive   Hornet Sportabout </span></span>
<span id="cb77-7"><a href="#cb77-7"></a><span class="co">#               4.000               4.000               4.000               3.215               3.440 </span></span>
<span id="cb77-8"><a href="#cb77-8"></a><span class="co">#             Valiant          Duster 360           Merc 240D            Merc 230            Merc 280 </span></span>
<span id="cb77-9"><a href="#cb77-9"></a><span class="co">#               3.460               4.000               4.000               4.000               4.000 </span></span>
<span id="cb77-10"><a href="#cb77-10"></a><span class="co">#           Merc 280C          Merc 450SE          Merc 450SL         Merc 450SLC  Cadillac Fleetwood </span></span>
<span id="cb77-11"><a href="#cb77-11"></a><span class="co">#               4.000               4.070               3.730               3.780               5.250 </span></span>
<span id="cb77-12"><a href="#cb77-12"></a><span class="co"># Lincoln Continental   Chrysler Imperial            Fiat 128         Honda Civic      Toyota Corolla </span></span>
<span id="cb77-13"><a href="#cb77-13"></a><span class="co">#               5.424               5.345               4.000               4.000               4.000 </span></span>
<span id="cb77-14"><a href="#cb77-14"></a><span class="co">#       Toyota Corona    Dodge Challenger         AMC Javelin          Camaro Z28    Pontiac Firebird </span></span>
<span id="cb77-15"><a href="#cb77-15"></a><span class="co">#               3.700               3.520               3.435               4.000               3.845 </span></span>
<span id="cb77-16"><a href="#cb77-16"></a><span class="co">#           Fiat X1-9       Porsche 914-2        Lotus Europa      Ford Pantera L        Ferrari Dino </span></span>
<span id="cb77-17"><a href="#cb77-17"></a><span class="co">#               4.000               4.430               4.000               5.000               6.000 </span></span>
<span id="cb77-18"><a href="#cb77-18"></a><span class="co">#       Maserati Bora          Volvo 142E </span></span>
<span id="cb77-19"><a href="#cb77-19"></a><span class="co">#               8.000               4.000</span></span>
<span id="cb77-20"><a href="#cb77-20"></a></span>
<span id="cb77-21"><a href="#cb77-21"></a><span class="kw">dapply</span>(mtcars, quantile)</span>
<span id="cb77-22"><a href="#cb77-22"></a><span class="co">#         mpg cyl    disp    hp  drat      wt    qsec vs am gear carb</span></span>
<span id="cb77-23"><a href="#cb77-23"></a><span class="co"># 0%   10.400   4  71.100  52.0 2.760 1.51300 14.5000  0  0    3    1</span></span>
<span id="cb77-24"><a href="#cb77-24"></a><span class="co"># 25%  15.425   4 120.825  96.5 3.080 2.58125 16.8925  0  0    3    2</span></span>
<span id="cb77-25"><a href="#cb77-25"></a><span class="co"># 50%  19.200   6 196.300 123.0 3.695 3.32500 17.7100  0  0    4    2</span></span>
<span id="cb77-26"><a href="#cb77-26"></a><span class="co"># 75%  22.800   8 326.000 180.0 3.920 3.61000 18.9000  1  1    4    4</span></span>
<span id="cb77-27"><a href="#cb77-27"></a><span class="co"># 100% 33.900   8 472.000 335.0 4.930 5.42400 22.9000  1  1    5    8</span></span>
<span id="cb77-28"><a href="#cb77-28"></a></span>
<span id="cb77-29"><a href="#cb77-29"></a><span class="kw">head</span>(<span class="kw">dapply</span>(mtcars, quantile, <span class="dt">MARGIN =</span> <span class="dv">1</span>))</span>
<span id="cb77-30"><a href="#cb77-30"></a><span class="co">#                   0%    25%   50%    75% 100%</span></span>
<span id="cb77-31"><a href="#cb77-31"></a><span class="co"># Mazda RX4          0 3.2600 4.000 18.730  160</span></span>
<span id="cb77-32"><a href="#cb77-32"></a><span class="co"># Mazda RX4 Wag      0 3.3875 4.000 19.010  160</span></span>
<span id="cb77-33"><a href="#cb77-33"></a><span class="co"># Datsun 710         1 1.6600 4.000 20.705  108</span></span>
<span id="cb77-34"><a href="#cb77-34"></a><span class="co"># Hornet 4 Drive     0 2.0000 3.215 20.420  258</span></span>
<span id="cb77-35"><a href="#cb77-35"></a><span class="co"># Hornet Sportabout  0 2.5000 3.440 17.860  360</span></span>
<span id="cb77-36"><a href="#cb77-36"></a><span class="co"># Valiant            0 1.8800 3.460 19.160  225</span></span>
<span id="cb77-37"><a href="#cb77-37"></a></span>
<span id="cb77-38"><a href="#cb77-38"></a><span class="kw">head</span>(<span class="kw">dapply</span>(mtcars, log)) <span class="co"># This is considerably more efficient than log(mtcars)</span></span>
<span id="cb77-39"><a href="#cb77-39"></a><span class="co">#                        mpg      cyl     disp       hp     drat        wt     qsec   vs   am     gear</span></span>
<span id="cb77-40"><a href="#cb77-40"></a><span class="co"># Mazda RX4         3.044522 1.791759 5.075174 4.700480 1.360977 0.9631743 2.800933 -Inf    0 1.386294</span></span>
<span id="cb77-41"><a href="#cb77-41"></a><span class="co"># Mazda RX4 Wag     3.044522 1.791759 5.075174 4.700480 1.360977 1.0560527 2.834389 -Inf    0 1.386294</span></span>
<span id="cb77-42"><a href="#cb77-42"></a><span class="co"># Datsun 710        3.126761 1.386294 4.682131 4.532599 1.348073 0.8415672 2.923699    0    0 1.386294</span></span>
<span id="cb77-43"><a href="#cb77-43"></a><span class="co"># Hornet 4 Drive    3.063391 1.791759 5.552960 4.700480 1.124930 1.1678274 2.967333    0 -Inf 1.098612</span></span>
<span id="cb77-44"><a href="#cb77-44"></a><span class="co"># Hornet Sportabout 2.928524 2.079442 5.886104 5.164786 1.147402 1.2354715 2.834389 -Inf -Inf 1.098612</span></span>
<span id="cb77-45"><a href="#cb77-45"></a><span class="co"># Valiant           2.895912 1.791759 5.416100 4.653960 1.015231 1.2412686 3.006672    0 -Inf 1.098612</span></span>
<span id="cb77-46"><a href="#cb77-46"></a><span class="co">#                        carb</span></span>
<span id="cb77-47"><a href="#cb77-47"></a><span class="co"># Mazda RX4         1.3862944</span></span>
<span id="cb77-48"><a href="#cb77-48"></a><span class="co"># Mazda RX4 Wag     1.3862944</span></span>
<span id="cb77-49"><a href="#cb77-49"></a><span class="co"># Datsun 710        0.0000000</span></span>
<span id="cb77-50"><a href="#cb77-50"></a><span class="co"># Hornet 4 Drive    0.0000000</span></span>
<span id="cb77-51"><a href="#cb77-51"></a><span class="co"># Hornet Sportabout 0.6931472</span></span>
<span id="cb77-52"><a href="#cb77-52"></a><span class="co"># Valiant           0.0000000</span></span></code></pre></div>
<p><code>dapply</code> preserves the data structure:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a><span class="kw">is.data.frame</span>(<span class="kw">dapply</span>(mtcars, log))</span>
<span id="cb78-2"><a href="#cb78-2"></a><span class="co"># [1] TRUE</span></span>
<span id="cb78-3"><a href="#cb78-3"></a><span class="kw">is.matrix</span>(<span class="kw">dapply</span>(m, log))</span>
<span id="cb78-4"><a href="#cb78-4"></a><span class="co"># [1] TRUE</span></span></code></pre></div>
<p>It also delivers seamless conversions, i.e. you can apply functions to data frame rows or columns and return a matrix and vice-versa:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a><span class="kw">identical</span>(<span class="kw">log</span>(m), <span class="kw">dapply</span>(mtcars, log, <span class="dt">return =</span> <span class="st">&quot;matrix&quot;</span>))</span>
<span id="cb79-2"><a href="#cb79-2"></a><span class="co"># [1] TRUE</span></span>
<span id="cb79-3"><a href="#cb79-3"></a><span class="kw">identical</span>(<span class="kw">dapply</span>(mtcars, log), <span class="kw">dapply</span>(m, log, <span class="dt">return =</span> <span class="st">&quot;data.frame&quot;</span>))</span>
<span id="cb79-4"><a href="#cb79-4"></a><span class="co"># [1] TRUE</span></span></code></pre></div>
<p>On data frames, the performance is comparable to <code>lapply</code>, and <code>dapply</code> is about 2x faster than <code>apply</code> for row- or column-wise operations on matrices. The most important feature is that it does not change the structure of the data at all: all attributes are preserved unless the result is a scalar and <code>drop = TRUE</code> (the default).</p>
<!-- so you can use `dapply` on a data table, grouped tibble, or on a time series matrix and get a transformed object of the same class back  -->
</div>
<div id="split-apply-combine-computing" class="section level3">
<h3>6.2 Split-Apply-Combine Computing</h3>
<p><code>BY</code> is a generalization of <code>dapply</code> for grouped computations using functions that are not part of the <em>Fast Statistical Functions</em> introduced above. It fundamentally is a re-implementation of the <code>lapply(split(x, g), FUN, ...)</code> computing paradigm in base R, but substantially faster and more versatile than functions like <code>tapply</code>, <code>by</code> or <code>aggregate</code>. It is however not faster than <em>dplyr</em> or <em>data.table</em> for larger grouped computations on data frames requiring split-apply-combine computing.</p>
<p><code>BY</code> is S3 generic with methods for vector, matrix, data.frame and grouped_df<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>. It also supports the same grouping (<code>g</code>) inputs as the <em>Fast Statistical Functions</em> (grouping vectors, factors, lists or <em>GRP</em> objects). Below the use of <code>BY</code> is demonstrated on vectors matrices and data frames.</p>
<!-- On bigger data.frame's however split-apply combine computing with *dplyr* is faster.  -->
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a>v &lt;-<span class="st"> </span>iris<span class="op">$</span>Sepal.Length   <span class="co"># A numeric vector</span></span>
<span id="cb80-2"><a href="#cb80-2"></a>f &lt;-<span class="st"> </span>iris<span class="op">$</span>Species        <span class="co"># A factor</span></span>
<span id="cb80-3"><a href="#cb80-3"></a></span>
<span id="cb80-4"><a href="#cb80-4"></a><span class="co">## default vector method</span></span>
<span id="cb80-5"><a href="#cb80-5"></a><span class="kw">BY</span>(v, f, sum)                          <span class="co"># Sum by species, about 2x faster than tapply(v, f, sum)</span></span>
<span id="cb80-6"><a href="#cb80-6"></a><span class="co">#     setosa versicolor  virginica </span></span>
<span id="cb80-7"><a href="#cb80-7"></a><span class="co">#      250.3      296.8      329.4</span></span>
<span id="cb80-8"><a href="#cb80-8"></a></span>
<span id="cb80-9"><a href="#cb80-9"></a><span class="kw">BY</span>(v, f, quantile)                     <span class="co"># Species quantiles: by default stacked</span></span>
<span id="cb80-10"><a href="#cb80-10"></a><span class="co">#       setosa.0%      setosa.25%      setosa.50%      setosa.75%     setosa.100%   versicolor.0% </span></span>
<span id="cb80-11"><a href="#cb80-11"></a><span class="co">#           4.300           4.800           5.000           5.200           5.800           4.900 </span></span>
<span id="cb80-12"><a href="#cb80-12"></a><span class="co">#  versicolor.25%  versicolor.50%  versicolor.75% versicolor.100%    virginica.0%   virginica.25% </span></span>
<span id="cb80-13"><a href="#cb80-13"></a><span class="co">#           5.600           5.900           6.300           7.000           4.900           6.225 </span></span>
<span id="cb80-14"><a href="#cb80-14"></a><span class="co">#   virginica.50%   virginica.75%  virginica.100% </span></span>
<span id="cb80-15"><a href="#cb80-15"></a><span class="co">#           6.500           6.900           7.900</span></span>
<span id="cb80-16"><a href="#cb80-16"></a></span>
<span id="cb80-17"><a href="#cb80-17"></a><span class="kw">BY</span>(v, f, quantile, <span class="dt">expand.wide =</span> <span class="ot">TRUE</span>) <span class="co"># Wide format</span></span>
<span id="cb80-18"><a href="#cb80-18"></a><span class="co">#             0%   25% 50% 75% 100%</span></span>
<span id="cb80-19"><a href="#cb80-19"></a><span class="co"># setosa     4.3 4.800 5.0 5.2  5.8</span></span>
<span id="cb80-20"><a href="#cb80-20"></a><span class="co"># versicolor 4.9 5.600 5.9 6.3  7.0</span></span>
<span id="cb80-21"><a href="#cb80-21"></a><span class="co"># virginica  4.9 6.225 6.5 6.9  7.9</span></span>
<span id="cb80-22"><a href="#cb80-22"></a></span>
<span id="cb80-23"><a href="#cb80-23"></a><span class="co">## matrix method</span></span>
<span id="cb80-24"><a href="#cb80-24"></a>miris &lt;-<span class="st"> </span><span class="kw">qM</span>(<span class="kw">num_vars</span>(iris))</span>
<span id="cb80-25"><a href="#cb80-25"></a><span class="kw">BY</span>(miris, f, sum)                          <span class="co"># Also returns as matrix</span></span>
<span id="cb80-26"><a href="#cb80-26"></a><span class="co">#            Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span>
<span id="cb80-27"><a href="#cb80-27"></a><span class="co"># setosa            250.3       171.4         73.1        12.3</span></span>
<span id="cb80-28"><a href="#cb80-28"></a><span class="co"># versicolor        296.8       138.5        213.0        66.3</span></span>
<span id="cb80-29"><a href="#cb80-29"></a><span class="co"># virginica         329.4       148.7        277.6       101.3</span></span>
<span id="cb80-30"><a href="#cb80-30"></a></span>
<span id="cb80-31"><a href="#cb80-31"></a><span class="kw">head</span>(<span class="kw">BY</span>(miris, f, quantile))</span>
<span id="cb80-32"><a href="#cb80-32"></a><span class="co">#               Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span>
<span id="cb80-33"><a href="#cb80-33"></a><span class="co"># setosa.0%              4.3       2.300        1.000         0.1</span></span>
<span id="cb80-34"><a href="#cb80-34"></a><span class="co"># setosa.25%             4.8       3.200        1.400         0.2</span></span>
<span id="cb80-35"><a href="#cb80-35"></a><span class="co"># setosa.50%             5.0       3.400        1.500         0.2</span></span>
<span id="cb80-36"><a href="#cb80-36"></a><span class="co"># setosa.75%             5.2       3.675        1.575         0.3</span></span>
<span id="cb80-37"><a href="#cb80-37"></a><span class="co"># setosa.100%            5.8       4.400        1.900         0.6</span></span>
<span id="cb80-38"><a href="#cb80-38"></a><span class="co"># versicolor.0%          4.9       2.000        3.000         1.0</span></span>
<span id="cb80-39"><a href="#cb80-39"></a></span>
<span id="cb80-40"><a href="#cb80-40"></a><span class="kw">BY</span>(miris, f, quantile, <span class="dt">expand.wide =</span> <span class="ot">TRUE</span>)[,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb80-41"><a href="#cb80-41"></a><span class="co">#            Sepal.Length.0% Sepal.Length.25% Sepal.Length.50% Sepal.Length.75% Sepal.Length.100%</span></span>
<span id="cb80-42"><a href="#cb80-42"></a><span class="co"># setosa                 4.3            4.800              5.0              5.2               5.8</span></span>
<span id="cb80-43"><a href="#cb80-43"></a><span class="co"># versicolor             4.9            5.600              5.9              6.3               7.0</span></span>
<span id="cb80-44"><a href="#cb80-44"></a><span class="co"># virginica              4.9            6.225              6.5              6.9               7.9</span></span>
<span id="cb80-45"><a href="#cb80-45"></a></span>
<span id="cb80-46"><a href="#cb80-46"></a><span class="kw">BY</span>(miris, f, quantile, <span class="dt">expand.wide =</span> <span class="ot">TRUE</span>, <span class="dt">return =</span> <span class="st">&quot;list&quot;</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] <span class="co"># list of matrices</span></span>
<span id="cb80-47"><a href="#cb80-47"></a><span class="co"># $Sepal.Length</span></span>
<span id="cb80-48"><a href="#cb80-48"></a><span class="co">#             0%   25% 50% 75% 100%</span></span>
<span id="cb80-49"><a href="#cb80-49"></a><span class="co"># setosa     4.3 4.800 5.0 5.2  5.8</span></span>
<span id="cb80-50"><a href="#cb80-50"></a><span class="co"># versicolor 4.9 5.600 5.9 6.3  7.0</span></span>
<span id="cb80-51"><a href="#cb80-51"></a><span class="co"># virginica  4.9 6.225 6.5 6.9  7.9</span></span>
<span id="cb80-52"><a href="#cb80-52"></a><span class="co"># </span></span>
<span id="cb80-53"><a href="#cb80-53"></a><span class="co"># $Sepal.Width</span></span>
<span id="cb80-54"><a href="#cb80-54"></a><span class="co">#             0%   25% 50%   75% 100%</span></span>
<span id="cb80-55"><a href="#cb80-55"></a><span class="co"># setosa     2.3 3.200 3.4 3.675  4.4</span></span>
<span id="cb80-56"><a href="#cb80-56"></a><span class="co"># versicolor 2.0 2.525 2.8 3.000  3.4</span></span>
<span id="cb80-57"><a href="#cb80-57"></a><span class="co"># virginica  2.2 2.800 3.0 3.175  3.8</span></span>
<span id="cb80-58"><a href="#cb80-58"></a></span>
<span id="cb80-59"><a href="#cb80-59"></a><span class="co">## data.frame method</span></span>
<span id="cb80-60"><a href="#cb80-60"></a><span class="kw">BY</span>(<span class="kw">num_vars</span>(iris), f, sum)             <span class="co"># Also returns a data.frame etc...</span></span>
<span id="cb80-61"><a href="#cb80-61"></a><span class="co">#            Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span>
<span id="cb80-62"><a href="#cb80-62"></a><span class="co"># setosa            250.3       171.4         73.1        12.3</span></span>
<span id="cb80-63"><a href="#cb80-63"></a><span class="co"># versicolor        296.8       138.5        213.0        66.3</span></span>
<span id="cb80-64"><a href="#cb80-64"></a><span class="co"># virginica         329.4       148.7        277.6       101.3</span></span>
<span id="cb80-65"><a href="#cb80-65"></a></span>
<span id="cb80-66"><a href="#cb80-66"></a><span class="co">## Conversions</span></span>
<span id="cb80-67"><a href="#cb80-67"></a><span class="kw">identical</span>(<span class="kw">BY</span>(<span class="kw">num_vars</span>(iris), f, sum), <span class="kw">BY</span>(miris, f, sum, <span class="dt">return =</span> <span class="st">&quot;data.frame&quot;</span>))</span>
<span id="cb80-68"><a href="#cb80-68"></a><span class="co"># [1] TRUE</span></span>
<span id="cb80-69"><a href="#cb80-69"></a><span class="kw">identical</span>(<span class="kw">BY</span>(miris, f, sum), <span class="kw">BY</span>(<span class="kw">num_vars</span>(iris), f, sum, <span class="dt">return =</span> <span class="st">&quot;matrix&quot;</span>))</span>
<span id="cb80-70"><a href="#cb80-70"></a><span class="co"># [1] TRUE</span></span></code></pre></div>
</div>
<div id="fast-replacing-and-sweeping-out-statistics" class="section level3">
<h3>6.3 Fast Replacing and Sweeping-out Statistics</h3>
<p><code>TRA</code> is an S3 generic that efficiently transforms data by either (column-wise) replacing data values with supplied statistics or sweeping the statistics out of the data. The 10 operations supported by <code>TRA</code> are:</p>
<ul>
<li><p>1 - “replace_fill” : replace and overwrite missing values (same as dplyr::mutate)</p></li>
<li><p>2 - “replace” : replace but preserve missing values</p></li>
<li><p>3 - “-” : subtract (center)</p></li>
<li><p>4 - “-+” : subtract group-statistics but add average of group statistics</p></li>
<li><p>5 - “/” : divide (scale)</p></li>
<li><p>6 - “%” : compute percentages (divide and multiply by 100)</p></li>
<li><p>7 - “+” : add</p></li>
<li><p>8 - &quot;*&quot; : multiply</p></li>
<li><p>9 - “%%” : modulus</p></li>
<li><p>10 - “-%%” : subtract modulus</p></li>
</ul>
<p><code>TRA</code> is also incorporated as an argument to all <em>Fast Statistical Functions</em>. Therefore it is only really necessary and advisable to use the <code>TRA</code> function if both aggregate statistics and transformed data are required, or to sweep out statistics otherwise obtained (e.g. regression or correlation coefficients etc.). The code below computes the column means of the iris-matrix obtained above, and uses them to demean that matrix.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a><span class="co"># Note: All examples below generalize to vectors or data frames</span></span>
<span id="cb81-2"><a href="#cb81-2"></a>stats &lt;-<span class="st"> </span><span class="kw">fmean</span>(miris)            <span class="co"># Saving stats</span></span>
<span id="cb81-3"><a href="#cb81-3"></a><span class="kw">head</span>(<span class="kw">TRA</span>(miris, stats, <span class="st">&quot;-&quot;</span>), <span class="dv">3</span>)  <span class="co"># Centering. Same as sweep(miris, 2, stats, &quot;-&quot;)</span></span>
<span id="cb81-4"><a href="#cb81-4"></a><span class="co">#      Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span>
<span id="cb81-5"><a href="#cb81-5"></a><span class="co"># [1,]   -0.7433333  0.44266667       -2.358  -0.9993333</span></span>
<span id="cb81-6"><a href="#cb81-6"></a><span class="co"># [2,]   -0.9433333 -0.05733333       -2.358  -0.9993333</span></span>
<span id="cb81-7"><a href="#cb81-7"></a><span class="co"># [3,]   -1.1433333  0.14266667       -2.458  -0.9993333</span></span></code></pre></div>
<p>The code below shows 3 identical ways to center data in the <em>collapse</em> package. For the very common centering and averaging tasks, <em>collapse</em> supplies 2 special functions <code>fwithin</code> and <code>fbetween</code> (discussed in section 6.5) which are slightly faster and more memory efficient than <code>fmean(..., TRA = &quot;-&quot;)</code> and <code>fmean(..., TRA = &quot;replace&quot;)</code>.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a><span class="co"># 3 ways of centering data</span></span>
<span id="cb82-2"><a href="#cb82-2"></a><span class="kw">all_identical</span>(<span class="kw">TRA</span>(miris, <span class="kw">fmean</span>(miris), <span class="st">&quot;-&quot;</span>),</span>
<span id="cb82-3"><a href="#cb82-3"></a>              <span class="kw">fmean</span>(miris, <span class="dt">TRA =</span> <span class="st">&quot;-&quot;</span>),   <span class="co"># better for any operation if the stats are not needed</span></span>
<span id="cb82-4"><a href="#cb82-4"></a>              <span class="kw">fwithin</span>(miris))            <span class="co"># fastest, fwithin is discussed in section 6.5</span></span>
<span id="cb82-5"><a href="#cb82-5"></a><span class="co"># [1] TRUE</span></span>
<span id="cb82-6"><a href="#cb82-6"></a></span>
<span id="cb82-7"><a href="#cb82-7"></a><span class="co"># Simple replacing [same as fmean(miris, TRA = &quot;replace&quot;) or fbetween(miris)]</span></span>
<span id="cb82-8"><a href="#cb82-8"></a><span class="kw">head</span>(<span class="kw">TRA</span>(miris, <span class="kw">fmean</span>(miris), <span class="st">&quot;replace&quot;</span>), <span class="dv">3</span>)</span>
<span id="cb82-9"><a href="#cb82-9"></a><span class="co">#      Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span>
<span id="cb82-10"><a href="#cb82-10"></a><span class="co"># [1,]     5.843333    3.057333        3.758    1.199333</span></span>
<span id="cb82-11"><a href="#cb82-11"></a><span class="co"># [2,]     5.843333    3.057333        3.758    1.199333</span></span>
<span id="cb82-12"><a href="#cb82-12"></a><span class="co"># [3,]     5.843333    3.057333        3.758    1.199333</span></span>
<span id="cb82-13"><a href="#cb82-13"></a></span>
<span id="cb82-14"><a href="#cb82-14"></a><span class="co"># Simple scaling [same as fsd(miris, TRA = &quot;/&quot;)]</span></span>
<span id="cb82-15"><a href="#cb82-15"></a><span class="kw">head</span>(<span class="kw">TRA</span>(miris, <span class="kw">fsd</span>(miris), <span class="st">&quot;/&quot;</span>), <span class="dv">3</span>)</span>
<span id="cb82-16"><a href="#cb82-16"></a><span class="co">#      Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span>
<span id="cb82-17"><a href="#cb82-17"></a><span class="co"># [1,]     6.158928    8.029986    0.7930671   0.2623854</span></span>
<span id="cb82-18"><a href="#cb82-18"></a><span class="co"># [2,]     5.917402    6.882845    0.7930671   0.2623854</span></span>
<span id="cb82-19"><a href="#cb82-19"></a><span class="co"># [3,]     5.675875    7.341701    0.7364195   0.2623854</span></span></code></pre></div>
<p>All of the above is functionality also offered by <code>base::sweep</code>, but <code>TRA</code> is significantly faster. The big advantage of <code>TRA</code> is that it also supports grouped operations:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a><span class="co"># Grouped centering [same as fmean(miris, f, TRA = &quot;-&quot;) or fwithin(m, f)]</span></span>
<span id="cb83-2"><a href="#cb83-2"></a><span class="kw">head</span>(<span class="kw">TRA</span>(miris, <span class="kw">fmean</span>(miris, f), <span class="st">&quot;-&quot;</span>, f), <span class="dv">3</span>)</span>
<span id="cb83-3"><a href="#cb83-3"></a><span class="co">#      Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span>
<span id="cb83-4"><a href="#cb83-4"></a><span class="co"># [1,]        0.094       0.072       -0.062      -0.046</span></span>
<span id="cb83-5"><a href="#cb83-5"></a><span class="co"># [2,]       -0.106      -0.428       -0.062      -0.046</span></span>
<span id="cb83-6"><a href="#cb83-6"></a><span class="co"># [3,]       -0.306      -0.228       -0.162      -0.046</span></span>
<span id="cb83-7"><a href="#cb83-7"></a></span>
<span id="cb83-8"><a href="#cb83-8"></a><span class="co"># Grouped replacing [same as fmean(m, f, TRA = &quot;replace&quot;) or fbetween(m, f)]</span></span>
<span id="cb83-9"><a href="#cb83-9"></a><span class="kw">head</span>(<span class="kw">TRA</span>(miris, <span class="kw">fmean</span>(miris, f), <span class="st">&quot;replace&quot;</span>, f), <span class="dv">3</span>)</span>
<span id="cb83-10"><a href="#cb83-10"></a><span class="co">#      Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span>
<span id="cb83-11"><a href="#cb83-11"></a><span class="co"># [1,]        5.006       3.428        1.462       0.246</span></span>
<span id="cb83-12"><a href="#cb83-12"></a><span class="co"># [2,]        5.006       3.428        1.462       0.246</span></span>
<span id="cb83-13"><a href="#cb83-13"></a><span class="co"># [3,]        5.006       3.428        1.462       0.246</span></span>
<span id="cb83-14"><a href="#cb83-14"></a></span>
<span id="cb83-15"><a href="#cb83-15"></a><span class="co"># Groupwise percentages [same as fsum(m, f, TRA = &quot;%&quot;)]</span></span>
<span id="cb83-16"><a href="#cb83-16"></a><span class="kw">head</span>(<span class="kw">TRA</span>(miris, <span class="kw">fsum</span>(miris, f), <span class="st">&quot;%&quot;</span>, f), <span class="dv">3</span>)</span>
<span id="cb83-17"><a href="#cb83-17"></a><span class="co">#      Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span>
<span id="cb83-18"><a href="#cb83-18"></a><span class="co"># [1,]     2.037555    2.042007     1.915185    1.626016</span></span>
<span id="cb83-19"><a href="#cb83-19"></a><span class="co"># [2,]     1.957651    1.750292     1.915185    1.626016</span></span>
<span id="cb83-20"><a href="#cb83-20"></a><span class="co"># [3,]     1.877747    1.866978     1.778386    1.626016</span></span></code></pre></div>
<p>A somewhat special operation performed by <code>TRA</code> is the grouped centering on the overall statistic (which for the mean is also performed more efficiently by <code>fwithin</code>):</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a><span class="co"># Grouped centering on the overall mean [same as fmean(m, f, TRA = &quot;-+&quot;) or fwithin(m, f, mean = &quot;overall.mean&quot;)]</span></span>
<span id="cb84-2"><a href="#cb84-2"></a><span class="kw">head</span>(<span class="kw">TRA</span>(miris, <span class="kw">fmean</span>(miris, f), <span class="st">&quot;-+&quot;</span>, f), <span class="dv">3</span>)</span>
<span id="cb84-3"><a href="#cb84-3"></a><span class="co">#      Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span>
<span id="cb84-4"><a href="#cb84-4"></a><span class="co"># [1,]     5.937333    3.129333        3.696    1.153333</span></span>
<span id="cb84-5"><a href="#cb84-5"></a><span class="co"># [2,]     5.737333    2.629333        3.696    1.153333</span></span>
<span id="cb84-6"><a href="#cb84-6"></a><span class="co"># [3,]     5.537333    2.829333        3.596    1.153333</span></span>
<span id="cb84-7"><a href="#cb84-7"></a><span class="kw">head</span>(<span class="kw">TRA</span>(<span class="kw">TRA</span>(miris, <span class="kw">fmean</span>(miris, f), <span class="st">&quot;-&quot;</span>, f), <span class="kw">fmean</span>(miris), <span class="st">&quot;+&quot;</span>), <span class="dv">3</span>) <span class="co"># Same thing done manually!</span></span>
<span id="cb84-8"><a href="#cb84-8"></a><span class="co">#      Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span>
<span id="cb84-9"><a href="#cb84-9"></a><span class="co"># [1,]     5.937333    3.129333        3.696    1.153333</span></span>
<span id="cb84-10"><a href="#cb84-10"></a><span class="co"># [2,]     5.737333    2.629333        3.696    1.153333</span></span>
<span id="cb84-11"><a href="#cb84-11"></a><span class="co"># [3,]     5.537333    2.829333        3.596    1.153333</span></span>
<span id="cb84-12"><a href="#cb84-12"></a></span>
<span id="cb84-13"><a href="#cb84-13"></a><span class="co"># This group-centers data on the overall median!</span></span>
<span id="cb84-14"><a href="#cb84-14"></a><span class="kw">head</span>(<span class="kw">fmedian</span>(miris, f, <span class="dt">TRA =</span> <span class="st">&quot;-+&quot;</span>), <span class="dv">3</span>)</span>
<span id="cb84-15"><a href="#cb84-15"></a><span class="co">#      Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span>
<span id="cb84-16"><a href="#cb84-16"></a><span class="co"># [1,]          5.9    3.166667          3.7    1.166667</span></span>
<span id="cb84-17"><a href="#cb84-17"></a><span class="co"># [2,]          5.7    2.666667          3.7    1.166667</span></span>
<span id="cb84-18"><a href="#cb84-18"></a><span class="co"># [3,]          5.5    2.866667          3.6    1.166667</span></span></code></pre></div>
<p>This is the within transformation also computed by <code>qsu</code> discussed in section 1. It’s utility in the case of grouped centering is demonstrated visually in section 6.5.</p>
</div>
<div id="fast-standardizing" class="section level3">
<h3>6.4 Fast Standardizing</h3>
<p>The function <code>fscale</code> can be used to efficiently standardize (i.e. scale and center) data using a numerically stable online algorithm. It’s structure is the same as the <em>Fast Statistical Functions</em>. The standardization-operator <code>STD</code> also exists as a wrapper around <code>fscale</code>. The difference is that by default <code>STD</code> adds a prefix to standardized variables and also provides an enhanced method for data frames (more about operators in the next section).</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a><span class="co"># fscale doesn&#39;t rename columns</span></span>
<span id="cb85-2"><a href="#cb85-2"></a><span class="kw">head</span>(<span class="kw">fscale</span>(mtcars),<span class="dv">2</span>)</span>
<span id="cb85-3"><a href="#cb85-3"></a><span class="co">#                     mpg        cyl       disp         hp      drat         wt       qsec         vs</span></span>
<span id="cb85-4"><a href="#cb85-4"></a><span class="co"># Mazda RX4     0.1508848 -0.1049878 -0.5706198 -0.5350928 0.5675137 -0.6103996 -0.7771651 -0.8680278</span></span>
<span id="cb85-5"><a href="#cb85-5"></a><span class="co"># Mazda RX4 Wag 0.1508848 -0.1049878 -0.5706198 -0.5350928 0.5675137 -0.3497853 -0.4637808 -0.8680278</span></span>
<span id="cb85-6"><a href="#cb85-6"></a><span class="co">#                     am      gear      carb</span></span>
<span id="cb85-7"><a href="#cb85-7"></a><span class="co"># Mazda RX4     1.189901 0.4235542 0.7352031</span></span>
<span id="cb85-8"><a href="#cb85-8"></a><span class="co"># Mazda RX4 Wag 1.189901 0.4235542 0.7352031</span></span>
<span id="cb85-9"><a href="#cb85-9"></a></span>
<span id="cb85-10"><a href="#cb85-10"></a><span class="co"># By default adds a prefix</span></span>
<span id="cb85-11"><a href="#cb85-11"></a><span class="kw">head</span>(<span class="kw">STD</span>(mtcars),<span class="dv">2</span>)</span>
<span id="cb85-12"><a href="#cb85-12"></a><span class="co">#                 STD.mpg    STD.cyl   STD.disp     STD.hp  STD.drat     STD.wt   STD.qsec     STD.vs</span></span>
<span id="cb85-13"><a href="#cb85-13"></a><span class="co"># Mazda RX4     0.1508848 -0.1049878 -0.5706198 -0.5350928 0.5675137 -0.6103996 -0.7771651 -0.8680278</span></span>
<span id="cb85-14"><a href="#cb85-14"></a><span class="co"># Mazda RX4 Wag 0.1508848 -0.1049878 -0.5706198 -0.5350928 0.5675137 -0.3497853 -0.4637808 -0.8680278</span></span>
<span id="cb85-15"><a href="#cb85-15"></a><span class="co">#                 STD.am  STD.gear  STD.carb</span></span>
<span id="cb85-16"><a href="#cb85-16"></a><span class="co"># Mazda RX4     1.189901 0.4235542 0.7352031</span></span>
<span id="cb85-17"><a href="#cb85-17"></a><span class="co"># Mazda RX4 Wag 1.189901 0.4235542 0.7352031</span></span>
<span id="cb85-18"><a href="#cb85-18"></a></span>
<span id="cb85-19"><a href="#cb85-19"></a><span class="co"># See that is works</span></span>
<span id="cb85-20"><a href="#cb85-20"></a><span class="kw">qsu</span>(<span class="kw">STD</span>(mtcars))</span>
<span id="cb85-21"><a href="#cb85-21"></a><span class="co">#            N  Mean  SD      Min     Max</span></span>
<span id="cb85-22"><a href="#cb85-22"></a><span class="co"># STD.mpg   32    -0   1  -1.6079  2.2913</span></span>
<span id="cb85-23"><a href="#cb85-23"></a><span class="co"># STD.cyl   32     0   1  -1.2249  1.0149</span></span>
<span id="cb85-24"><a href="#cb85-24"></a><span class="co"># STD.disp  32    -0   1  -1.2879  1.9468</span></span>
<span id="cb85-25"><a href="#cb85-25"></a><span class="co"># STD.hp    32     0   1   -1.381  2.7466</span></span>
<span id="cb85-26"><a href="#cb85-26"></a><span class="co"># STD.drat  32    -0   1  -1.5646  2.4939</span></span>
<span id="cb85-27"><a href="#cb85-27"></a><span class="co"># STD.wt    32    -0   1  -1.7418  2.2553</span></span>
<span id="cb85-28"><a href="#cb85-28"></a><span class="co"># STD.qsec  32     0   1   -1.874  2.8268</span></span>
<span id="cb85-29"><a href="#cb85-29"></a><span class="co"># STD.vs    32     0   1   -0.868   1.116</span></span>
<span id="cb85-30"><a href="#cb85-30"></a><span class="co"># STD.am    32    -0   1  -0.8141  1.1899</span></span>
<span id="cb85-31"><a href="#cb85-31"></a><span class="co"># STD.gear  32     0   1  -0.9318  1.7789</span></span>
<span id="cb85-32"><a href="#cb85-32"></a><span class="co"># STD.carb  32    -0   1  -1.1222  3.2117</span></span>
<span id="cb85-33"><a href="#cb85-33"></a></span>
<span id="cb85-34"><a href="#cb85-34"></a><span class="co"># We can also scale and center to a different mean and standard deviation:</span></span>
<span id="cb85-35"><a href="#cb85-35"></a><span class="kw">t</span>(<span class="kw">qsu</span>(<span class="kw">fscale</span>(mtcars, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="dv">3</span>))[,<span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>,<span class="st">&quot;SD&quot;</span>)])</span>
<span id="cb85-36"><a href="#cb85-36"></a><span class="co">#       mpg  cyl  disp  hp  drat  wt  qsec  vs  am  gear  carb</span></span>
<span id="cb85-37"><a href="#cb85-37"></a><span class="co"># Mean    5    5     5   5     5   5     5   5   5     5     5</span></span>
<span id="cb85-38"><a href="#cb85-38"></a><span class="co"># SD      3    3     3   3     3   3     3   3   3     3     3</span></span>
<span id="cb85-39"><a href="#cb85-39"></a></span>
<span id="cb85-40"><a href="#cb85-40"></a><span class="co"># Or not center at all. In that case scaling is mean-preserving, in contrast to fsd(mtcars, TRA = &quot;/&quot;)</span></span>
<span id="cb85-41"><a href="#cb85-41"></a><span class="kw">t</span>(<span class="kw">qsu</span>(<span class="kw">fscale</span>(mtcars, <span class="dt">mean =</span> <span class="ot">FALSE</span>, <span class="dt">sd =</span> <span class="dv">3</span>))[,<span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>,<span class="st">&quot;SD&quot;</span>)])</span>
<span id="cb85-42"><a href="#cb85-42"></a><span class="co">#           mpg     cyl      disp        hp    drat      wt     qsec      vs      am    gear    carb</span></span>
<span id="cb85-43"><a href="#cb85-43"></a><span class="co"># Mean  20.0906  6.1875  230.7219  146.6875  3.5966  3.2172  17.8487  0.4375  0.4062  3.6875  2.8125</span></span>
<span id="cb85-44"><a href="#cb85-44"></a><span class="co"># SD          3       3         3         3       3       3        3       3       3       3       3</span></span></code></pre></div>
<p>Scaling with <code>fscale / STD</code> can also be done groupwise and / or weighted. For example the Groningen Growth and Development Center 10-Sector Database provides annual series of value added in local currency and persons employed for 10 broad sectors in several African, Asian, and Latin American countries.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a><span class="kw">head</span>(GGDC10S)</span>
<span id="cb86-2"><a href="#cb86-2"></a><span class="co">#   Country Regioncode             Region Variable Year      AGR      MIN       MAN        PU</span></span>
<span id="cb86-3"><a href="#cb86-3"></a><span class="co"># 1     BWA        SSA Sub-saharan Africa       VA 1960       NA       NA        NA        NA</span></span>
<span id="cb86-4"><a href="#cb86-4"></a><span class="co"># 2     BWA        SSA Sub-saharan Africa       VA 1961       NA       NA        NA        NA</span></span>
<span id="cb86-5"><a href="#cb86-5"></a><span class="co"># 3     BWA        SSA Sub-saharan Africa       VA 1962       NA       NA        NA        NA</span></span>
<span id="cb86-6"><a href="#cb86-6"></a><span class="co"># 4     BWA        SSA Sub-saharan Africa       VA 1963       NA       NA        NA        NA</span></span>
<span id="cb86-7"><a href="#cb86-7"></a><span class="co"># 5     BWA        SSA Sub-saharan Africa       VA 1964 16.30154 3.494075 0.7365696 0.1043936</span></span>
<span id="cb86-8"><a href="#cb86-8"></a><span class="co"># 6     BWA        SSA Sub-saharan Africa       VA 1965 15.72700 2.495768 1.0181992 0.1350976</span></span>
<span id="cb86-9"><a href="#cb86-9"></a><span class="co">#         CON      WRT      TRA     FIRE      GOV      OTH      SUM</span></span>
<span id="cb86-10"><a href="#cb86-10"></a><span class="co"># 1        NA       NA       NA       NA       NA       NA       NA</span></span>
<span id="cb86-11"><a href="#cb86-11"></a><span class="co"># 2        NA       NA       NA       NA       NA       NA       NA</span></span>
<span id="cb86-12"><a href="#cb86-12"></a><span class="co"># 3        NA       NA       NA       NA       NA       NA       NA</span></span>
<span id="cb86-13"><a href="#cb86-13"></a><span class="co"># 4        NA       NA       NA       NA       NA       NA       NA</span></span>
<span id="cb86-14"><a href="#cb86-14"></a><span class="co"># 5 0.6600454 6.243732 1.658928 1.119194 4.822485 2.341328 37.48229</span></span>
<span id="cb86-15"><a href="#cb86-15"></a><span class="co"># 6 1.3462312 7.064825 1.939007 1.246789 5.695848 2.678338 39.34710</span></span></code></pre></div>
<p>If we wanted to correlate this data across countries and sectors, it needs to be standardized:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a><span class="co"># Standardizing Sectors by Variable and Country</span></span>
<span id="cb87-2"><a href="#cb87-2"></a>STD_GGDC10S &lt;-<span class="st"> </span><span class="kw">STD</span>(GGDC10S, <span class="op">~</span><span class="st"> </span>Variable <span class="op">+</span><span class="st"> </span>Country, <span class="dt">cols =</span> <span class="dv">6</span><span class="op">:</span><span class="dv">16</span>)</span>
<span id="cb87-3"><a href="#cb87-3"></a><span class="kw">head</span>(STD_GGDC10S)</span>
<span id="cb87-4"><a href="#cb87-4"></a><span class="co">#   Variable Country    STD.AGR    STD.MIN    STD.MAN     STD.PU    STD.CON    STD.WRT    STD.TRA</span></span>
<span id="cb87-5"><a href="#cb87-5"></a><span class="co"># 1       VA     BWA         NA         NA         NA         NA         NA         NA         NA</span></span>
<span id="cb87-6"><a href="#cb87-6"></a><span class="co"># 2       VA     BWA         NA         NA         NA         NA         NA         NA         NA</span></span>
<span id="cb87-7"><a href="#cb87-7"></a><span class="co"># 3       VA     BWA         NA         NA         NA         NA         NA         NA         NA</span></span>
<span id="cb87-8"><a href="#cb87-8"></a><span class="co"># 4       VA     BWA         NA         NA         NA         NA         NA         NA         NA</span></span>
<span id="cb87-9"><a href="#cb87-9"></a><span class="co"># 5       VA     BWA -0.7382911 -0.7165772 -0.6682536 -0.8051315 -0.6922839 -0.6032762 -0.5889923</span></span>
<span id="cb87-10"><a href="#cb87-10"></a><span class="co"># 6       VA     BWA -0.7392424 -0.7167359 -0.6680535 -0.8050172 -0.6917529 -0.6030211 -0.5887320</span></span>
<span id="cb87-11"><a href="#cb87-11"></a><span class="co">#     STD.FIRE    STD.GOV    STD.OTH    STD.SUM</span></span>
<span id="cb87-12"><a href="#cb87-12"></a><span class="co"># 1         NA         NA         NA         NA</span></span>
<span id="cb87-13"><a href="#cb87-13"></a><span class="co"># 2         NA         NA         NA         NA</span></span>
<span id="cb87-14"><a href="#cb87-14"></a><span class="co"># 3         NA         NA         NA         NA</span></span>
<span id="cb87-15"><a href="#cb87-15"></a><span class="co"># 4         NA         NA         NA         NA</span></span>
<span id="cb87-16"><a href="#cb87-16"></a><span class="co"># 5 -0.6349956 -0.6561054 -0.5959744 -0.6758663</span></span>
<span id="cb87-17"><a href="#cb87-17"></a><span class="co"># 6 -0.6349359 -0.6558634 -0.5957137 -0.6757768</span></span>
<span id="cb87-18"><a href="#cb87-18"></a></span>
<span id="cb87-19"><a href="#cb87-19"></a><span class="co"># Correlating Standardized Value-Added across countries</span></span>
<span id="cb87-20"><a href="#cb87-20"></a><span class="kw">pwcor</span>(<span class="kw">fsubset</span>(STD_GGDC10S, Variable <span class="op">==</span><span class="st"> &quot;VA&quot;</span>, STD.AGR<span class="op">:</span>STD.SUM))</span>
<span id="cb87-21"><a href="#cb87-21"></a><span class="co">#          STD.AGR STD.MIN STD.MAN STD.PU STD.CON STD.WRT STD.TRA STD.FIRE STD.GOV STD.OTH STD.SUM</span></span>
<span id="cb87-22"><a href="#cb87-22"></a><span class="co"># STD.AGR       1      .88     .93    .88     .89     .90     .90      .86     .93     .88     .90</span></span>
<span id="cb87-23"><a href="#cb87-23"></a><span class="co"># STD.MIN      .88      1      .86    .84     .85     .85     .84      .83     .88     .84     .86</span></span>
<span id="cb87-24"><a href="#cb87-24"></a><span class="co"># STD.MAN      .93     .86      1     .95     .96     .97     .98      .95     .98     .97     .98</span></span>
<span id="cb87-25"><a href="#cb87-25"></a><span class="co"># STD.PU       .88     .84     .95     1      .95     .96     .96      .95     .96     .96     .97</span></span>
<span id="cb87-26"><a href="#cb87-26"></a><span class="co"># STD.CON      .89     .85     .96    .95      1      .98     .98      .97     .98     .97     .98</span></span>
<span id="cb87-27"><a href="#cb87-27"></a><span class="co"># STD.WRT      .90     .85     .97    .96     .98      1      .99      .98     .99     .99    1.00</span></span>
<span id="cb87-28"><a href="#cb87-28"></a><span class="co"># STD.TRA      .90     .84     .98    .96     .98     .99      1       .98     .99     .99     .99</span></span>
<span id="cb87-29"><a href="#cb87-29"></a><span class="co"># STD.FIRE     .86     .83     .95    .95     .97     .98     .98       1      .98     .98     .98</span></span>
<span id="cb87-30"><a href="#cb87-30"></a><span class="co"># STD.GOV      .93     .88     .98    .96     .98     .99     .99      .98      1      .99    1.00</span></span>
<span id="cb87-31"><a href="#cb87-31"></a><span class="co"># STD.OTH      .88     .84     .97    .96     .97     .99     .99      .98     .99      1      .99</span></span>
<span id="cb87-32"><a href="#cb87-32"></a><span class="co"># STD.SUM      .90     .86     .98    .97     .98    1.00     .99      .98    1.00     .99      1</span></span></code></pre></div>
</div>
<div id="fast-centering-and-averaging" class="section level3">
<h3>6.5 Fast Centering and Averaging</h3>
<p>As a slightly faster alternative to <code>fmean(x, g, w, TRA = &quot;-&quot;/&quot;-+&quot;)</code> or <code>fmean(x, g, w, TRA = &quot;replace&quot;/&quot;replace_fill&quot;)</code>, <code>fwithin</code> and <code>fbetween</code> can be used to perform common (grouped, weighted) centering and averaging tasks (also known as <em>between</em>- and <em>within</em>- transformations in the language of panel data econometrics). <code>fbetween</code> / <code>fwithin</code> are faster than <code>fmean(..., TRA = ...)</code> because they don’t materialize the full set of computed averages. The operators <code>W</code> and <code>B</code> also exist.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a><span class="co">## Simple centering and averaging</span></span>
<span id="cb88-2"><a href="#cb88-2"></a><span class="kw">head</span>(<span class="kw">fbetween</span>(mtcars<span class="op">$</span>mpg))</span>
<span id="cb88-3"><a href="#cb88-3"></a><span class="co"># [1] 20.09062 20.09062 20.09062 20.09062 20.09062 20.09062</span></span>
<span id="cb88-4"><a href="#cb88-4"></a></span>
<span id="cb88-5"><a href="#cb88-5"></a><span class="kw">head</span>(<span class="kw">fwithin</span>(mtcars<span class="op">$</span>mpg))</span>
<span id="cb88-6"><a href="#cb88-6"></a><span class="co"># [1]  0.909375  0.909375  2.709375  1.309375 -1.390625 -1.990625</span></span>
<span id="cb88-7"><a href="#cb88-7"></a></span>
<span id="cb88-8"><a href="#cb88-8"></a><span class="kw">all.equal</span>(<span class="kw">fbetween</span>(mtcars) <span class="op">+</span><span class="st"> </span><span class="kw">fwithin</span>(mtcars), mtcars)</span>
<span id="cb88-9"><a href="#cb88-9"></a><span class="co"># [1] TRUE</span></span>
<span id="cb88-10"><a href="#cb88-10"></a></span>
<span id="cb88-11"><a href="#cb88-11"></a><span class="co">## Groupwise centering and averaging</span></span>
<span id="cb88-12"><a href="#cb88-12"></a><span class="kw">head</span>(<span class="kw">fbetween</span>(mtcars<span class="op">$</span>mpg, mtcars<span class="op">$</span>cyl))</span>
<span id="cb88-13"><a href="#cb88-13"></a><span class="co"># [1] 19.74286 19.74286 26.66364 19.74286 15.10000 19.74286</span></span>
<span id="cb88-14"><a href="#cb88-14"></a></span>
<span id="cb88-15"><a href="#cb88-15"></a><span class="kw">head</span>(<span class="kw">fwithin</span>(mtcars<span class="op">$</span>mpg, mtcars<span class="op">$</span>cyl))</span>
<span id="cb88-16"><a href="#cb88-16"></a><span class="co"># [1]  1.257143  1.257143 -3.863636  1.657143  3.600000 -1.642857</span></span>
<span id="cb88-17"><a href="#cb88-17"></a></span>
<span id="cb88-18"><a href="#cb88-18"></a><span class="kw">all.equal</span>(<span class="kw">fbetween</span>(mtcars, mtcars<span class="op">$</span>cyl) <span class="op">+</span><span class="st"> </span><span class="kw">fwithin</span>(mtcars, mtcars<span class="op">$</span>cyl), mtcars)</span>
<span id="cb88-19"><a href="#cb88-19"></a><span class="co"># [1] TRUE</span></span></code></pre></div>
<p>To demonstrate more clearly the utility of the operators which exists for all fast transformation and time series functions, the code below implements the task of demeaning 4 series by country and saving the country-id using the within-operator <code>W</code> as opposed to <code>fwithin</code> which requires all input to be passed externally like the <em>Fast Statistical Functions</em>.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a><span class="kw">head</span>(<span class="kw">W</span>(wlddev, <span class="op">~</span><span class="st"> </span>iso3c, <span class="dt">cols =</span> <span class="dv">9</span><span class="op">:</span><span class="dv">12</span>))        <span class="co"># Center the 4 series in this dataset by country</span></span>
<span id="cb89-2"><a href="#cb89-2"></a><span class="co">#   iso3c W.PCGDP  W.LIFEEX W.GINI       W.ODA</span></span>
<span id="cb89-3"><a href="#cb89-3"></a><span class="co"># 1   AFG      NA -15.59016     NA -1236633448</span></span>
<span id="cb89-4"><a href="#cb89-4"></a><span class="co"># 2   AFG      NA -15.14016     NA -1117723448</span></span>
<span id="cb89-5"><a href="#cb89-5"></a><span class="co"># 3   AFG      NA -14.69716     NA -1236193448</span></span>
<span id="cb89-6"><a href="#cb89-6"></a><span class="co"># 4   AFG      NA -14.25816     NA -1114623448</span></span>
<span id="cb89-7"><a href="#cb89-7"></a><span class="co"># 5   AFG      NA -13.82216     NA -1048593448</span></span>
<span id="cb89-8"><a href="#cb89-8"></a><span class="co"># 6   AFG      NA -13.38716     NA  -980823448</span></span>
<span id="cb89-9"><a href="#cb89-9"></a><span class="kw">head</span>(<span class="kw">add_vars</span>(<span class="kw">get_vars</span>(wlddev, <span class="st">&quot;iso3c&quot;</span>),     <span class="co"># Same thing done manually using fwithin...</span></span>
<span id="cb89-10"><a href="#cb89-10"></a>     <span class="kw">add_stub</span>(<span class="kw">fwithin</span>(<span class="kw">get_vars</span>(wlddev, <span class="dv">9</span><span class="op">:</span><span class="dv">12</span>), wlddev<span class="op">$</span>iso3c), <span class="st">&quot;W.&quot;</span>)))</span>
<span id="cb89-11"><a href="#cb89-11"></a><span class="co">#   iso3c W.PCGDP  W.LIFEEX W.GINI       W.ODA</span></span>
<span id="cb89-12"><a href="#cb89-12"></a><span class="co"># 1   AFG      NA -15.59016     NA -1236633448</span></span>
<span id="cb89-13"><a href="#cb89-13"></a><span class="co"># 2   AFG      NA -15.14016     NA -1117723448</span></span>
<span id="cb89-14"><a href="#cb89-14"></a><span class="co"># 3   AFG      NA -14.69716     NA -1236193448</span></span>
<span id="cb89-15"><a href="#cb89-15"></a><span class="co"># 4   AFG      NA -14.25816     NA -1114623448</span></span>
<span id="cb89-16"><a href="#cb89-16"></a><span class="co"># 5   AFG      NA -13.82216     NA -1048593448</span></span>
<span id="cb89-17"><a href="#cb89-17"></a><span class="co"># 6   AFG      NA -13.38716     NA  -980823448</span></span></code></pre></div>
<p>It is also possible to drop the id’s in <code>W</code> using the argument <code>keep.by = FALSE</code>. <code>fbetween / B</code> and <code>fwithin / W</code> each have one additional computational option:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a><span class="co"># This replaces missing values with the group-mean: Same as fmean(x, g, TRA = &quot;replace_fill&quot;)</span></span>
<span id="cb90-2"><a href="#cb90-2"></a><span class="kw">head</span>(<span class="kw">B</span>(wlddev, <span class="op">~</span><span class="st"> </span>iso3c, <span class="dt">cols =</span> <span class="dv">9</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">fill =</span> <span class="ot">TRUE</span>))</span>
<span id="cb90-3"><a href="#cb90-3"></a><span class="co">#   iso3c  B.PCGDP B.LIFEEX B.GINI      B.ODA</span></span>
<span id="cb90-4"><a href="#cb90-4"></a><span class="co"># 1   AFG 482.1631 47.88216     NA 1351073448</span></span>
<span id="cb90-5"><a href="#cb90-5"></a><span class="co"># 2   AFG 482.1631 47.88216     NA 1351073448</span></span>
<span id="cb90-6"><a href="#cb90-6"></a><span class="co"># 3   AFG 482.1631 47.88216     NA 1351073448</span></span>
<span id="cb90-7"><a href="#cb90-7"></a><span class="co"># 4   AFG 482.1631 47.88216     NA 1351073448</span></span>
<span id="cb90-8"><a href="#cb90-8"></a><span class="co"># 5   AFG 482.1631 47.88216     NA 1351073448</span></span>
<span id="cb90-9"><a href="#cb90-9"></a><span class="co"># 6   AFG 482.1631 47.88216     NA 1351073448</span></span>
<span id="cb90-10"><a href="#cb90-10"></a></span>
<span id="cb90-11"><a href="#cb90-11"></a><span class="co"># This adds back the overall mean after subtracting out group means: Same as fmean(x, g, TRA = &quot;-+&quot;)</span></span>
<span id="cb90-12"><a href="#cb90-12"></a><span class="kw">head</span>(<span class="kw">W</span>(wlddev, <span class="op">~</span><span class="st"> </span>iso3c, <span class="dt">cols =</span> <span class="dv">9</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">mean =</span> <span class="st">&quot;overall.mean&quot;</span>))</span>
<span id="cb90-13"><a href="#cb90-13"></a><span class="co">#   iso3c W.PCGDP W.LIFEEX W.GINI      W.ODA</span></span>
<span id="cb90-14"><a href="#cb90-14"></a><span class="co"># 1   AFG      NA 48.25093     NA -807886980</span></span>
<span id="cb90-15"><a href="#cb90-15"></a><span class="co"># 2   AFG      NA 48.70093     NA -688976980</span></span>
<span id="cb90-16"><a href="#cb90-16"></a><span class="co"># 3   AFG      NA 49.14393     NA -807446980</span></span>
<span id="cb90-17"><a href="#cb90-17"></a><span class="co"># 4   AFG      NA 49.58293     NA -685876980</span></span>
<span id="cb90-18"><a href="#cb90-18"></a><span class="co"># 5   AFG      NA 50.01893     NA -619846980</span></span>
<span id="cb90-19"><a href="#cb90-19"></a><span class="co"># 6   AFG      NA 50.45393     NA -552076980</span></span>
<span id="cb90-20"><a href="#cb90-20"></a><span class="co"># Note: This is not just slightly faster than fmean(x, g, TRA = &quot;-+&quot;), but if weights are used, fmean(x, g, w, &quot;-+&quot;)</span></span>
<span id="cb90-21"><a href="#cb90-21"></a><span class="co"># gives a wrong result: It subtracts weighted group means but then centers on the frequency-weighted average of those group means,</span></span>
<span id="cb90-22"><a href="#cb90-22"></a><span class="co"># whereas fwithin(x, g, w, mean = &quot;overall.mean&quot;) will also center on the properly weighted overall mean.</span></span>
<span id="cb90-23"><a href="#cb90-23"></a></span>
<span id="cb90-24"><a href="#cb90-24"></a><span class="co"># Visual demonstration of centering on the overall mean vs. simple centering</span></span>
<span id="cb90-25"><a href="#cb90-25"></a>oldpar &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb90-26"><a href="#cb90-26"></a><span class="kw">plot</span>(iris[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dt">col =</span> iris<span class="op">$</span>Species, <span class="dt">main =</span> <span class="st">&quot;Raw Data&quot;</span>)                       <span class="co"># Raw data</span></span>
<span id="cb90-27"><a href="#cb90-27"></a><span class="kw">plot</span>(<span class="kw">W</span>(iris, <span class="op">~</span><span class="st"> </span>Species)[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>], <span class="dt">col =</span> iris<span class="op">$</span>Species, <span class="dt">main =</span> <span class="st">&quot;Simple Centering&quot;</span>) <span class="co"># Simple centering</span></span>
<span id="cb90-28"><a href="#cb90-28"></a><span class="kw">plot</span>(<span class="kw">W</span>(iris, <span class="op">~</span><span class="st"> </span>Species, <span class="dt">mean =</span> <span class="st">&quot;overall.mean&quot;</span>)[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>], <span class="dt">col =</span> iris<span class="op">$</span>Species,    <span class="co"># Centering on overall mean: Preserves level of data</span></span>
<span id="cb90-29"><a href="#cb90-29"></a>     <span class="dt">main =</span> <span class="st">&quot;Added Overall Mean&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a><span class="kw">par</span>(oldpar)</span></code></pre></div>
<p>Another great utility of operators is that they can be employed in regression formulas in a manor that is both very efficient and pleasing to the eyes. The code below demonstrates the use of <code>W</code> and <code>B</code> to efficiently run fixed-effects regressions with <code>lm</code>.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a><span class="co"># When using operators in formulas, we need to remove missing values beforehand to obtain the same results as a Fixed-Effects package</span></span>
<span id="cb92-2"><a href="#cb92-2"></a>data &lt;-<span class="st"> </span><span class="kw">na_omit</span>(<span class="kw">fselect</span>(wlddev, iso3c, year, PCGDP, LIFEEX))</span>
<span id="cb92-3"><a href="#cb92-3"></a></span>
<span id="cb92-4"><a href="#cb92-4"></a><span class="co"># classical lm() -&gt; iso3c is a factor, creates a matrix of 200+ country dummies.</span></span>
<span id="cb92-5"><a href="#cb92-5"></a><span class="kw">coef</span>(<span class="kw">lm</span>(PCGDP <span class="op">~</span><span class="st"> </span>LIFEEX <span class="op">+</span><span class="st"> </span>iso3c, data))[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]</span>
<span id="cb92-6"><a href="#cb92-6"></a><span class="co"># (Intercept)      LIFEEX </span></span>
<span id="cb92-7"><a href="#cb92-7"></a><span class="co">#  -1684.4057    363.2881</span></span>
<span id="cb92-8"><a href="#cb92-8"></a></span>
<span id="cb92-9"><a href="#cb92-9"></a><span class="co"># Centering each variable individually</span></span>
<span id="cb92-10"><a href="#cb92-10"></a><span class="kw">coef</span>(<span class="kw">lm</span>(<span class="kw">W</span>(PCGDP,iso3c) <span class="op">~</span><span class="st"> </span><span class="kw">W</span>(LIFEEX,iso3c), data))</span>
<span id="cb92-11"><a href="#cb92-11"></a><span class="co">#      (Intercept) W(LIFEEX, iso3c) </span></span>
<span id="cb92-12"><a href="#cb92-12"></a><span class="co">#     9.790087e-13     3.632881e+02</span></span>
<span id="cb92-13"><a href="#cb92-13"></a></span>
<span id="cb92-14"><a href="#cb92-14"></a><span class="co"># Centering the data</span></span>
<span id="cb92-15"><a href="#cb92-15"></a><span class="kw">coef</span>(<span class="kw">lm</span>(W.PCGDP <span class="op">~</span><span class="st"> </span>W.LIFEEX, <span class="kw">W</span>(data, PCGDP <span class="op">+</span><span class="st"> </span>LIFEEX <span class="op">~</span><span class="st"> </span>iso3c)))</span>
<span id="cb92-16"><a href="#cb92-16"></a><span class="co">#  (Intercept)     W.LIFEEX </span></span>
<span id="cb92-17"><a href="#cb92-17"></a><span class="co"># 9.790087e-13 3.632881e+02</span></span>
<span id="cb92-18"><a href="#cb92-18"></a></span>
<span id="cb92-19"><a href="#cb92-19"></a><span class="co"># Adding the overall mean back to the data only changes the intercept</span></span>
<span id="cb92-20"><a href="#cb92-20"></a><span class="kw">coef</span>(<span class="kw">lm</span>(W.PCGDP <span class="op">~</span><span class="st"> </span>W.LIFEEX, <span class="kw">W</span>(data, PCGDP <span class="op">+</span><span class="st"> </span>LIFEEX  <span class="op">~</span><span class="st"> </span>iso3c, <span class="dt">mean =</span> <span class="st">&quot;overall.mean&quot;</span>)))</span>
<span id="cb92-21"><a href="#cb92-21"></a><span class="co"># (Intercept)    W.LIFEEX </span></span>
<span id="cb92-22"><a href="#cb92-22"></a><span class="co"># -13176.9192    363.2881</span></span>
<span id="cb92-23"><a href="#cb92-23"></a></span>
<span id="cb92-24"><a href="#cb92-24"></a><span class="co"># Procedure suggested by Mundlak (1978) - controlling for group averages instead of demeaning</span></span>
<span id="cb92-25"><a href="#cb92-25"></a><span class="kw">coef</span>(<span class="kw">lm</span>(PCGDP <span class="op">~</span><span class="st"> </span>LIFEEX <span class="op">+</span><span class="st"> </span><span class="kw">B</span>(LIFEEX,iso3c), data))</span>
<span id="cb92-26"><a href="#cb92-26"></a><span class="co">#      (Intercept)           LIFEEX B(LIFEEX, iso3c) </span></span>
<span id="cb92-27"><a href="#cb92-27"></a><span class="co">#      -49424.6522         363.2881         560.0116</span></span></code></pre></div>
<p>In general it is recommended calling the long names (i.e. <code>fwithin</code> or <code>fscale</code> etc.) for programming since they are a bit more efficient on the R-side of things and require all input in terms of data. For all other purposes the operators are more convenient. It is important to note that the operators can do everything the functions can do (i.e. you can also pass grouping vectors or <em>GRP</em> objects to them). They are just simple wrappers that in the data frame method add 4 additional features:</p>
<ul>
<li>The possibility of formula input to <code>by</code> i.e. <code>W(mtcars, ~ cyl)</code> or <code>W(mtcars, mpg ~ cyl)</code></li>
<li>They preserve grouping columns (<code>cyl</code> in the above example) when passed in a formula (default <code>keep.by = TRUE</code>)</li>
<li>The ability to subset many columns using the <code>cols</code> argument (i.e. <code>W(mtcars, ~ cyl, cols = 4:7)</code> is the same as <code>W(mtcars, hp + drat + wt + qsec ~ cyl)</code>)</li>
<li>They rename transformed columns by adding a prefix (default <code>stub = &quot;W.&quot;</code>)</li>
</ul>
<!-- That's it about operators! If you like this kind of parsimony use them, otherwise leave it. -->
<!-- # Now with cyl, vs and am fixed effects -->
<!-- lm(W(mpg,list(cyl,vs,am)) ~ W(carb,list(cyl,vs,am)), data = mtcars) -->
<!-- lm(mpg ~ carb, data = W(mtcars, ~ cyl + vs + am, stub = FALSE)) -->
<!-- lm(mpg ~ carb + collapse::B(carb,list(cyl,vs,am)), data = mtcars) -->
<!-- # Now with cyl, vs and am fixed effects weighted by hp: -->
<!-- lm(W(mpg,list(cyl,vs,am),hp) ~ W(carb,list(cyl,vs,am),hp), data = mtcars) -->
<!-- lm(mpg ~ carb, data = W(mtcars, ~ cyl + vs + am, ~ hp, stub = FALSE)) -->
<!-- lm(mpg ~ carb + collapse::B(carb,list(cyl,vs,am),hp), data = mtcars)       # This gives a slightly different coefficient!! -->
</div>
<div id="hd-centering-and-linear-prediction" class="section level3">
<h3>6.6 HD Centering and Linear Prediction</h3>
<p>Sometimes simple centering is not enough, for example if a linear model with multiple levels of fixed-effects needs to be estimated, potentially involving interactions with continuous covariates. For these purposes <code>fHDwithin / HDW</code> and <code>fHDbetween / HDB</code> were created as efficient multi-purpose functions for linear prediction and partialling out. They operate by splitting complex regression problems in 2 parts: Factors and factor-interactions are projected out using <code>lfe::demeanlist</code>, an efficient <code>C</code> routine for centering vectors on multiple factors, whereas continuous variables are dealt with using a standard <code>qr</code> decomposition in base R. The examples below show the use of the <code>HDW</code> operator in manually solving a regression problem with country and time fixed effects.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a>data<span class="op">$</span>year &lt;-<span class="st"> </span><span class="kw">qF</span>(data<span class="op">$</span>year, <span class="dt">na.exclude =</span> <span class="ot">FALSE</span>) <span class="co"># the country code (iso3c) is already a factor</span></span>
<span id="cb93-2"><a href="#cb93-2"></a></span>
<span id="cb93-3"><a href="#cb93-3"></a><span class="co"># classical lm() -&gt; creates a matrix of 196 country dummies and 56 year dummies</span></span>
<span id="cb93-4"><a href="#cb93-4"></a><span class="kw">coef</span>(<span class="kw">lm</span>(PCGDP <span class="op">~</span><span class="st"> </span>LIFEEX <span class="op">+</span><span class="st"> </span>iso3c <span class="op">+</span><span class="st"> </span>year, data))[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]</span>
<span id="cb93-5"><a href="#cb93-5"></a><span class="co"># (Intercept)      LIFEEX </span></span>
<span id="cb93-6"><a href="#cb93-6"></a><span class="co">#  36777.2210   -317.9238</span></span>
<span id="cb93-7"><a href="#cb93-7"></a></span>
<span id="cb93-8"><a href="#cb93-8"></a><span class="co"># Centering each variable individually</span></span>
<span id="cb93-9"><a href="#cb93-9"></a><span class="kw">coef</span>(<span class="kw">lm</span>(<span class="kw">HDW</span>(PCGDP, <span class="kw">list</span>(iso3c, year)) <span class="op">~</span><span class="st"> </span><span class="kw">HDW</span>(LIFEEX, <span class="kw">list</span>(iso3c, year)), data))</span>
<span id="cb93-10"><a href="#cb93-10"></a><span class="co">#                    (Intercept) HDW(LIFEEX, list(iso3c, year)) </span></span>
<span id="cb93-11"><a href="#cb93-11"></a><span class="co">#                  -3.087522e-14                  -3.179238e+02</span></span>
<span id="cb93-12"><a href="#cb93-12"></a></span>
<span id="cb93-13"><a href="#cb93-13"></a><span class="co"># Centering the entire data</span></span>
<span id="cb93-14"><a href="#cb93-14"></a><span class="kw">coef</span>(<span class="kw">lm</span>(HDW.PCGDP <span class="op">~</span><span class="st"> </span>HDW.LIFEEX, <span class="kw">HDW</span>(data, PCGDP <span class="op">+</span><span class="st"> </span>LIFEEX <span class="op">~</span><span class="st"> </span>iso3c <span class="op">+</span><span class="st"> </span>year)))</span>
<span id="cb93-15"><a href="#cb93-15"></a><span class="co">#   (Intercept)    HDW.LIFEEX </span></span>
<span id="cb93-16"><a href="#cb93-16"></a><span class="co"># -3.087522e-14 -3.179238e+02</span></span>
<span id="cb93-17"><a href="#cb93-17"></a></span>
<span id="cb93-18"><a href="#cb93-18"></a><span class="co"># Procedure suggested by Mundlak (1978) - controlling for averages instead of demeaning</span></span>
<span id="cb93-19"><a href="#cb93-19"></a><span class="kw">coef</span>(<span class="kw">lm</span>(PCGDP <span class="op">~</span><span class="st"> </span>LIFEEX <span class="op">+</span><span class="st"> </span><span class="kw">HDB</span>(LIFEEX, <span class="kw">list</span>(iso3c, year)), data))</span>
<span id="cb93-20"><a href="#cb93-20"></a><span class="co">#                    (Intercept)                         LIFEEX HDB(LIFEEX, list(iso3c, year)) </span></span>
<span id="cb93-21"><a href="#cb93-21"></a><span class="co">#                    -45858.1471                      -317.9238                      1186.1225</span></span></code></pre></div>
<p>We may wish to test whether including time fixed-effects in the above regression actually impacts the fit. This can be done with the fast F-test:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a><span class="co"># The syntax is fFtest(y, exc, X, full.df = TRUE). &#39;exc&#39; are exclusion restrictions.</span></span>
<span id="cb94-2"><a href="#cb94-2"></a><span class="co"># full.df = TRUE means count degrees of freedom in the same way as if dummies were created</span></span>
<span id="cb94-3"><a href="#cb94-3"></a>data <span class="op">%$%</span><span class="st"> </span><span class="kw">fFtest</span>(PCGDP, year, <span class="kw">list</span>(LIFEEX, iso3c))</span>
<span id="cb94-4"><a href="#cb94-4"></a><span class="co">#                     R-Sq.  DF1  DF2  F-Stat.  P-Value</span></span>
<span id="cb94-5"><a href="#cb94-5"></a><span class="co"># Full Model          0.896  253 8144  277.440    0.000</span></span>
<span id="cb94-6"><a href="#cb94-6"></a><span class="co"># Restricted Model    0.877  197 8200  296.420    0.000</span></span>
<span id="cb94-7"><a href="#cb94-7"></a><span class="co"># Exclusion Rest.     0.019   56 8144   26.817    0.000</span></span></code></pre></div>
<p>The test shows that the time fixed-effects (accounted for like year dummies) are jointly significant.</p>
<p>One can also use <code>fHDbetween / HDB</code> and <code>fHDwithin / HDW</code> to project out interactions and continuous covariates. The interaction feature of <code>HDW</code> and <code>HDB</code> is still a bit experimental as <code>lfe::demeanlist</code> is not very fast at it.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a>wlddev<span class="op">$</span>year &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(wlddev<span class="op">$</span>year)</span>
<span id="cb95-2"><a href="#cb95-2"></a></span>
<span id="cb95-3"><a href="#cb95-3"></a><span class="co"># classical lm() -&gt; full country-year interaction, -&gt; 200+ country dummies, 200+ trends, year and ODA</span></span>
<span id="cb95-4"><a href="#cb95-4"></a><span class="kw">coef</span>(<span class="kw">lm</span>(PCGDP <span class="op">~</span><span class="st"> </span>LIFEEX <span class="op">+</span><span class="st"> </span>iso3c<span class="op">*</span>year <span class="op">+</span><span class="st"> </span>ODA, wlddev))[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]</span>
<span id="cb95-5"><a href="#cb95-5"></a><span class="co">#   (Intercept)        LIFEEX </span></span>
<span id="cb95-6"><a href="#cb95-6"></a><span class="co"># -7.258331e+05  7.174007e+00</span></span>
<span id="cb95-7"><a href="#cb95-7"></a></span>
<span id="cb95-8"><a href="#cb95-8"></a><span class="co"># Same using HDW -&gt; However lde::demeanlist is not nearly as fast on interactions..</span></span>
<span id="cb95-9"><a href="#cb95-9"></a><span class="kw">coef</span>(<span class="kw">lm</span>(HDW.PCGDP <span class="op">~</span><span class="st"> </span>HDW.LIFEEX, <span class="kw">HDW</span>(wlddev, PCGDP <span class="op">+</span><span class="st"> </span>LIFEEX <span class="op">~</span><span class="st"> </span>iso3c<span class="op">*</span>year <span class="op">+</span><span class="st"> </span>ODA)))</span>
<span id="cb95-10"><a href="#cb95-10"></a><span class="co">#   (Intercept)    HDW.LIFEEX </span></span>
<span id="cb95-11"><a href="#cb95-11"></a><span class="co"># -2.013725e-05  7.172011e+00</span></span>
<span id="cb95-12"><a href="#cb95-12"></a></span>
<span id="cb95-13"><a href="#cb95-13"></a><span class="co"># example of a simple continuous problem</span></span>
<span id="cb95-14"><a href="#cb95-14"></a><span class="kw">head</span>(<span class="kw">HDW</span>(iris[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], iris[<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>]))</span>
<span id="cb95-15"><a href="#cb95-15"></a><span class="co">#   HDW.Sepal.Length HDW.Sepal.Width</span></span>
<span id="cb95-16"><a href="#cb95-16"></a><span class="co"># 1       0.21483967       0.2001352</span></span>
<span id="cb95-17"><a href="#cb95-17"></a><span class="co"># 2       0.01483967      -0.2998648</span></span>
<span id="cb95-18"><a href="#cb95-18"></a><span class="co"># 3      -0.13098262      -0.1255786</span></span>
<span id="cb95-19"><a href="#cb95-19"></a><span class="co"># 4      -0.33933805      -0.1741510</span></span>
<span id="cb95-20"><a href="#cb95-20"></a><span class="co"># 5       0.11483967       0.3001352</span></span>
<span id="cb95-21"><a href="#cb95-21"></a><span class="co"># 6       0.41621663       0.6044681</span></span>
<span id="cb95-22"><a href="#cb95-22"></a></span>
<span id="cb95-23"><a href="#cb95-23"></a><span class="co"># May include factors..</span></span>
<span id="cb95-24"><a href="#cb95-24"></a><span class="kw">head</span>(<span class="kw">HDW</span>(iris[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], iris[<span class="dv">3</span><span class="op">:</span><span class="dv">5</span>]))</span>
<span id="cb95-25"><a href="#cb95-25"></a><span class="co">#   HDW.Sepal.Length HDW.Sepal.Width</span></span>
<span id="cb95-26"><a href="#cb95-26"></a><span class="co"># 1       0.14989286       0.1102684</span></span>
<span id="cb95-27"><a href="#cb95-27"></a><span class="co"># 2      -0.05010714      -0.3897316</span></span>
<span id="cb95-28"><a href="#cb95-28"></a><span class="co"># 3      -0.15951256      -0.1742640</span></span>
<span id="cb95-29"><a href="#cb95-29"></a><span class="co"># 4      -0.44070173      -0.3051992</span></span>
<span id="cb95-30"><a href="#cb95-30"></a><span class="co"># 5       0.04989286       0.2102684</span></span>
<span id="cb95-31"><a href="#cb95-31"></a><span class="co"># 6       0.17930818       0.3391766</span></span></code></pre></div>
<!-- *collapse* will soon support faster interactions with the help of algorithms provided by the *fixest* R package. For the moment this feature is still rather experimental.  -->
<!-- I am hoping that the *lfe* package Author Simen Gaure will at some point improve the part of the algorithm projecting out interactions. Otherwise I will code something myself to improve this feature. There have also been several packages published recently to estimate heterogeneous slopes models. I might take some time to look at those implementations and update `HDW` and `HDB` at some point. -->
</div>
</div>
<div id="time-series-and-panel-series" class="section level2">
<h2>7. Time Series and Panel Series</h2>
<p><em>collapse</em> also presents some essential contributions in the time series domain, particularly in the area of panel data and efficient and secure computations on (potentially unordered) time-dependent vectors and panels.</p>
<div id="panel-series-to-array-conversions" class="section level3">
<h3>7.1 Panel Series to Array Conversions</h3>
<p>To facilitate the exploration and access of panel data, <code>psmat</code> was created as an S3 generic to efficiently obtain matrices or 3D-arrays from panel data.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a>mts &lt;-<span class="st"> </span><span class="kw">psmat</span>(wlddev, PCGDP <span class="op">~</span><span class="st"> </span>iso3c, <span class="op">~</span><span class="st"> </span>year)</span>
<span id="cb96-2"><a href="#cb96-2"></a><span class="kw">str</span>(mts)</span>
<span id="cb96-3"><a href="#cb96-3"></a><span class="co">#  &#39;psmat&#39; num [1:216, 1:59] NA NA NA NA NA ...</span></span>
<span id="cb96-4"><a href="#cb96-4"></a><span class="co">#  - attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb96-5"><a href="#cb96-5"></a><span class="co">#   ..$ : chr [1:216] &quot;ABW&quot; &quot;AFG&quot; &quot;AGO&quot; &quot;ALB&quot; ...</span></span>
<span id="cb96-6"><a href="#cb96-6"></a><span class="co">#   ..$ : chr [1:59] &quot;1960&quot; &quot;1961&quot; &quot;1962&quot; &quot;1963&quot; ...</span></span>
<span id="cb96-7"><a href="#cb96-7"></a><span class="co">#  - attr(*, &quot;transpose&quot;)= logi FALSE</span></span>
<span id="cb96-8"><a href="#cb96-8"></a><span class="kw">plot</span>(<span class="kw">log10</span>(mts), <span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">&quot;Log10&quot;</span>, <span class="kw">vlabels</span>(wlddev<span class="op">$</span>PCGDP)), <span class="dt">xlab =</span> <span class="st">&quot;Year&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
<p>Passing a data frame of panel series to <code>psmat</code> generates a 3D array:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a><span class="co"># Get panel series array</span></span>
<span id="cb97-2"><a href="#cb97-2"></a>psar &lt;-<span class="st"> </span><span class="kw">psmat</span>(wlddev, <span class="op">~</span><span class="st"> </span>iso3c, <span class="op">~</span><span class="st"> </span>year, <span class="dt">cols =</span> <span class="dv">9</span><span class="op">:</span><span class="dv">12</span>)</span>
<span id="cb97-3"><a href="#cb97-3"></a><span class="kw">str</span>(psar)</span>
<span id="cb97-4"><a href="#cb97-4"></a><span class="co">#  &#39;psmat&#39; num [1:216, 1:59, 1:4] NA NA NA NA NA ...</span></span>
<span id="cb97-5"><a href="#cb97-5"></a><span class="co">#  - attr(*, &quot;dimnames&quot;)=List of 3</span></span>
<span id="cb97-6"><a href="#cb97-6"></a><span class="co">#   ..$ : chr [1:216] &quot;ABW&quot; &quot;AFG&quot; &quot;AGO&quot; &quot;ALB&quot; ...</span></span>
<span id="cb97-7"><a href="#cb97-7"></a><span class="co">#   ..$ : chr [1:59] &quot;1960&quot; &quot;1961&quot; &quot;1962&quot; &quot;1963&quot; ...</span></span>
<span id="cb97-8"><a href="#cb97-8"></a><span class="co">#   ..$ : chr [1:4] &quot;PCGDP&quot; &quot;LIFEEX&quot; &quot;GINI&quot; &quot;ODA&quot;</span></span>
<span id="cb97-9"><a href="#cb97-9"></a><span class="co">#  - attr(*, &quot;transpose&quot;)= logi FALSE</span></span>
<span id="cb97-10"><a href="#cb97-10"></a><span class="kw">plot</span>(psar)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a><span class="co"># Plot array of Panel Series aggregated by region:</span></span>
<span id="cb98-2"><a href="#cb98-2"></a><span class="kw">collap</span>(wlddev, <span class="op">~</span>region <span class="op">+</span><span class="st"> </span>year, <span class="dt">cols =</span> <span class="dv">9</span><span class="op">:</span><span class="dv">12</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">psmat</span>(<span class="op">~</span>region, <span class="op">~</span>year) <span class="op">%&gt;%</span></span>
<span id="cb98-3"><a href="#cb98-3"></a><span class="st">  </span><span class="kw">plot</span>(<span class="dt">legend =</span> <span class="ot">TRUE</span>, <span class="dt">labs =</span> <span class="kw">vlabels</span>(wlddev)[<span class="dv">9</span><span class="op">:</span><span class="dv">12</span>])</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAwAAAAKgCAMAAAAbNOrmAAAA6lBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZmYAZpAAZrYAkv8A/5I6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kJA6kLY6kNtJAP9J/wBmAABmADpmAGZmOgBmOjpmOpBmZjpmZmZmZpBmkJBmkNtmtrZmtttmtv+QOgCQOjqQOmaQZgCQZjqQkDqQkGaQkJCQtpCQ27aQ29uQ2/+2ZgC2Zjq2kDq2kGa2tma225C2/7a2/9u2///bkDrbkGbbtmbb25Db27bb2//b/7bb/9vb////AAD/ANv/tmb/2wD/25D//7b//9v////dsrbrAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAgAElEQVR4nO2dCZ/juHmnVWX3Ws3qSTzJJJJq2h5vHLuqx5ndeEre9VFa9+6kdZTE7/91lrgP4iQBXnj/v24VRQIkBbwPjhcguKpBoIK1GvsGQKAxBQCAihYAACpaAACoaAEAoKIFAICKFgAAKloAQISuH1/HvgVQYuUD4O1htVq9+1JfH5u/q3VNN+5eOp3t9nzfNr7r41P3+9s3N/OEb5OceY/+8G/NudfsqujG0d8zjnEw3MikdH1sUr2mN39YrTajXFjf6ROPFJSp6TIhGwBnlPBvD+++YEt6e1iTpLg+diMAp8/bN+rOg+9cegRp36Gx5f3dy+15fXtu7uv2jGycfatlANAHuve3h3/5+MPdy9vDYBbVTbIdhpqfLlPCeUO3AWgOtO5APrW0zSN5MxVHTJYJuQAQvxtbErI1sgsZXkchimQxWw2OoO9rIEUpeUD3hgt5+o3fNs4V8gNQ6N+hJpD3qmNLNrmOAJgSzh+6beus2LOcWt5mAIQlb7pMyAXAmde8xH7OqycFgOvjz3+FmyDI9HDN8LMHkgKo6bQmfxpTZOGa9PnbMzJSup+EXPPgN3wQJfcfSPDmrP8lR6BHaDii5l6a+8L39vFvKAPoN37bFAAS4bz62VdoY9+xFTeUpIIYJRmhWxRHePutSezbMzqkZgNJzpsh4fghmkxIJARPUpH4qOr52cPdPzQH/tpsrEShRwLLn/QyDIAmU/k15JvCd9LYCPpJzb5kmZALAFHQMwA2tAlEfmfz255IDqBGEvpPfxEKjgOTwoOFQ4lCChRRqCDIeHCUnijdySmbyzf/5AjsiFTqoEgHbPIb3mJ+YuhKfYAzyYbbM0GvRx02iPQmEPvPjuHtw2pzICamZcOa1IvthKOHaNORnIyEEDUAyieSVzg/yWlY3U9E9pHcki/DAEDJT68h3xS3EZKz6TIhJwA3Wv5wAKROME6TMyqBNzVpg9A0YqULLStYOJZevKyn16DB8WkoZCjoAdUKtRyBHZEA2NOE9AGAO8xr8qe5/fNw3cpO0gFgSYz28W2UKOt2NtDkNCWcOCTsmZXhUhOI5hXeZk0guVeM9rHcki/DwqAsoNcQNy7ZAsnZdJmQuQm0FwA8Ka1BmlhNgYIlDvImEinWWThRYJD9LCgNjv9IAKAUYzWAOJEKwIFkA4XoZm0CIaGCDblBfxCETFY6ACyJ0T6x/faAf5GWDQcBgJ5w9FCz+RfaA2UhNAA2XgBYbsmXkQGg1xC2IdkCydnpA0BzgQOwVytCtegR4WtRpD+J+lqqAdh+FMZRA+BdazlCC4DzitZMrJDBAEidYJzaLOdwnl0//nmGAMj3y7dpn0vPBqkG0BOOVc3nu9/QWpyF6FUDsJPIANBryDclt+NQzk0eAGJfB9YEavkDSONTlC/8IM0yFP2Aqz0SjoRZ12w/ucSGBRd9AHK6PSr+N3IEcSHRYK1r4fikHk/uBsUNJJy16AykCPwdcoPOsg/AzItv71FzZ23MBtoDayccYamJwssqFoIlqZxXuMMnABB3IPoA8mXkPgC9hkBP3ElNcnb6fQA27vUkD4SpNcAfVqQSZu4bepC6dZr29v0PuNr4A3cS7Jstup+ENHmBeBMIpxaPILKedENI/YrzE6c8H/PihdWe3DYJiuLQobPpe4HIT5PsUHi+6PaZJPGTng0i9dsJRw81x1jhy/KCJqnqBUL52Rz4owYADsz6cdJlJC8Qvwa7KelO6ttMvEA+hTqoXeEG98hfZzEOEKMu4wT7boXv29eBI8KEHPc1pj8O4FMKAMaZlXB9nHYXIEodAGAuiEjdPgUW2Qdp6MVxE1MfCfYpCQC95gJ11Xnqc4FiFA/AeZW5C9Rkqv8a6TIBZoOCihYAACpaAACoaAEAoKLlA2AFSqgO+QNKqC4AxOcZyKYuAKS/i3LlBuCMGdEH2CADEgoAGFdOAG7PZBqUNl4HGZBQAMC4cgJAVzzQFz6ADEgoZ2JCDZxdQTXAVwBANrkSE2rg/HL3AfAyJlACGfWeqO9pXIkJNXAyWbMKvEDdxJOzLwEhNQDUwDGSyqX3XNbQ4AXqIilBcwIANXCsuK0HV8/gBeqg99Yv8YpKTPvYDahWyqVggRcoXu8d36LlqQHu/ig9jxYSpVB17o+BFyhaejr3I8DZB/j+9frtS339Dmpgh/r5IsALFKt2WvciwOMFQrUv1MBtvQ/o3wYJvECRMqQ32tU5LwJqAOiDKUrifeYCL1CUzCkvu91iz+gZCYY+AFGyEl8XeIEiFJL4sRkEc4F8ymD1kuK8QCW74YJzIS63AACH8to+FniBwhSVDzG5BgDoytbaMQq8QCGKz4rg7AMAsHJb/aWR8QB4gQLULU8AgDDlLOsvTNYQ4AXyqmvuAABeZW7nOOyeC7xAVpG86ZFBQTELBSBza8dT7EuCuUA20eGtnmfwqigAsndvQ81eCLxAZqXIIgBAtvQBvDqxxo8EXiCjkmRV0QCwcp7Pz897ueAmjy7wApmUKLe6PpCRPspAMjozm+2s5t/Z9rE8NcCHl/OqvLkoqbKrJABcLfts5t/P9rHcfYBPL8gDVJoXKFl+LRmA95oGvny4m8cjnxfo7ZvyvEAAgFOjGLykVKZP5G4C/ekFvcUGQeCLsyAlzNuAU80MgFFNv4ft7xoZD7gBwG8gXulvzFk2ACkzeHEAjGb93Zo8O66qkTEIeIE0Jc3iRQAgNXhGsf8epo83K6vxIwEAmgAASby1Tz8HuzBVrO2rJT6VOwoAoCpxHvtPN1kAtJ4u8uYPcl2i2CZPcImvCwBQlDqPZwuAoa87lP13KvaDS3xdAICk9B6O1hpCrStMD4ARvZzdbf+I1eGSAIBQhlzXFpEzXGFaAIxm+zFNHq3E72r6RAAAV5ac5/4Tm2lNCYBxjD+2tS+1c/rZPhYAQJUp89/7mhRTAWCUsj/c9iXfDv7eucmjCwAgypX5XrMaH4ChpzaIJ7YibL/Syv1kdxMHwFLXBRpxfH88AHJNY7t4FHEqrdjHSmj8SFAD1CMO8NfjAZDc8LsYuF1SN1fam7TsJwIAxrX/AQCQynltZDehEs7PpKW+ujNZm18XADDq9EZPYvZfloY3cVQKYu7Qp4TTk43z1nKZPlHxAIxr/u7E7LYsjdSwn+yTuIq0GTzSkby2j1U4ACMX/7U7MQOXpTE9m/X+fbYf160/a5VtFkN+28cqGoDxzT+sBnAtS2NtzyT+cWmtnso6dye58W8bGQ+UC8C4zzZxORNzxGVpejgvQ+R4RCW19W+txo9UKgDTsP46MjEHGYfJYvCSjF4eoZTW77Z9rDIBmIz5e/oAj5vYKJ2Vrawn2qk9XUOI4zGlq3MbYPtYbgCWuTr0hMzf1wn+QV+TyRelg3KX+NID6YO0+UNNn8i9LtCMV4e2DvRPyvy9XqDr4+opJkqccps+EjF+x7MqKd09UbaP5VsXSPrjjDMpyYav2vtEer6S/G7Qvb40X+/0z9vakUTKfmd3N22TPz5OUA0wr9WhdRu3wTANBYwDxETxawC7R+LP6LqMP93l4to9ktx9gBmuDm0y8pGW7wtS/rlAef2ZbWnPpxvDJDf+zpGX5gWapJG7lBWAYSxeSJi+2/hT+vl7GD/SsrxA0yzkncoFwJi2X9saPqnn9vQq+4mW5AWaofnnAGCglg7XTrN9XPjrgdJPZ05g/EgL8gLN0fxTAzBusY9lnsqf+MJpjB9pMV6gWRb/dVoABi/3W3t1688xpTNR0U+1EC/QXM0/DQCDOXiobGuNt8v+1FdOa/xIM/MC2Zycw99JKvUHYNBGT82GdlsaYDp/auNHmpUXCD/loe2Zs/Ej9QVgMubPNzM9vpu87CeakReIPevU2jNrjb8uUISsTR9m/tke48pj/XWsF2jEdYFaExpmX/YTzQUAc6e3Vpo+2Z5hzGb+s/ECaVPallH4Y80BAOsLtoYo+7Oa/0y8QC1rX4z5zwAAq/GLhn/W59ezmv8cvEALaerYNGkA7EW/KPyzLt6QqecraeJeoIVbfz1dAKxtfqIhrD934Y81aS/Q4q2/niYAbtuXC/+MN5G/8Mea8FygEsx/ggB4jH+Yps8ghT/WdL1ARZj/xADwFf3C65N31bbBzH+6XqAyiv96QgB4jV/x+mS5BaoBzX+yXqBSzH8yAHiNf6Cmz8DmHwLA7dOL83gOlWP/EwDA4+8hGsz6hzV/Xyf4kUx9SL0sh08F2f/IAITY/kBen3rwwh/L1wfYDF8DFNP8xxoTgBDjH7DpM4L5+5tAh7sfBwagKPMfD4C4sn+RhT+Wtw9we9adQHkBKMz+RwEgzPgH8/qMaP5T8wItf+ZDS4MDEGj8gzV9RjX/CQEw2aXbMmtQAEKLflb4D/GaomHM/9TIeGASABRq+1jOxEw5GTHc+EnhP8g7ugbp+VqNH2kCAJRr/EiuxEw4GTHY+GnTZ5AX1A1S+DuMH2l0AMo2f3dippmMGDTQRXQ8VlW2V1JrGqrw94QYGYDSzT+sBug+GTHG9o/I/MNP3UvDOP291l+PDACYvycxe05GDDN+XuQPZf5DWX+A+Y8JQFkdX+vCbVGJGbMqR0jZL7d2hjP/AS4SaP31eAAs0PqtK1Qx4zcGcNcAH17OralYQenvtX6tpT+Q+U+n6cMUB0CidYGWUfhr63FeLASIINEA3D69IA9QpBfI3+nVe7mOt/Ym1VAu/5jQw9cAy7B+btfMqi+1aZlCteFjIsDjBXr7JsoLFNDpbbl4FlX4R5r/4AAsxPplW77I31UT14GIBaD+0wuai4sgCIoS1O7Rdg1j/kNN9Yw1/4EBWIr1161yXTRz6CHzcuUGApyJeXtGLc53agvIEiW23YM1lPkPcZUu5j8gAH2mOwz72hOv2gX7RT1svd9YAMwyRfEV/sahrUWZf7jjR9EwAPRp+RBrapmU9vLP4QgJK9htkVt7UgAQUPi3dw7U851s24dqCAB6Wz/bdBn8MAz0vUoOALpY/3A930Eu09n8BwGgj/nHBVfjpgciwSlbZ+gLgNv8bda/KPOvu5v/AAB0Lv47WDB3TeK4iQHIVMXkfB7APKdtWW7PXsV/nR+AYPPX7KujtV3kEyU02HwNrGwAWKZ0Lqzw72n+PgB6P5ARZv8XraPbw9zkmIlsNm8XOxMAlgnNy/L61/1aP1hOAPo+kBHW/JGnE1ySFra9TzSAfykHALb5/Ivy+yD1Lf5r38JY/R7IiDV/w9d+6nGuwXyryQGwPs0C5m9SUA3Q7YGMMPsPO1dHdexIDDmskBYA+7NcYP5mufsAPR7ICGr+5Da0LqcfeNQ5JQD2JxnB/G3K5AWahPnX8QQMP+kiGQCOB3kHMf8hlzZMZv6ZvEBTMf9YAMaYcpQIAJf1D2P+A1yEKqH5Z/ECTcf8azGBIihk/ttpKwEArlUcFlf4pzX/DF6gSZm/fEUnBuPNN+0LgHsJkwHMf2DrT2v+Kb1A798Hr2442uRmS30w5mzrnFMh8tv/sGuaJ7f+Op0XKGrKz+iz+9UHWka9nZwA5Lb/ga0/g/mn8QLFPusyuv3XyiNcY97GjAGYedOHqbcXqMOzLlMAoKazj0a/l4wA5LT/ZVh/nXkukFmj2xzVBKy/zglAPvufs9dHV5wXKMm6QFMwu+koFwDZ/J/DDnhlNv+sc4EsAvtXlAeAXOY/4FMuAxg/Ura5QFYBAIpyAJDP/POcV9VQpk808MJYYP+60gMwS/M/CWW8ikGZnwhrCwBQlQyAikz6Gd/8T12U56YDNLAXaBKOl0kpEQDE7rNNfPOb/wRsuZNyPhHWUj/zH2oxj2GVBIDMKeM2/zmavdBwXqC+bndSv0+AgapKeRspABhtxHfWpk80lBco2vo1I+PfRiOgYlK/9b0fZ2IG9sHGGPJagO1jDeAFin+8nPXnpD3GzeHkMPTWkaqysWLixZWYgX2wbClis/6F2D6WtwZYd+gDcIvvsrSCZCRsy1IZZFPbgL3BpYj6idzXciVmWB8s35CvcfeCjB/J2wc437/GAcBeiNVtbQXNXipj4ZuZAHH68DZO5+ZQSA3g7IMN6fdZUtFP5fcCXT/+NRiA/guKtNsTxlBZERi0keUsTUL6YFnu1mT+yzN+JHcN8Akl/fXXIV6gNAtJBedmRgQSnll/6brh+cWoDpVhMmKOdDCX/hkuNAH5+gCoDj7fewBIt5JURHYm8sL0uQWHjsL2j0KGgL4+wCH0FUmpZHb8LLL0R0rgBUo5utvB+nozoHpo+p3MZepmeQA4r5M/j+GUreeb8ZLjqjcAaSc3dDO/bgi0qxC03QeACLvn8gBw2CQcifeqlJ6vpMFngzrV2fo6IJC2dx1X7EtyAvD47vO/N3++G6YGMJj/so0faSEARJtuj3bT0aTOZ3Mn5tvD3cvbh6TPY9hkNP8sV5qUFgMAb9LkulB/Wzcq67pA4Wqb/+LLfqJJAZDEASMzUJnU5ULJ7Z5rCgAYHD9lWH+9RABqfSqD4Wj4qbKU+rJGB8Bo/aWY/ywAyG2CDg1w2XEBKNz662kB0LZ/yfRHYGCQK44JQPHWX8cCkGRdIKsUAAzFfiZ7VCkL9OzshHzH3UFHA6Dkhr+kCdYAdutLWCTrdh7RztJNOdTUSVB910gAtKx/+R5/syYEwLHyW6E4aA9qLMPT+O0dtt1VwwOw3eqFf6nGjzQdAI5BvhlTua19N4XuU3V4y/VeGhaAlu2X2OxXNBkA+s5py+IqymX1koYEADq9bU0AgDyzmrsrb4mvazAAoNNr1MgAcNMfx88vNKzVSxoIACj8LRoVAFHuj2T/Y1m9pCEAgMLfrtEAEM2ePOO8Zkd8kLNyUGUHAAZ7nRoFAGT8SRw0uqZl20HKCwBYv0/DA0CNv9c5DJqV1UvKCQCMdvk1LAC06I+L5Gi9zLDE15UNABjtCtKAANiK/m4N9VlbvaRMAOiFPxi/RYMBsKsm3BMdUTkAUAv/pSxjm0dpARCPXelWPqWRrkkpOQCK9YPt+5QCAM3ssWtHa+6A+duUGACt7I8/eWnqDYDi0ZTdmuGrKxetpABI5g9lf5h6A+B06kxsls8UlRAAbv5g/OGawGS4RSr4dYjJAGDmD8YfJQAgRuGv/dxqsp4yEQD0CmD9sZogAObiMp8zL9yqyfV12w4xc7tSALDl5t/hBgpXNgCMBhtuZa3w4fFj5TBo3bS7WrlD/QEgd6SlHChQbgAC3lLoNGPjzikouR13lhOAgPRHP2RSSTszOQHo9qb4oBJ1ZPVPuFRyJWZY+oPx95ETgNZbCg3rAk3ZuOYgFwAhb4kE8++noBogyZviQUaF1ACQ/vnk7gOke1M8yCJnYkL6Z9cE3aBlKSox8y5NWaQAgJHlTUzyrtqoKKBwAQAjy9kJfiQlvu81taDu6gQAKKFcKf32sDHVAKCE6gBA98BLjpTnUoe7H1sA5L/qHCMlvBQA0CVSpkvdnnUn0BBXnWEkAGDkSENeapSrTjwSADByJABg3EgAwMiRAIBxIwEAI0cCAMaNNBYAINDSBACAihYAACpaAACoaAEAoKIFAICKFgAAKloAAKhoAQCgohUAAF6oYL9aPdX1YbVa4xVsnsIjHdBE7E1kpE5Xop/+SLdn6eznwEhqLHLZuEupJwgWpL8hVrL09wNwfbx/rc/vvtw+vbx9/eX2/HT99kVfu8AVqcZLHURG6nQl8hkQ6bCu+dnlT/eV5FjkspGXUk4QLEh/Q6x06e+fo/79XxvWDpvmXBv0idduaj+5ZI/UfN0/xUYiwSMjyVF9P0u7RmAkHotcNvJS+naQIP1NsdKlf2ATCMH9vNn/9qGpQ85rnKShkchqZ7GR3h7uXmIj0c+QSCgWCSh/+iKJWPSycZfStkMF6d+OlS79w/sAd7/Z7N99Cb1ZEan50/yPjITTMvpKJGpQpG9Z9sZkgIgVkQFKpG8DrUo5AaR/K1a69A8FoEaxULzAOk5EIpuRkQ44z2KvhD9DIr19eGG3FFEFS7HIZSMvpZ4gWJD+7Vjp0j+0CbRGPSkCT1AvTkQi671GRjqjsm4TG2kd2N0jx2M7YXIsctnIS6knCBakfztWuvSPdoNuop1jKNu6eNTyueH2smcw2A2nxAp1w8mR9uEOScsPhPRPnv4wEAYqWgAAqGgBAKCiBQCAihYAACpaAACoaAEAoKIFAICKFgAAKloAAKhoAQCgogUAgIoWAAAqWgAAqGgBAKCiBQCAihYAAJqd2FOYKZQZgLeH1Wr17kt9fXz3BS/lcnu+f0Vf0EG0LQfWv3NdH3+PXyC6R6d6eyCx9VjsL3nluuF9o+yyRlmvLengDzK6eCK3D6G8QMlCEgg/JnZ7Jn89siQO3319jHrETRV6TusJ3x052/6ePOpFs/D6uGZXQjfODj6lyo28AJzRE3zIYgkAzbdOABzuXvbNT74+/ne0CJOWZ20A1tQONNkBePvGfu3mGN982Nh+6GTEE5nvYT8A58UBJ+Ma/RaUim8P/xhiRj4ADu7XGyuJqO9Dd7S/e7k9r2/PTf40SKKTijMKAJjpvD38y8cf7l4S5UZWAITJUQDuX2UAdNmMEKUMyr63D//54QWnmCmWAgBKU/vdaCLGYJZ8DOfQxMUTme1gP4D8epL8PIEO93/22a5DIuU96WJKYHlfk7nInBurp4W89AMEAOS+UejfoSZQotzICgAudLAIAL94ftJrgGb7D6wK/AX5mSvS0EH5SHIHpRX6f77/6+MG5xxa5RGH/dnD/d9QLBa75jUAPgeuR9kl0L49pYdeBZ3n3X+hk6GzvD38otn83SO7nxUqmNCFaGgTVVMTT2T6E2lK8bxoig9iSGe8WOb6+rhhEZu05L8U/fq1lEz3r3tqglIIluLYlmkMnjMkzUUCv6q5we+L3hS6neb/9ePf2L3znBIAkAjn1c/wqg5pciMrAKKwJgCsz01i6AAg7Ekb6e2BHMPHD6sNi37GtXpjvet6jytKlBQsslQzan0Akl0oNL/EZ1ptsqs0V2j+oQy8YQDQf2T1pJgkZ13X0j31aOsOIyWR2Q9AovfepCUDAC3/tuHlKE5LFgkFwSHJV5QgzEJ5CJHi6FQ8hsgZNYH13JBqABTpgE+/obaOtvatPsCZoIfYwdVXktzIDgC5XZqqt+fft2sAmr6k6UpaqrSQX4vTNH2jvz03teS7n0hK1yyDajk2Ck1TDMVh5Te5xPXx57+iZ2RXOaxIS5gBQPKInOlGy601Dy3VaJMVT2R20y4A0G9irW2clizSmQfGX1mJsBenlVOcGK+IQXMGHRYJrOeGBMAer2EtA8BPpQDAFmtBf5LlxhBNoD0HoD78wgIAYQX9xcJtEFbF4bw73P3xsUmj+788kNRSAGCxUWiev6g/iAoXAQCvddlVUJ7INYAAgEVG+/g9zQMAksjsppmhGZpAvLAlEXEVRyJRWkQyNQH3TdmzUULIAPAYTwoAIoH13BAAHAg0FCInADVpFV8//pAsN4boBEsA4D6atwYgcX/2wM0V8/DbD2hxu//B2HfWAOjombb7hU3f/5meXUq782ptAoBF5jWAFm2q4onM7tXRCcY+atKskGuAulbK85raH3FBnKUUDKgBap7Aem5wAIhXj1VIBgBoHpPQ2BauH/88DwDIjzuIJhD6YgYA/T1LNSTKIObwxL+0yVXuJRMtTZo4LDYKzfMXRT+s1EvwhiXZtUelE24TtAFgkaVm0Tz6ALX2q2VDU9ygB9LkEElSq7khlePYM7NqhZD7ADSGyBk1gdu5wcDE12duUKkPQG0eNZAwLegMpLr/HXKDzqEPwHqkjH2c8GYAFC8Q8/ZTnw0pLPYr8Sl8DbR0ULxArBHVNBXvfyDwiZ7ymt8XyVSUq/vV3Y96H4BGRseYcy6vFwi3FnoXajyR+bDRng0K6gNh1PQPUknLI0leIO6VJAGlEG4vEG8CkQR+0XKD3RdpU21ItVXX/FpiKHPPhu0OdHSMDp3NwAuUSFPxv+e9jz+9oLGhQ8jI7MQ0eP5c5zIOkEoTmYPAfeZZTt5kKnrBUMJpLoNplPxJlBuzAKDXXJN0OufMZ7Rm/e37V7yW+dw0Sv4kyo1ZAFCEUOP6Cb/CATSgBADnlWUWJQi0XHEAbs/E4zLHKngRggJoFHEAaO9rlp2wJQgKoHHUqgG0dy6tQAnlyAhLATT2HS9LLgDIw1utKhg6yQnlSkxbAZTzfkqTG4DWESs0oI5yJiYUQNnlqQE+vJylhxQccUAd1SExIf0TygkAeVtxqxMGGZBQvsQ8t+dBQPonlBOApveFHlNudcJy31RJAgDGlbsJ9KcX/Db5b2zHR9Vu7BtIIndi4nmR+gSviaT/LFXpO9wAkOm4k8yA3a4EAKAGSKuW/Ud6gcKODyBk/QAAKFZLAWAnfc5c4AUaUG37BwDGlicxr4+r33/i4wAwDmMw4X6xAYCR5U7M2/PT/gnc0EK9ADBFniUAO+XPvOVOzOvH1/0TuKGFAACknfZ3zgqoAc7voAZg6gOAMS4AMLL8fQCYiiKpEwBbR1wAYGSBFyhKPQAwRwUARpYzMc1PhI2e/iOqCwBbQsByANi1NmaskOcBwAvEVXUgYLkALIGALk+E5byficsHwNa4CwCYruCJsCh5ANiaAUD/LREBgJEFT4RFyQ3A1lIDLB6AGYMAXqAYVc5eMDX19s5lAbBrbc55ZnRAYkIfgMsJwJZ/tPY2n4sEgGzvoAYoRS4AttKnYTcAME0BADFyALBV/rR3V8bDSwBgV8+5E+DrBK+hCSTJDsC2taF+tdQPCwBgp++bl3xu0PP9KwDAZQVga9hSvi0HANXWdykeDZC71UOj5B0Iu378KwDAZANga9ysdQAMTlIAoJatfse+7LB6nTVMzhoAPwt2/XW3gTBDbs9eFgC2lm3pW7U1p8jsATDtjD+jchph+gNA4OkDoKFg/b0nQZ2ZZjUAACAASURBVOm/3VpLxRnLDMA24MtSAXDtjDmjvSeRGYE8XqCtOiZUEgCW6qAyjhIvBgDT3lDDFY0oS4ysCGQBQOvxmWbIzFOVcUQ3CABLKswOAJuRtg/HAeAcTchIAAAQIyMAFsdnrdq/pRpcLgAOg94Zv7isPB8BOQBQfd+1pfU7R/UBwKyFAbCT7dlmtTulURNm29kIAABiFAeAdAAA0MJGP1WWi4D8ABjnSM5UIQAYB4UBAKqT8HU6z2e+QgavaAYAtCIQAKgXBICnXa+69A2BTxIhkSvsEutPTUB2AGxDoLOUCQDL/E/1QCEASBYqG6sU6XRSInUo0RNXAlkB4M1/AMB2RjcA01uWww9A268vmeypPtW9lZSA9ACofnDbJLCAyBNUEACGmdH2pwicAExwWY5QAOQpQlJv4LRLQkDCWmAYAIINe+JDBjEABFUAbgAmuCxHBwDklv6pTgFAnXCWUF4AjM0BZ+RFAECkxrMoqAaY0LIcTgBazX+9Y4CtPw0BrnuJ0dQAmHQjqKrbthx0vx0BmOCyHM7pCjt9S39gZpcUgCQEJAfAbBCBZj1xl+ngALSOjP2GEofJOQFgn9j4dQJOnZFIQMD0AJgwAUMDgBr/h0m9JTIIAKnXu5ObRdT+NQBOfTxD/QkAACJU8Q+hkLt1rKXiAwC9pHBCXiAnAIZBYHmLAyAb/MlYJyS5oTClBsBiDzEATJeAEQA4bCblBQoDwLSFKwgDAPqO6DvqiUBUYgY0QVMAMFkCDAD0bAF5AHh89/nfmz/fzawGsGxlAaAvAgPVAIE2DQBo+94e7l7ePkzHC+Scs+82RHQ4CwD92kGJAbDaQ5ChxDpNh9bwAATHySv75OWjIZD9JC0ATkd9Tyf1qAQAgAgBAH0AkMxcbKQBoEclMEkApkoAAOACwC8TAEd1R2ftOj4vkBYAuzn0B2ACULQB6Gv/MwOgbV59AahTAdD1eQEAIELFAqAMZylKBEBnAtrxIgmYEQDjE6ADsA27JwCAKgcArYi8tgojYSgAQggwPk4udk0MgEDr97xWae4ARBEwCAB01sUuEIGkALgsoj8A4xOgAhAYx/1avQUBcFK/SrK5/yUAOhJgfL5ALLsSgMA0ATA/ZTIpAIKmQFTe9wovB4CTHYD2cBdD4lj3qwLM06ul2/SuMg0ARCgKAL/xIy0FAD6n01EFZAKAnd1xBgcBKQFw2kRPACYxT7QSn/5bCXun/EwAUGb1KxJuTAcAsqHW0qYfAA8X7Lwnz6RqOwElAJCMm9IBMJkRtl+5hLcT4ATAbL8tszZ+DZhTbW0GzRKASIvOAEDAKQEAWYkA0Ns5J+uXliwEJATAYxRem9latqUdBINYj2iyEYQYAMLsf4EAWAkwGOupNgKguEvVaBoPjm+tA2YCZgKANE86ujGUbAShEn8AACYPAJKX1AKAoRNwOkmHT2osR5nvAcCsiQKgh+aNn+1W3hE0GJUBgGQtoLIBIHNB21XASSn71aqhAwDO/vHcAJD3kBcxeRlICcC2BgBUtQFQCJC2owCQn5V3tIhq+zd5f1cAbs/oCchNWBS/HcYEsAAg7xIzh9wQJBtBqMhFq7BBsLBzzgUAZXkrWRIAhirAOlHCBYBe8ocCYLFz82AZkzMx//RSv31TH9ZBUeIM3HfcD4AWwMoA7zf0Fi76t1sAQNGxbhXVYmygDwBaYMNwWm4A0GoEt08vYYsS+I0iqonk+hZ3+pQAMC9USNgwlQoAMctAACRH/9HoLbJGrE3YKHIlJnpR9u37V+eyNM4ZzJrcQfoC4Ow2JCGAAlCVCoDZj2gAQLSLQgBoEWAyVtolOEYAYK03FDkT8/q4Wj15FiVQvDJuxQDgbBCFnGCbD4CwsGECAMIAoLVAFACK6dsI6O8FijCwmKHieACUkWTe893qh7rLAIDVzssCgP5aBQCH/dPD7In4MABISCcApjED30mdiRn0gpIBAAg03626lR4AchbJtu0TPosEQCEgDwAKAT4AlHEDy1mdfYCwF5REuBk93krb11gA5GZZRBPNJ9b4F8ZdEAC17bWn2NYNVYADgOpoBeB4PDrtPw4AefStAwChLygJH2lyhLNMfsCbkac3tf6zAFBZ7TzU/ssFAA1PmQCo+VIpxkvJABi8Ra1NV4MJK6QG8L6gJNy67CGtAERMZdOaO7IDtCMASjQdANNq6bUaxKtFA2AzZA0AmQAc0dFycgPgqh06AJDhBSV2a24d2Hoi2E6yVb7GuGkN5wMAuOwAVCf2g0/SXgcAOHQEAFspmMnpJJQYALP6pb9tyNYIQOxEZq070h8AY1dEmhUKAHQD4GgBgHaP1YjUCrjPNAQA41iC6VZ8iXlet3b1Tn+TWbd2Vdsu8/i1KNt+ALR5Ircm/SkIANszVUcBgNQGco4CRAHAMpH3GGYPgAkBAwAdTdZynZQAEJFtc8wFAmB9rrbChqVXAX4ARFPHCQDPhDEAOKA+QJZXVOnmrdun6YWkXS5jv0JYZJ831nyT4be+ZADsw8CkFyyO82di2t4j4coTPiPH7AbXuO+EagAkvbGiyNW86HiR+MpAH+IbHoCgkcihlBAAUgWEACAce1J10REA496JAGCy/yRVgOkSUeNqUjTj/YTvNMoJQOBI5ECyAFDRkSv8myUAjvEA4F0neYcFgJM8yUFRcgDSRDHK0bqolD+JrxfauRgfgNCRyFHVGYDaAAD5X3kAqDEDDiO3jPp2AOD6uPr9J14Dp31PsxUAPsEgEwBhVUBrCNkca4gawDsSOaYUAKQOagwAePMiAKi8ANhlrRy6ANDkwP4pVw1sBkBZUbBiuwJW2Qy+XhwAPkdqTgAyjEQmV1WzyTtKFXCqrRMaaCwdgIsEgEjANgDNhjv/TlYATPvdidlUvvunXDWwqXupmXklA9EbAZ6YnQAwt4CMth5xo3FeoLRVcBJZAXAX1ZUOwAVVAaIJpK7AGgWAY5XQaABwDXB+l6kPZmhd6KajGn1PBKIAaBX8YwFw+/TiPD6yBABYXQFo7J8DIE0xEaWQ3GHQe3H6ldIBgJ8Ju1crgJwAeC2nFwGiOg0gYAoAoNRHup9uH6CqVQDcbhgpXhuA6kJbLyj5aBUQBICzsaUoHgCTZguAsP0YADg34YO+yWqAt4fNxGuAzgConeTLsaneL2iQlwGgrkGsAKB14o7+jrF+d5L6PxHWXe3upd9yIglQg/cAYBsz6yFhE+hw9+OkAUA6Gb4FACDbPzL4CreBOAC4wRsAgOZPIqHDbhUpwRNh3dVytKQHQAkfAYDWQ9/aL50XgCYT9AJoagCcVPNzOeKFFAAupMlTqQCg3DMBoPbijtKnFKC1T7o5RSmeCOssHYAQw4kjoFIR2PL2jE8qAFvHldu7HbfYyoAZzQWyqRMATSdAAQB3fCUAqPmyjhcHoKpVALSHysgGmTrUH4Ds4zD6WFMOAJQY29YlbVIGKbauK8cAEJb+8wbANRIlSRrtxQAcOQAk+SgANMT2yKMpAKiGT5aNoLksASDdYFAJxJV9HEZrjwQZdwwB+pyijgA4LwwA9AXgQr9Vx4sNAJEHVSAAx/ZBdnOKxvQCtVyS2QFo9zosMh3vD0CgF27mALiGYoWkRLpgXxLadeEtIKktU0tbCABcG+jNfNEVOBoAcHiJAhIz41wsFYBA044goDWpLgkAJ8t+y3eu0KkoMwXgPd8xFACyXR/ZBwFA9g05ZyWNXgPEVgD9AJCv7FJSANQ1+lQVC4CUTBfq9jk2BHAAalHO17XcDK22pJmjzZkWFo/cpGirMgHQythxAVDH9EItO5yALADo71uoDMHk2bonOoG9GACcr+zlkgDAn8cAALBPwwyAaPNsSZ+5kgDgQdv5OjYA8pdsABhiJAbgpImEq+U/ZqNYEABSFRAFALF/CkBtBuCoA3DcHrVinZfzjfUf8bglI0AAYMjWkQGQFW/XwQFjATAepSdpOTkq5dkM6VL255aEFglASAvICgDbbwMANfCP2oxQxfFPAKh4G0g0jkzZ6hwIG3YuVnzbPjhcVgAcDSL368uRlgBA3W4DBURrAYCn/1w0AHghzscit+o0OfFFNHOOdOaW1J0+6lGYnIl5/VYfhfdG6aF4/6YvZuUI0UoNg+ffdLZ2h/bUDmQ+ZtIyAQgSS6oLjagBgFv6RwUAUgHYAJC/kEAqAOYyz52Y+qMAAVG6K2qMt1K2vS56GwBioEWZYRUDwEm7lzjNHwAx878bAJeaA4AJEAAcj1vh4BcA1G0CWtt0mEBMqrA+RTOdPoDPdC6W4GiyT1cA+Opz6oCEOa1kAGrZx1PpYSK0JAAiCRAAkIgtACRXjxuAqlV4SYP38gkMmi0AtbI0mzmyDwCSVgoF6kb7ZNITT/yv6zI+FQwAFQegrqWGOxZv2tMGjBWASgOgkqoAuwMIazYAXFoEyGW/DwAjAfqwcAwAck1QqUGiBABcpJgYAJHPGgDc8Cts83KyS4/rFQRALc11NsZ2A9BOEudECTLAxb8SV/9Jvo0O9l8yABfpjwCgkup6EwDYvnGC81yqcLVQiUiVmCvE5tzx6aS6JgNAQAvIQIA7uqcGaGtrPdICALk4T+pBACAmHi3RLkrUqg0AG8faCgDoUdnJLVcQAgBUBbAhAAsBSwHAGD/aPeMDQPF+qu5P++uSnCoYgK0NgPpyIXvdANQ2AKTq4VjxIbCZAyAnVmj8ynPcoC2W9QIut34n+18WADEEXBqjJGuhyFF5MXJBEDArJgAYnD/ij9RHVgAQWCwdAMMJOgDgPn/IAGekSgXgUrsBwGGYFZOp0VEASJ0A9sVMwFQACHOCxhFQuQ9HCgAwqzMAhACepTiu2pBkxm4BQHGBb70AmA0AAAhVlcP+lwFAfCcAZ+SWLAgqx1WXMGAHpYdjDNOH9ba/AspRtIdmDcBF+xt0DgBgCKkAeKaZU/E+rgQAqwJqbrxbJbttAFTicGUAQOkqGzQRAMIqgDqOAPfXcBF/T5XD/ucPAE4V0QaKBKB2A9AmoHgAYghIBAB5oitPBbA4APQqwAAEc3IaawvZejVA8OSVbSu0MgC2VYCQzmjN/dkBEOELdTeJQkUHe4OecopXaQBcLhf7Qe0A/pQnRrQc1BoA+FXm8ve6ngkAEfYfToCnUxyoU/eoISoOANdB7chWjWEYn6mknGGzG3UAPKP06QC4YMWfDikKgFACPAMDYUpn/+bEWQYAXO8vbgIujmOtIxoAJqnvktnqNQINUw8AwCXAT2lXHACuq5gAuBgOBiqh/ddGBhYGgK8KCAWAl+dqnIsqddxgu9WBIBoCAJGx3QhIB4A4lb5Qw+kUb8nJ7N9aNQIAZkkAsLKjXXxcLlYALpctx6RyZWFUYtpeURXYRW3peCSj3JH2H1IFnMSTinwiNXLl0DV6tNDKuaWU7gKAkk/einF5AGhm7QLATYA4aG9aV5WoD5DFV5eKocKjN7tSAWCJogzfBRNAjf94PCYFoCZGXnO7lYfbT9ifKXl09LeOsaQmqRhv/yS+XB9e3NNY3QBM6k3xZunOMWcnQE+IQAAcarm6pRrBtLOl/gBoz+QGAiCvV3qsjqwuMCsKAG7fAgCpF0AbhDTb9MpRO+8Jm3MEANqANYPJEcMJwLTeFG9WLgAC32fucHXLAMRVwR4pUSpybqkk1fssplOo1k7i2gFon0Ldo7w1XGxXIqh2hoqP7vJg5Bdo58V7oioAvqFg55ATgDm8KX5kAHSZAEA7ozphHmlRLtqVeSkotSbYsSOVegYa1UqA4d6lXXQdQmlRQnmOlHkeNW4mSQErUo3pFQCO2qECINtBdWFQDTDlN8W3AbB3Alop4rTxTgAYVRkvTtQbgLaP0dDvIwjYWjl9ADAN0MoAXLTwUoiTUvijv+0KoLXTqeDxOiF3H2D6b4pvJX8UAAmN3C9zhvQFQDprJe9qe6ysjXxOji2AAwDz/IRK9EvMADACLDcin7viXjjXLbYv4lyUXijOCzS9N8X7AZC9Oa3oQwJgVsqpEBIB+k9trN/uyuKBzMeN8fBOx/ychgHU1rKNT1S4da9FV1o7J9FPpsZ/sVk125cegPPq7j8f8r2pPIFMANiqAENGLgsA0exWfypr9BsGMlQvi9lk9JY51sWzCDe7JDdOrfvRtGwu2gTPizKKxsIpx4+me2SVm2b/nuqCyt0H+PTy9vA0aS9QOw/sbaDlA6B0PJmUFyJLQ8YX5iGPAED4e04h5o/i0tGGi3roUrEBA2Wk+EhWnNHXO2En4+sMyzsvDAH5Vx9rQ1CTfF6g2/evk/YCAQCqKn1kqdXyp0NFwmMuRzBajLnDq3mWpE3Jy0Tb7ap5kpZRyzl8Ef4ky3pbl7ZZXy6scju2KgDb71EU4gW6fjezGkAnwDEePjoB6adDVwICy+iWPDjgB4CEpWX/USrbqcHzSxkudhFnVV2Ux2NV6V6bo1TDVExyCGbjF47ZReoAXKTLH7W/dnm8QB9emo7ArLxA5k4AynJjX26BACAhu3GO7XJpA02GKBdhlviM1PouIee/GLYZfuhV5VK1YMoe7RJHVpDxEQ7lho+mLVEj7Yx3OPu5QC3ZXD1mJ8hCAZDeUOYNqX5tWzVv+KiHgtzsCgB8Dq24mDpya5L6vvELC0n7LxogrQ1xlt3OTEA5AExUuZ4IO4YOoLbCKUZ1ZObfLu9DCPCGIQ0XY/Hfup+j4t8yIWNv+e8QA6ZW2vIAmBkB6QBQDTd4DpkhmNSwP7EGdztUAABBjFyOTvvn99N2dRpC1sbx7h0p/E1VAAAwspIBcNSbC2EEtCbg0Pj4dKj4t5uc37zDZiOEPMfpnq3KtNvtTMF2rQ0hAGBk9QVA9XcwOyHfdJeoSRYAmPk7jdjfwPFfP5ka42/s+7hrGbm8p01AEQBMWb1rANni6Q5RCsoEmL0gKgDtgS5Xaup+fE+AnJKsXEVA+9aKCACMLGdihj2QdHRMexEEWLwgsjdentjM9jlTU/VytpsyQ2WFVuzv2Pddqz5opQEAMLJciRn8QJKjecyaQbtayn0xwCQ9hSKN8yoDZS5pPpmLt07IoLaVk53G/S0BACPLlZj9H0hCRoBtXXaDYOuXRlrpUK+IdanlqRJOiYmahuAD5ESYlTu0QADmRUBIDRD+QJKh/bvbNVbOdqO/7Z6xPrOTluaex8l5aHUZBv08dWBR3JItlnS+vtZfAwCjy5mYkQ8kIXtgNiE35HeiydNsthsHl9a0ZLYV4qHUWhsXeS870oEB/luk06vnS2D+AMDoSjUOIFkJtn787aR4ddAsSw6CMB7lkfY6Kvl029ypZn9phTXJcmb1V7WDJjF/AGB0JfAC6QVsY8/yd8mr016sjRzp0HK32665P+A5k8ZDGuMOEQAwslJ4gVRzOUXZD7Y406RNS2hnua2eoVs+4MZNp5idBACMrBReIGwvtDCPX0YfWVzY2qKhrY6L8idaiRo3YQIARlYCLxBp7de17zlFq1CJjhEwlu1Bpb4q+wNIk9MSAZhHylMl8ALtOhT7Le0IBRdzdzZW6uDAlAUAjKz+XqBdppcH9ZLtCbzJCQAYWb7EPK89UaZo/khdX1YzsBYMwHwzQJYPgNOQPcYo4fR/P/Zd+LRcAOZh/57EPKA+wDvVC6pFmSwASO8nT8BiAZiJ/feuASZu/5OvAxYJQD2XHlidoA8wYb2XPqcqAGBk5VoVYji9xzId0P5OUgsFYDb270vM6+Pq95/4OEDo6tzvfeoUyXku10UMu7tfKLEWCsDYNxAud2Lenp/2T1NenLiD8hlzFy0TgBnJnZjXj6/7pykvTjx7AQAjK6AGOL9bVA0wLQEAI8vfB5j0C0pmLwBgZM3fCzRvAQAjK8kTYaDO6gQAKKEcCW17IgyUUB0A6B54yZEyXMryRFjmq840UsJLAQBdImW4lOWJsMxXnWkkAGDkSDkuZX4iLPdV5xkJABg50pCXGuWqE48EAIwcKd+loA8w8KUAgC6RoAYYN9JYAIBASxMAMBWZB8JAmQUATESWgTBQZgEAE1HIQBgovQCAiShkIAyUXgDAVBQwEAZKLwAAVLQAAFDRAgBARSsAAOyY2K9WT3j1vjX2WD+FR8Ir/m0iI3W6Ev30R7o9S2c/B0ZSY5HLxl1KPUGwIP0NsZKlvx+A6+P9a31+9+X26eXt6y+356frty9eX4UUqcaujchIna5EPgMiHdY1P7v86b6SHItcNvJSygmCBelviJUu/b0A3L7/a8PaYdOca4M+8VjN7ZPbWSFHar7un2IjkeCRkeSovp+lXSMwEo9FLht5KX07SJD+pljp0j+wCYTgft7sf/vQ1CFoBcu9r74SkcjoZmykt4e7l9hI9DMkEopFAsqfvkgiFr1s3KW07VBB+rdjpUv/8D7A3W82+3dfQm9WRGr+bOrwtCSRcFpGX4lEDYr0LcvemAwQsSIyQIn0baBVKSeA9G/FSpf+oQDUKBaKF1jHiUhkMzLSAedZ7JXwZ0iktw8v7JYiqmApFrls5KXUEwQL0r8dK136hzaB1qgnReAJ6sWJSGR+V2QktEDafhMbaR3Y3SPHYzthcixy2chLqScIFqR/O1a69I92g26inWNk1ft4j1o+N9xe9gwGu+GUWKFuODnSPtwhafmBkP7J0x8GwkBFCwAAFS0AAFS0AABQ0QIAQEULAAAVLQAAVLQAAFDRAgBARQsAABUtAABUtAAAUNECAEBFCwAAFS0AAFS0AABQ0QIAQEULAAAVLQAAVLQAAFDRAgBARQsAABUtAABUtAAAUNECAEBFCwAAFS0AAFS0AABQ0QIAQEULAAAVLQAAVLQAAFDRAgBARQsAABUtAABUtAAAUNECAEBFCwAAFS0AAFS0AABQ0QIAQEULAAAVLQAAVLQAAFDRSgPAebVa3b3Ie67ffSEb+w3f9/b1F3H8cbUmOx/0qE2w2/Pqt1JgECiXEgGw1vcwY3/75+9fTTEOm+u3Lyzg+Z1m7G9g/aBhlBSAw6op1pvSe7VpPohR758OTzXZh8wahyAxqJGjP/xAUx3cv759/dPj6v4vX3/B35LcHwhkUTgAR4PYMdQEevelsePrx9cGhuaTmjfdYvs+4xA4yp6W+qQGIAdQpXBAZOB/P+FvSX8tCKQpaQ3QFNl3L83HmjdiDhtUCdR8Hw5Roy7A7x6fmgO8D0Ci4kgMgM/QDgJlV0oAzve4DEfG/ERsuenq4rqB7fs7DYHAeHvA7RsSkEQFAEBDKykA6/p894JaLfsNtWu0//aJ7/s7DoEOvPtye35HzZ1HRXDg5hBvArW6xyBQUqVzg66emvL+vz0+1XtU5l8fG9O9EQ9QY9170kf4iYRo1OxYYzx4VYEO0E7wF/oPOsGg3IKBMFDRAgBARQsAABUtAABUtAAAUNHKNRnOJD4BDk+NeFKPfSf5O9lUIMtEOhAomXJNhjOJT4C7PW9qusmkGDibJmSZSAcCJVM4ABeD2DECAJrH/Onl7Ze/un894Mlvv/wVKvLPxglw9f/9f+TI2z81FQOaPPeZRlwzAGwT6UCgZErXBMKT4RAAH17qt6/wzIYPL7dnPCliT9o7bAIcmzqEj6CweMocjognxdHBMetEOhAolVI2gSgAxGiRaTdbhw0eJUaNeTEBjgJAjvBY2OylSXG2iXQgUDolBoDOaFMAYO0WfQKcjg2OKCbFWSfSgUDplBSAr16bZgx+wkVuAuHPWp4AhzvBjxveRJIAwJPiMADWiXQgUDqlnAxX71c//zWx3gP6qneC+QQ4XLpv6BECwPURzQKlk+LQKRwT6UCgZMo5EAa+e9DkBQCAihZMhQAVLQAAVLQAAFDRSgOAsubbd1/Uxr80pc0Wh8a0TpZjT8hDrwKUWOkB0I00fEqbf7IcAABKrHAAdgaxY2wVoBWd1vb153/ipTmZ0obGBP71ebWhvv9f/kos/WZeLQ5NljuIsJ/xmIIysnDgU+nSJQeoNKWsAfhMtqbFgme4oUN0ShsaIkajxJ/JBDg87+0nthCcvlqcmCyHYuOwnx+e0Kgx+STnIEf5hUCgDkraBGIz2bCd3z7hNgyb0kbXOvk7mwDH2/V1e7U4Nn2Iz4zDRDWnesOfdHodO0ovBAJ1UEoA+Ew2CQA2pY0DwCbAcQDOttXipJlxGgBr5SgAAOqupACwmWwSAGxKG1/vkD8jwJZ+M6wWRyfLiZlxWhMIn4MfBQBA3ZUIgIemmF+TmWx4WhsDgE9p48u9sQlwNVv67dpeLY5OlhMz494MnWB+FAAAdRcMhIGKFgAAKloAAKhoAQCgopWqE9z0Yg/3ZDkH8gAk9fVQWV8jKd4W+eGlVrqz2pwiMqPo9oznCMGUCFAiJQLgH79prPeXZETWCIDtNZLibZEPaxUAtk4E/UZmFIHlg9Iq1TjA//xy/bfvX/HyVT//1VONP5nTs3a8RlKa//MfLwgAtqTW3T/gpbLUGUVX9PpI4zwiEKiTwgGoDGLH3r7+3y/nf0UAfP7qtWkPvZFPOvOndrxGUnpb5Odv0IAZW0+iJktlqTOKar5+VmseEQjURalqgL8//Z8fEQD/C0/9IROA2Myf2v4aSeltkV9/+dOPn17EikKkCaTOKGLtotY8IhCom1IB8NO/ff83AwCsfWJ7jaQy/+ftn20A8EWyNADOsFgWqJ9SAfBf//HNjTaBro94vU80TeEzXxTL9hpJ5W2R+zvWBNIAYDOKBADaPCIQqJuSTYY7bG60E3z3D6gT3HzKnWDzayS1t0Wi5j1ZUguvkfWuNaNIAKDPIwKBOgkGwkBFCwAAFS0AAFS0AABQ0QIAQEUrkRcoaCZbOxrM7AGNrFSzQUNmsoFAk1M4AO8NYseCZrKFrI0FAg2rVANhATPZgtbGAoEGVbKRYP9MtoC1sUCggZUMAP9MtoC1sUCggZVuYSzvTLaAtbFAoIGVDgDvTLaQtbFAoGEFA2GguNmnJAAAA2xJREFUogUAgIoWAAAqWgAAqGgBAKCilQgA9Mij6saxT4eDKXCg6SiRG/SrV+wGlXfBdDjQDBQOwNYgdoyZOpkMhwYAfnw2TIfDa8LhJ+hh8htoGkrUBNqjOZ01Hwmm4776dDi2JtxnmPwGmoiSdYKvj/evfC4Qn/igTYdja8LB5DfQRJTQC0Re30he4PutAgBf2I2uCfd3mPwGmojSAHBuGkBoghtpAn31iuf9t6fDsTXhYPIbaCpKVAMcyCK4eDJc0yH4+a9fjAu77cm06J9g8htoIoKBMFDRAgBARQsAABUtAABUtDLMBdJeDmnYbRG8CBI0uDLMBRKma9ltOwm8CBI0uNI9E0z+oDFgPgVImiKEV8JCu9n2/SvZ+qdHeBEkaDyFA3AyiB+kc4EIAA9P5L1I0m40BQjPDOLbbO9Xr/AiSNB4SjoXiALQNHwOG2k3fTkkGRZj27Wyt4YXQYJGUdK5QHQWEAZgz1ouhw1Z94qYOt+u5b01vAgSNI5SzwVCs4B4E4juJi+HpACw7VreW8OLIEHjKO1cIDwLSHSC6W6y7hUxdb6t7IUXQYJGEgyEgYoWAAAqWgAAqGgBAKCiBQCAihYAACpaAACoaAEAoKIFAICKFgAAKloAAKhoAQCgogUAgIoWAAAqWgAAqGgBAKCiBQCAihYAACpaAACoaAEAoKIFAICKFgAAKloAAKhoAQCgogUAgIoWAAAqWgAAqGgBAKCiBQCAihYAACpaAACoaAEAoKIFAICKFgAAKloAAKhoAQCgogUAgIoWAAAqWgAAqGgBAKCiBQCAihYAACpaAACoaAEAoKIFAICKFgAAKloAAKhoAQCgogUAgIoWAAAqWgAAqGgBAKCiBQCAihYAACpaAACoaAEAoKIFAICKFgAAKloAAKhoAQCgogUAgIoWAAAqWgAAqGgBAKCiBQCAihYAACpaAACoaAEAoKIFAICKFgAAKloAAKhoAQCgogUAgIoWAAAqWgAAqGgBAKCiBQCAihYAACpaAACoaAEAoKIFAICKFgAAKloAAKhoAQCgogUAgIoWAAAqWgAAqGgBAKCiBQCAihYAACpaAACoaAEAoKIFAICKFgAAKloAAKhoAQCgogUAgIoWAAAqWgAAqGgBAKCiBQCAihYAACpaAACoaAEAoKL1/wHX9Ma2ICaLAQAAAABJRU5ErkJggg==" width="100%" /> <code>psmat</code> can also output a list of panel series matrices, which can be used among other things to reshape the data with <code>unlist2d</code> (discussed in more detail in List-Processing section).</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1"></a><span class="co"># This gives list of ps-matrices</span></span>
<span id="cb99-2"><a href="#cb99-2"></a>psml &lt;-<span class="st"> </span><span class="kw">psmat</span>(wlddev, <span class="op">~</span><span class="st"> </span>iso3c, <span class="op">~</span><span class="st"> </span>year, <span class="dv">9</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">array =</span> <span class="ot">FALSE</span>)</span>
<span id="cb99-3"><a href="#cb99-3"></a><span class="kw">str</span>(psml, <span class="dt">give.attr =</span> <span class="ot">FALSE</span>)</span>
<span id="cb99-4"><a href="#cb99-4"></a><span class="co"># List of 4</span></span>
<span id="cb99-5"><a href="#cb99-5"></a><span class="co">#  $ PCGDP : &#39;psmat&#39; num [1:216, 1:59] NA NA NA NA NA ...</span></span>
<span id="cb99-6"><a href="#cb99-6"></a><span class="co">#  $ LIFEEX: &#39;psmat&#39; num [1:216, 1:59] 65.7 32.3 33.3 62.3 NA ...</span></span>
<span id="cb99-7"><a href="#cb99-7"></a><span class="co">#  $ GINI  : &#39;psmat&#39; num [1:216, 1:59] NA NA NA NA NA NA NA NA NA NA ...</span></span>
<span id="cb99-8"><a href="#cb99-8"></a><span class="co">#  $ ODA   : &#39;psmat&#39; num [1:216, 1:59] NA 114440000 -380000 NA NA ...</span></span>
<span id="cb99-9"><a href="#cb99-9"></a></span>
<span id="cb99-10"><a href="#cb99-10"></a><span class="co"># Using unlist2d, can generate a data.frame</span></span>
<span id="cb99-11"><a href="#cb99-11"></a><span class="kw">head</span>(<span class="kw">unlist2d</span>(psml, <span class="dt">idcols =</span> <span class="st">&quot;Variable&quot;</span>, <span class="dt">row.names =</span> <span class="st">&quot;Country&quot;</span>))[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</span>
<span id="cb99-12"><a href="#cb99-12"></a><span class="co">#   Variable Country 1960 1961 1962 1963 1964 1965 1966 1967</span></span>
<span id="cb99-13"><a href="#cb99-13"></a><span class="co"># 1    PCGDP     ABW   NA   NA   NA   NA   NA   NA   NA   NA</span></span>
<span id="cb99-14"><a href="#cb99-14"></a><span class="co"># 2    PCGDP     AFG   NA   NA   NA   NA   NA   NA   NA   NA</span></span>
<span id="cb99-15"><a href="#cb99-15"></a><span class="co"># 3    PCGDP     AGO   NA   NA   NA   NA   NA   NA   NA   NA</span></span>
<span id="cb99-16"><a href="#cb99-16"></a><span class="co"># 4    PCGDP     ALB   NA   NA   NA   NA   NA   NA   NA   NA</span></span>
<span id="cb99-17"><a href="#cb99-17"></a><span class="co"># 5    PCGDP     AND   NA   NA   NA   NA   NA   NA   NA   NA</span></span>
<span id="cb99-18"><a href="#cb99-18"></a><span class="co"># 6    PCGDP     ARE   NA   NA   NA   NA   NA   NA   NA   NA</span></span></code></pre></div>
</div>
<div id="panel-series-acf-pacf-and-ccf" class="section level3">
<h3>7.2 Panel Series ACF, PACF and CCF</h3>
<p>The correlation structure of panel data can also be explored with <code>psacf</code>, <code>pspacf</code> and <code>psccf</code>. These functions are exact analogues to <code>stats::acf</code>, <code>stats::pacf</code> and <code>stats::ccf</code>. They use <code>fscale</code> to group-scale panel data by the panel-id provided, and then compute the covariance of a sequence of panel-lags (generated with <code>flag</code> discussed below) with the group-scaled level-series, dividing by the variance of the group-scaled level series. The Partial-ACF is generated from the ACF using a Yule-Walker decomposition (as in <code>stats::pacf</code>).</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a><span class="co"># Panel-ACF of GDP per Capita</span></span>
<span id="cb100-2"><a href="#cb100-2"></a><span class="kw">psacf</span>(wlddev, PCGDP <span class="op">~</span><span class="st"> </span>iso3c, <span class="op">~</span>year)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1"></a><span class="co"># Panel-Partial-ACF of GDP per Capia</span></span>
<span id="cb101-2"><a href="#cb101-2"></a><span class="kw">pspacf</span>(wlddev, PCGDP <span class="op">~</span><span class="st"> </span>iso3c, <span class="op">~</span>year)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1"></a><span class="co"># Panel- Cross-Correlation function of GDP per Capia and Life-Expectancy</span></span>
<span id="cb102-2"><a href="#cb102-2"></a><span class="kw">psccf</span>(wlddev<span class="op">$</span>PCGDP, wlddev<span class="op">$</span>LIFEEX, wlddev<span class="op">$</span>iso3c, wlddev<span class="op">$</span>year)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1"></a><span class="co"># Multivariate Panel-auto and cross-correlation function of 3 variables:</span></span>
<span id="cb103-2"><a href="#cb103-2"></a><span class="kw">psacf</span>(wlddev, PCGDP <span class="op">+</span><span class="st"> </span>LIFEEX <span class="op">+</span><span class="st"> </span>ODA <span class="op">~</span><span class="st"> </span>iso3c, <span class="op">~</span>year)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
</div>
<div id="fast-lags-and-leads" class="section level3">
<h3>7.3 Fast Lags and Leads</h3>
<p><code>flag</code> and the corresponding lag- and lead- operators <code>L</code> and <code>F</code> are S3 generics to efficiently compute lags and leads on time series and panel data. The code below shows how to compute simple lags and leads on the classic Box &amp; Jenkins airline data that comes with R.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1"></a><span class="co"># 1 lag</span></span>
<span id="cb104-2"><a href="#cb104-2"></a><span class="kw">L</span>(AirPassengers)</span>
<span id="cb104-3"><a href="#cb104-3"></a><span class="co">#      Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec</span></span>
<span id="cb104-4"><a href="#cb104-4"></a><span class="co"># 1949  NA 112 118 132 129 121 135 148 148 136 119 104</span></span>
<span id="cb104-5"><a href="#cb104-5"></a><span class="co"># 1950 118 115 126 141 135 125 149 170 170 158 133 114</span></span>
<span id="cb104-6"><a href="#cb104-6"></a><span class="co"># 1951 140 145 150 178 163 172 178 199 199 184 162 146</span></span>
<span id="cb104-7"><a href="#cb104-7"></a><span class="co"># 1952 166 171 180 193 181 183 218 230 242 209 191 172</span></span>
<span id="cb104-8"><a href="#cb104-8"></a><span class="co"># 1953 194 196 196 236 235 229 243 264 272 237 211 180</span></span>
<span id="cb104-9"><a href="#cb104-9"></a><span class="co"># 1954 201 204 188 235 227 234 264 302 293 259 229 203</span></span>
<span id="cb104-10"><a href="#cb104-10"></a><span class="co"># 1955 229 242 233 267 269 270 315 364 347 312 274 237</span></span>
<span id="cb104-11"><a href="#cb104-11"></a><span class="co"># 1956 278 284 277 317 313 318 374 413 405 355 306 271</span></span>
<span id="cb104-12"><a href="#cb104-12"></a><span class="co"># 1957 306 315 301 356 348 355 422 465 467 404 347 305</span></span>
<span id="cb104-13"><a href="#cb104-13"></a><span class="co"># 1958 336 340 318 362 348 363 435 491 505 404 359 310</span></span>
<span id="cb104-14"><a href="#cb104-14"></a><span class="co"># 1959 337 360 342 406 396 420 472 548 559 463 407 362</span></span>
<span id="cb104-15"><a href="#cb104-15"></a><span class="co"># 1960 405 417 391 419 461 472 535 622 606 508 461 390</span></span>
<span id="cb104-16"><a href="#cb104-16"></a></span>
<span id="cb104-17"><a href="#cb104-17"></a><span class="co"># 3 identical ways of computing 1 lag</span></span>
<span id="cb104-18"><a href="#cb104-18"></a><span class="kw">all_identical</span>(<span class="kw">flag</span>(AirPassengers), <span class="kw">L</span>(AirPassengers), <span class="kw">F</span>(AirPassengers,<span class="op">-</span><span class="dv">1</span>))</span>
<span id="cb104-19"><a href="#cb104-19"></a><span class="co"># [1] TRUE</span></span>
<span id="cb104-20"><a href="#cb104-20"></a></span>
<span id="cb104-21"><a href="#cb104-21"></a><span class="co"># 1 lead and 3 lags - output as matrix</span></span>
<span id="cb104-22"><a href="#cb104-22"></a><span class="kw">head</span>(<span class="kw">L</span>(AirPassengers, <span class="dv">-1</span><span class="op">:</span><span class="dv">3</span>))</span>
<span id="cb104-23"><a href="#cb104-23"></a><span class="co">#       F1  --  L1  L2  L3</span></span>
<span id="cb104-24"><a href="#cb104-24"></a><span class="co"># [1,] 118 112  NA  NA  NA</span></span>
<span id="cb104-25"><a href="#cb104-25"></a><span class="co"># [2,] 132 118 112  NA  NA</span></span>
<span id="cb104-26"><a href="#cb104-26"></a><span class="co"># [3,] 129 132 118 112  NA</span></span>
<span id="cb104-27"><a href="#cb104-27"></a><span class="co"># [4,] 121 129 132 118 112</span></span>
<span id="cb104-28"><a href="#cb104-28"></a><span class="co"># [5,] 135 121 129 132 118</span></span>
<span id="cb104-29"><a href="#cb104-29"></a><span class="co"># [6,] 148 135 121 129 132</span></span>
<span id="cb104-30"><a href="#cb104-30"></a></span>
<span id="cb104-31"><a href="#cb104-31"></a><span class="co"># ... this is still a time series object:</span></span>
<span id="cb104-32"><a href="#cb104-32"></a><span class="kw">attributes</span>(<span class="kw">L</span>(AirPassengers, <span class="dv">-1</span><span class="op">:</span><span class="dv">3</span>))</span>
<span id="cb104-33"><a href="#cb104-33"></a><span class="co"># $tsp</span></span>
<span id="cb104-34"><a href="#cb104-34"></a><span class="co"># [1] 1949.000 1960.917   12.000</span></span>
<span id="cb104-35"><a href="#cb104-35"></a><span class="co"># </span></span>
<span id="cb104-36"><a href="#cb104-36"></a><span class="co"># $class</span></span>
<span id="cb104-37"><a href="#cb104-37"></a><span class="co"># [1] &quot;ts&quot;     &quot;matrix&quot;</span></span>
<span id="cb104-38"><a href="#cb104-38"></a><span class="co"># </span></span>
<span id="cb104-39"><a href="#cb104-39"></a><span class="co"># $dim</span></span>
<span id="cb104-40"><a href="#cb104-40"></a><span class="co"># [1] 144   5</span></span>
<span id="cb104-41"><a href="#cb104-41"></a><span class="co"># </span></span>
<span id="cb104-42"><a href="#cb104-42"></a><span class="co"># $dimnames</span></span>
<span id="cb104-43"><a href="#cb104-43"></a><span class="co"># $dimnames[[1]]</span></span>
<span id="cb104-44"><a href="#cb104-44"></a><span class="co"># NULL</span></span>
<span id="cb104-45"><a href="#cb104-45"></a><span class="co"># </span></span>
<span id="cb104-46"><a href="#cb104-46"></a><span class="co"># $dimnames[[2]]</span></span>
<span id="cb104-47"><a href="#cb104-47"></a><span class="co"># [1] &quot;F1&quot; &quot;--&quot; &quot;L1&quot; &quot;L2&quot; &quot;L3&quot;</span></span></code></pre></div>
<p><code>flag / L / F</code> also work well on (time series) matrices. Below a regression with daily closing prices of major European stock indices is run: Germany DAX (Ibis), Switzerland SMI, France CAC, and UK FTSE. The data are sampled in business time, i.e. weekends and holidays are omitted.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1"></a><span class="kw">str</span>(EuStockMarkets)</span>
<span id="cb105-2"><a href="#cb105-2"></a><span class="co">#  Time-Series [1:1860, 1:4] from 1991 to 1999: 1629 1614 1607 1621 1618 ...</span></span>
<span id="cb105-3"><a href="#cb105-3"></a><span class="co">#  - attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb105-4"><a href="#cb105-4"></a><span class="co">#   ..$ : NULL</span></span>
<span id="cb105-5"><a href="#cb105-5"></a><span class="co">#   ..$ : chr [1:4] &quot;DAX&quot; &quot;SMI&quot; &quot;CAC&quot; &quot;FTSE&quot;</span></span>
<span id="cb105-6"><a href="#cb105-6"></a></span>
<span id="cb105-7"><a href="#cb105-7"></a><span class="co"># Data is recorded on 260 days per year, 1991-1999</span></span>
<span id="cb105-8"><a href="#cb105-8"></a><span class="kw">tsp</span>(EuStockMarkets)</span>
<span id="cb105-9"><a href="#cb105-9"></a><span class="co"># [1] 1991.496 1998.646  260.000</span></span>
<span id="cb105-10"><a href="#cb105-10"></a>freq &lt;-<span class="st"> </span><span class="kw">frequency</span>(EuStockMarkets)</span>
<span id="cb105-11"><a href="#cb105-11"></a></span>
<span id="cb105-12"><a href="#cb105-12"></a><span class="co"># There is some obvious seasonality</span></span>
<span id="cb105-13"><a href="#cb105-13"></a><span class="kw">plot</span>(<span class="kw">stl</span>(EuStockMarkets[,<span class="st">&quot;DAX&quot;</span>], freq))</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1"></a></span>
<span id="cb106-2"><a href="#cb106-2"></a><span class="co"># 1 annual lead and 1 annual lag</span></span>
<span id="cb106-3"><a href="#cb106-3"></a><span class="kw">head</span>(<span class="kw">L</span>(EuStockMarkets, <span class="dv">-1</span><span class="op">:</span><span class="dv">1</span><span class="op">*</span>freq))</span>
<span id="cb106-4"><a href="#cb106-4"></a><span class="co">#      F260.DAX     DAX L260.DAX F260.SMI    SMI L260.SMI F260.CAC    CAC L260.CAC F260.FTSE   FTSE</span></span>
<span id="cb106-5"><a href="#cb106-5"></a><span class="co"># [1,]  1755.98 1628.75       NA   1846.6 1678.1       NA   1907.3 1772.8       NA    2515.8 2443.6</span></span>
<span id="cb106-6"><a href="#cb106-6"></a><span class="co"># [2,]  1754.95 1613.63       NA   1854.8 1688.5       NA   1900.6 1750.5       NA    2521.2 2460.2</span></span>
<span id="cb106-7"><a href="#cb106-7"></a><span class="co"># [3,]  1759.90 1606.51       NA   1845.3 1678.6       NA   1880.9 1718.0       NA    2493.9 2448.2</span></span>
<span id="cb106-8"><a href="#cb106-8"></a><span class="co"># [4,]  1759.84 1621.04       NA   1854.5 1684.1       NA   1873.5 1708.1       NA    2476.1 2470.4</span></span>
<span id="cb106-9"><a href="#cb106-9"></a><span class="co"># [5,]  1776.50 1618.16       NA   1870.5 1686.6       NA   1883.6 1723.1       NA    2497.1 2484.7</span></span>
<span id="cb106-10"><a href="#cb106-10"></a><span class="co"># [6,]  1769.98 1610.61       NA   1862.6 1671.6       NA   1868.5 1714.3       NA    2469.0 2466.8</span></span>
<span id="cb106-11"><a href="#cb106-11"></a><span class="co">#      L260.FTSE</span></span>
<span id="cb106-12"><a href="#cb106-12"></a><span class="co"># [1,]        NA</span></span>
<span id="cb106-13"><a href="#cb106-13"></a><span class="co"># [2,]        NA</span></span>
<span id="cb106-14"><a href="#cb106-14"></a><span class="co"># [3,]        NA</span></span>
<span id="cb106-15"><a href="#cb106-15"></a><span class="co"># [4,]        NA</span></span>
<span id="cb106-16"><a href="#cb106-16"></a><span class="co"># [5,]        NA</span></span>
<span id="cb106-17"><a href="#cb106-17"></a><span class="co"># [6,]        NA</span></span>
<span id="cb106-18"><a href="#cb106-18"></a></span>
<span id="cb106-19"><a href="#cb106-19"></a><span class="co"># DAX regressed on it&#39;s own 2 annual lags and the lags of the other indicators</span></span>
<span id="cb106-20"><a href="#cb106-20"></a><span class="kw">summary</span>(<span class="kw">lm</span>(DAX <span class="op">~</span>., <span class="dt">data =</span> <span class="kw">L</span>(EuStockMarkets, <span class="dv">0</span><span class="op">:</span><span class="dv">2</span><span class="op">*</span>freq)))</span>
<span id="cb106-21"><a href="#cb106-21"></a><span class="co"># </span></span>
<span id="cb106-22"><a href="#cb106-22"></a><span class="co"># Call:</span></span>
<span id="cb106-23"><a href="#cb106-23"></a><span class="co"># lm(formula = DAX ~ ., data = L(EuStockMarkets, 0:2 * freq))</span></span>
<span id="cb106-24"><a href="#cb106-24"></a><span class="co"># </span></span>
<span id="cb106-25"><a href="#cb106-25"></a><span class="co"># Residuals:</span></span>
<span id="cb106-26"><a href="#cb106-26"></a><span class="co">#     Min      1Q  Median      3Q     Max </span></span>
<span id="cb106-27"><a href="#cb106-27"></a><span class="co"># -240.46  -51.28  -12.01   45.19  358.02 </span></span>
<span id="cb106-28"><a href="#cb106-28"></a><span class="co"># </span></span>
<span id="cb106-29"><a href="#cb106-29"></a><span class="co"># Coefficients:</span></span>
<span id="cb106-30"><a href="#cb106-30"></a><span class="co">#               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb106-31"><a href="#cb106-31"></a><span class="co"># (Intercept) -564.02041   93.94903  -6.003 2.49e-09 ***</span></span>
<span id="cb106-32"><a href="#cb106-32"></a><span class="co"># L260.DAX      -0.12577    0.03002  -4.189 2.99e-05 ***</span></span>
<span id="cb106-33"><a href="#cb106-33"></a><span class="co"># L520.DAX      -0.12528    0.04103  -3.053  0.00231 ** </span></span>
<span id="cb106-34"><a href="#cb106-34"></a><span class="co"># SMI            0.32601    0.01726  18.890  &lt; 2e-16 ***</span></span>
<span id="cb106-35"><a href="#cb106-35"></a><span class="co"># L260.SMI       0.27499    0.02517  10.926  &lt; 2e-16 ***</span></span>
<span id="cb106-36"><a href="#cb106-36"></a><span class="co"># L520.SMI       0.04602    0.02602   1.769  0.07721 .  </span></span>
<span id="cb106-37"><a href="#cb106-37"></a><span class="co"># CAC            0.59637    0.02349  25.389  &lt; 2e-16 ***</span></span>
<span id="cb106-38"><a href="#cb106-38"></a><span class="co"># L260.CAC      -0.14283    0.02763  -5.169 2.72e-07 ***</span></span>
<span id="cb106-39"><a href="#cb106-39"></a><span class="co"># L520.CAC       0.05196    0.03657   1.421  0.15557    </span></span>
<span id="cb106-40"><a href="#cb106-40"></a><span class="co"># FTSE           0.01002    0.02403   0.417  0.67675    </span></span>
<span id="cb106-41"><a href="#cb106-41"></a><span class="co"># L260.FTSE      0.04509    0.02807   1.606  0.10843    </span></span>
<span id="cb106-42"><a href="#cb106-42"></a><span class="co"># L520.FTSE      0.10601    0.02717   3.902  0.00010 ***</span></span>
<span id="cb106-43"><a href="#cb106-43"></a><span class="co"># ---</span></span>
<span id="cb106-44"><a href="#cb106-44"></a><span class="co"># Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb106-45"><a href="#cb106-45"></a><span class="co"># </span></span>
<span id="cb106-46"><a href="#cb106-46"></a><span class="co"># Residual standard error: 83.06 on 1328 degrees of freedom</span></span>
<span id="cb106-47"><a href="#cb106-47"></a><span class="co">#   (520 observations deleted due to missingness)</span></span>
<span id="cb106-48"><a href="#cb106-48"></a><span class="co"># Multiple R-squared:  0.9943,  Adjusted R-squared:  0.9942 </span></span>
<span id="cb106-49"><a href="#cb106-49"></a><span class="co"># F-statistic: 2.092e+04 on 11 and 1328 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>The main innovation of <code>flag / L / F</code> is the ability to very efficiently compute sequences of lags and leads on panel data, and that this panel data need not be ordered:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1"></a><span class="co"># This lags all 4 series</span></span>
<span id="cb107-2"><a href="#cb107-2"></a><span class="kw">head</span>(<span class="kw">L</span>(wlddev, <span class="dv">1</span>, <span class="op">~</span>iso3c, <span class="op">~</span>year, <span class="dt">cols =</span> <span class="dv">9</span><span class="op">:</span><span class="dv">12</span>))</span>
<span id="cb107-3"><a href="#cb107-3"></a><span class="co">#   iso3c year L1.PCGDP L1.LIFEEX L1.GINI    L1.ODA</span></span>
<span id="cb107-4"><a href="#cb107-4"></a><span class="co"># 1   AFG 1960       NA        NA      NA        NA</span></span>
<span id="cb107-5"><a href="#cb107-5"></a><span class="co"># 2   AFG 1961       NA    32.292      NA 114440000</span></span>
<span id="cb107-6"><a href="#cb107-6"></a><span class="co"># 3   AFG 1962       NA    32.742      NA 233350000</span></span>
<span id="cb107-7"><a href="#cb107-7"></a><span class="co"># 4   AFG 1963       NA    33.185      NA 114880000</span></span>
<span id="cb107-8"><a href="#cb107-8"></a><span class="co"># 5   AFG 1964       NA    33.624      NA 236450000</span></span>
<span id="cb107-9"><a href="#cb107-9"></a><span class="co"># 6   AFG 1965       NA    34.060      NA 302480000</span></span>
<span id="cb107-10"><a href="#cb107-10"></a></span>
<span id="cb107-11"><a href="#cb107-11"></a><span class="co"># Without t: Works here because data is ordered, but gives a message</span></span>
<span id="cb107-12"><a href="#cb107-12"></a><span class="kw">head</span>(<span class="kw">L</span>(wlddev, <span class="dv">1</span>, <span class="op">~</span>iso3c, <span class="dt">cols =</span> <span class="dv">9</span><span class="op">:</span><span class="dv">12</span>))</span>
<span id="cb107-13"><a href="#cb107-13"></a><span class="co"># Panel-lag computed without timevar: Assuming ordered data</span></span>
<span id="cb107-14"><a href="#cb107-14"></a><span class="co">#   iso3c L1.PCGDP L1.LIFEEX L1.GINI    L1.ODA</span></span>
<span id="cb107-15"><a href="#cb107-15"></a><span class="co"># 1   AFG       NA        NA      NA        NA</span></span>
<span id="cb107-16"><a href="#cb107-16"></a><span class="co"># 2   AFG       NA    32.292      NA 114440000</span></span>
<span id="cb107-17"><a href="#cb107-17"></a><span class="co"># 3   AFG       NA    32.742      NA 233350000</span></span>
<span id="cb107-18"><a href="#cb107-18"></a><span class="co"># 4   AFG       NA    33.185      NA 114880000</span></span>
<span id="cb107-19"><a href="#cb107-19"></a><span class="co"># 5   AFG       NA    33.624      NA 236450000</span></span>
<span id="cb107-20"><a href="#cb107-20"></a><span class="co"># 6   AFG       NA    34.060      NA 302480000</span></span>
<span id="cb107-21"><a href="#cb107-21"></a></span>
<span id="cb107-22"><a href="#cb107-22"></a><span class="co"># 1 lead and 2 lags of GDP per Capita &amp; Life Expectancy</span></span>
<span id="cb107-23"><a href="#cb107-23"></a><span class="kw">head</span>(<span class="kw">L</span>(wlddev, <span class="dv">-1</span><span class="op">:</span><span class="dv">2</span>, PCGDP <span class="op">+</span><span class="st"> </span>LIFEEX <span class="op">~</span><span class="st"> </span>iso3c, <span class="op">~</span>year))</span>
<span id="cb107-24"><a href="#cb107-24"></a><span class="co">#   iso3c year F1.PCGDP PCGDP L1.PCGDP L2.PCGDP F1.LIFEEX LIFEEX L1.LIFEEX L2.LIFEEX</span></span>
<span id="cb107-25"><a href="#cb107-25"></a><span class="co"># 1   AFG 1960       NA    NA       NA       NA    32.742 32.292        NA        NA</span></span>
<span id="cb107-26"><a href="#cb107-26"></a><span class="co"># 2   AFG 1961       NA    NA       NA       NA    33.185 32.742    32.292        NA</span></span>
<span id="cb107-27"><a href="#cb107-27"></a><span class="co"># 3   AFG 1962       NA    NA       NA       NA    33.624 33.185    32.742    32.292</span></span>
<span id="cb107-28"><a href="#cb107-28"></a><span class="co"># 4   AFG 1963       NA    NA       NA       NA    34.060 33.624    33.185    32.742</span></span>
<span id="cb107-29"><a href="#cb107-29"></a><span class="co"># 5   AFG 1964       NA    NA       NA       NA    34.495 34.060    33.624    33.185</span></span>
<span id="cb107-30"><a href="#cb107-30"></a><span class="co"># 6   AFG 1965       NA    NA       NA       NA    34.928 34.495    34.060    33.624</span></span></code></pre></div>
<p>Optimal performance is obtained if the panel-id is a factor, and the time variable also a factor or an integer variable. In that case an ordering vector of the data is computed directly without any prior sorting or grouping, and the data is accessed through this vector. Thus the data need not be sorted to compute a fully-identified panel-lag, which is a key advantage to, say, the <code>shift</code> function in <code>data.table</code>.</p>
<p>One caveat of the direct computation of the ordering is that <code>flag / L / F</code> requires regularly spaced panel data, and provides errors for repeated values or gaps in time within any group:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1"></a>g &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb108-2"><a href="#cb108-2"></a><span class="kw">tryCatch</span>(<span class="kw">flag</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dv">1</span>, g, <span class="dt">t =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)),</span>
<span id="cb108-3"><a href="#cb108-3"></a>         <span class="dt">error =</span> <span class="cf">function</span>(e) e)</span>
<span id="cb108-4"><a href="#cb108-4"></a><span class="co"># &lt;Rcpp::exception in flag.default(1:6, 1, g, t = c(1, 2, 3, 1, 2, 2)): Repeated values of timevar within one or more groups&gt;</span></span>
<span id="cb108-5"><a href="#cb108-5"></a><span class="kw">tryCatch</span>(<span class="kw">flag</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dv">1</span>, g, <span class="dt">t =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>)),</span>
<span id="cb108-6"><a href="#cb108-6"></a>         <span class="dt">error =</span> <span class="cf">function</span>(e) e)</span>
<span id="cb108-7"><a href="#cb108-7"></a><span class="co"># &lt;Rcpp::exception in flag.default(1:6, 1, g, t = c(1, 2, 3, 1, 2, 4)): Gaps in timevar within one or more groups&gt;</span></span></code></pre></div>
<p>Note that all of this does not require the panel to be balanced. <code>flag / L /F</code> works for unbalanced panel data as long as there are no gaps or repeated values in the time-variable for an individual. Since this sacrifices some functionality for speed and has been a requested feature, <em>collapse</em> 1.2.0 introduced the function <code>seqid</code>, which can be used to generate an new panel-id variable which identifies consecutive time-sequences at the sub-individual level, an thus enables the use of <code>flag / L /F</code> on irregular panels.</p>
<p>One intended area of use, especially for the operators <code>L</code> and <code>F</code>, is to substantially facilitate the implementation of dynamic models in various contexts. Below different ways <code>L</code> can be used to estimate a dynamic panel-model using <code>lm</code> are shown:</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1"></a><span class="co"># Different ways of regressing GDP on it&#39;s lags and life-Expectancy and it&#39;s lags</span></span>
<span id="cb109-2"><a href="#cb109-2"></a></span>
<span id="cb109-3"><a href="#cb109-3"></a><span class="co"># 1 - Precomputing lags</span></span>
<span id="cb109-4"><a href="#cb109-4"></a><span class="kw">summary</span>(<span class="kw">lm</span>(PCGDP <span class="op">~</span><span class="st"> </span>., <span class="kw">L</span>(wlddev, <span class="dv">0</span><span class="op">:</span><span class="dv">2</span>, PCGDP <span class="op">+</span><span class="st"> </span>LIFEEX <span class="op">~</span><span class="st"> </span>iso3c, <span class="op">~</span><span class="st"> </span>year, <span class="dt">keep.ids =</span> <span class="ot">FALSE</span>)))</span>
<span id="cb109-5"><a href="#cb109-5"></a><span class="co"># </span></span>
<span id="cb109-6"><a href="#cb109-6"></a><span class="co"># Call:</span></span>
<span id="cb109-7"><a href="#cb109-7"></a><span class="co"># lm(formula = PCGDP ~ ., data = L(wlddev, 0:2, PCGDP + LIFEEX ~ </span></span>
<span id="cb109-8"><a href="#cb109-8"></a><span class="co">#     iso3c, ~year, keep.ids = FALSE))</span></span>
<span id="cb109-9"><a href="#cb109-9"></a><span class="co"># </span></span>
<span id="cb109-10"><a href="#cb109-10"></a><span class="co"># Residuals:</span></span>
<span id="cb109-11"><a href="#cb109-11"></a><span class="co">#      Min       1Q   Median       3Q      Max </span></span>
<span id="cb109-12"><a href="#cb109-12"></a><span class="co"># -16621.0   -100.0    -17.2     86.2  11935.3 </span></span>
<span id="cb109-13"><a href="#cb109-13"></a><span class="co"># </span></span>
<span id="cb109-14"><a href="#cb109-14"></a><span class="co"># Coefficients:</span></span>
<span id="cb109-15"><a href="#cb109-15"></a><span class="co">#               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb109-16"><a href="#cb109-16"></a><span class="co"># (Intercept) -321.51378   63.37246  -5.073    4e-07 ***</span></span>
<span id="cb109-17"><a href="#cb109-17"></a><span class="co"># L1.PCGDP       1.31801    0.01061 124.173   &lt;2e-16 ***</span></span>
<span id="cb109-18"><a href="#cb109-18"></a><span class="co"># L2.PCGDP      -0.31550    0.01070 -29.483   &lt;2e-16 ***</span></span>
<span id="cb109-19"><a href="#cb109-19"></a><span class="co"># LIFEEX        -1.93638   38.24878  -0.051    0.960    </span></span>
<span id="cb109-20"><a href="#cb109-20"></a><span class="co"># L1.LIFEEX     10.01163   71.20359   0.141    0.888    </span></span>
<span id="cb109-21"><a href="#cb109-21"></a><span class="co"># L2.LIFEEX     -1.66669   37.70885  -0.044    0.965    </span></span>
<span id="cb109-22"><a href="#cb109-22"></a><span class="co"># ---</span></span>
<span id="cb109-23"><a href="#cb109-23"></a><span class="co"># Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb109-24"><a href="#cb109-24"></a><span class="co"># </span></span>
<span id="cb109-25"><a href="#cb109-25"></a><span class="co"># Residual standard error: 791.3 on 7988 degrees of freedom</span></span>
<span id="cb109-26"><a href="#cb109-26"></a><span class="co">#   (4750 observations deleted due to missingness)</span></span>
<span id="cb109-27"><a href="#cb109-27"></a><span class="co"># Multiple R-squared:  0.9974,  Adjusted R-squared:  0.9974 </span></span>
<span id="cb109-28"><a href="#cb109-28"></a><span class="co"># F-statistic: 6.166e+05 on 5 and 7988 DF,  p-value: &lt; 2.2e-16</span></span>
<span id="cb109-29"><a href="#cb109-29"></a></span>
<span id="cb109-30"><a href="#cb109-30"></a><span class="co"># 2 - Ad-hoc computation in lm formula</span></span>
<span id="cb109-31"><a href="#cb109-31"></a><span class="kw">summary</span>(<span class="kw">lm</span>(PCGDP <span class="op">~</span><span class="st"> </span><span class="kw">L</span>(PCGDP,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,iso3c,year) <span class="op">+</span><span class="st"> </span><span class="kw">L</span>(LIFEEX,<span class="dv">0</span><span class="op">:</span><span class="dv">2</span>,iso3c,year), wlddev))</span>
<span id="cb109-32"><a href="#cb109-32"></a><span class="co"># </span></span>
<span id="cb109-33"><a href="#cb109-33"></a><span class="co"># Call:</span></span>
<span id="cb109-34"><a href="#cb109-34"></a><span class="co"># lm(formula = PCGDP ~ L(PCGDP, 1:2, iso3c, year) + L(LIFEEX, 0:2, </span></span>
<span id="cb109-35"><a href="#cb109-35"></a><span class="co">#     iso3c, year), data = wlddev)</span></span>
<span id="cb109-36"><a href="#cb109-36"></a><span class="co"># </span></span>
<span id="cb109-37"><a href="#cb109-37"></a><span class="co"># Residuals:</span></span>
<span id="cb109-38"><a href="#cb109-38"></a><span class="co">#      Min       1Q   Median       3Q      Max </span></span>
<span id="cb109-39"><a href="#cb109-39"></a><span class="co"># -16621.0   -100.0    -17.2     86.2  11935.3 </span></span>
<span id="cb109-40"><a href="#cb109-40"></a><span class="co"># </span></span>
<span id="cb109-41"><a href="#cb109-41"></a><span class="co"># Coefficients:</span></span>
<span id="cb109-42"><a href="#cb109-42"></a><span class="co">#                                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb109-43"><a href="#cb109-43"></a><span class="co"># (Intercept)                   -321.51378   63.37246  -5.073    4e-07 ***</span></span>
<span id="cb109-44"><a href="#cb109-44"></a><span class="co"># L(PCGDP, 1:2, iso3c, year)L1     1.31801    0.01061 124.173   &lt;2e-16 ***</span></span>
<span id="cb109-45"><a href="#cb109-45"></a><span class="co"># L(PCGDP, 1:2, iso3c, year)L2    -0.31550    0.01070 -29.483   &lt;2e-16 ***</span></span>
<span id="cb109-46"><a href="#cb109-46"></a><span class="co"># L(LIFEEX, 0:2, iso3c, year)--   -1.93638   38.24878  -0.051    0.960    </span></span>
<span id="cb109-47"><a href="#cb109-47"></a><span class="co"># L(LIFEEX, 0:2, iso3c, year)L1   10.01163   71.20359   0.141    0.888    </span></span>
<span id="cb109-48"><a href="#cb109-48"></a><span class="co"># L(LIFEEX, 0:2, iso3c, year)L2   -1.66669   37.70885  -0.044    0.965    </span></span>
<span id="cb109-49"><a href="#cb109-49"></a><span class="co"># ---</span></span>
<span id="cb109-50"><a href="#cb109-50"></a><span class="co"># Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb109-51"><a href="#cb109-51"></a><span class="co"># </span></span>
<span id="cb109-52"><a href="#cb109-52"></a><span class="co"># Residual standard error: 791.3 on 7988 degrees of freedom</span></span>
<span id="cb109-53"><a href="#cb109-53"></a><span class="co">#   (4750 observations deleted due to missingness)</span></span>
<span id="cb109-54"><a href="#cb109-54"></a><span class="co"># Multiple R-squared:  0.9974,  Adjusted R-squared:  0.9974 </span></span>
<span id="cb109-55"><a href="#cb109-55"></a><span class="co"># F-statistic: 6.166e+05 on 5 and 7988 DF,  p-value: &lt; 2.2e-16</span></span>
<span id="cb109-56"><a href="#cb109-56"></a></span>
<span id="cb109-57"><a href="#cb109-57"></a><span class="co"># 3 - Precomputing panel-identifiers</span></span>
<span id="cb109-58"><a href="#cb109-58"></a>g =<span class="st"> </span><span class="kw">qF</span>(wlddev<span class="op">$</span>iso3c, <span class="dt">na.exclude =</span> <span class="ot">FALSE</span>)</span>
<span id="cb109-59"><a href="#cb109-59"></a>t =<span class="st"> </span><span class="kw">qF</span>(wlddev<span class="op">$</span>year, <span class="dt">na.exclude =</span> <span class="ot">FALSE</span>)</span>
<span id="cb109-60"><a href="#cb109-60"></a><span class="kw">summary</span>(<span class="kw">lm</span>(PCGDP <span class="op">~</span><span class="st"> </span><span class="kw">L</span>(PCGDP,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,g,t) <span class="op">+</span><span class="st"> </span><span class="kw">L</span>(LIFEEX,<span class="dv">0</span><span class="op">:</span><span class="dv">2</span>,g,t), wlddev))</span>
<span id="cb109-61"><a href="#cb109-61"></a><span class="co"># </span></span>
<span id="cb109-62"><a href="#cb109-62"></a><span class="co"># Call:</span></span>
<span id="cb109-63"><a href="#cb109-63"></a><span class="co"># lm(formula = PCGDP ~ L(PCGDP, 1:2, g, t) + L(LIFEEX, 0:2, g, </span></span>
<span id="cb109-64"><a href="#cb109-64"></a><span class="co">#     t), data = wlddev)</span></span>
<span id="cb109-65"><a href="#cb109-65"></a><span class="co"># </span></span>
<span id="cb109-66"><a href="#cb109-66"></a><span class="co"># Residuals:</span></span>
<span id="cb109-67"><a href="#cb109-67"></a><span class="co">#      Min       1Q   Median       3Q      Max </span></span>
<span id="cb109-68"><a href="#cb109-68"></a><span class="co"># -16621.0   -100.0    -17.2     86.2  11935.3 </span></span>
<span id="cb109-69"><a href="#cb109-69"></a><span class="co"># </span></span>
<span id="cb109-70"><a href="#cb109-70"></a><span class="co"># Coefficients:</span></span>
<span id="cb109-71"><a href="#cb109-71"></a><span class="co">#                          Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb109-72"><a href="#cb109-72"></a><span class="co"># (Intercept)            -321.51378   63.37246  -5.073    4e-07 ***</span></span>
<span id="cb109-73"><a href="#cb109-73"></a><span class="co"># L(PCGDP, 1:2, g, t)L1     1.31801    0.01061 124.173   &lt;2e-16 ***</span></span>
<span id="cb109-74"><a href="#cb109-74"></a><span class="co"># L(PCGDP, 1:2, g, t)L2    -0.31550    0.01070 -29.483   &lt;2e-16 ***</span></span>
<span id="cb109-75"><a href="#cb109-75"></a><span class="co"># L(LIFEEX, 0:2, g, t)--   -1.93638   38.24878  -0.051    0.960    </span></span>
<span id="cb109-76"><a href="#cb109-76"></a><span class="co"># L(LIFEEX, 0:2, g, t)L1   10.01163   71.20359   0.141    0.888    </span></span>
<span id="cb109-77"><a href="#cb109-77"></a><span class="co"># L(LIFEEX, 0:2, g, t)L2   -1.66669   37.70885  -0.044    0.965    </span></span>
<span id="cb109-78"><a href="#cb109-78"></a><span class="co"># ---</span></span>
<span id="cb109-79"><a href="#cb109-79"></a><span class="co"># Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb109-80"><a href="#cb109-80"></a><span class="co"># </span></span>
<span id="cb109-81"><a href="#cb109-81"></a><span class="co"># Residual standard error: 791.3 on 7988 degrees of freedom</span></span>
<span id="cb109-82"><a href="#cb109-82"></a><span class="co">#   (4750 observations deleted due to missingness)</span></span>
<span id="cb109-83"><a href="#cb109-83"></a><span class="co"># Multiple R-squared:  0.9974,  Adjusted R-squared:  0.9974 </span></span>
<span id="cb109-84"><a href="#cb109-84"></a><span class="co"># F-statistic: 6.166e+05 on 5 and 7988 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
</div>
<div id="fast-differences-and-growth-rates" class="section level3">
<h3>7.4 Fast Differences and Growth Rates</h3>
<p>Similarly to <code>flag / L / F</code>, <code>fdiff / D / Dlog</code> computes sequences of suitably lagged / leaded and iterated differences, quasi-differences or (quasi-)log-differences on time series and panel data, and <code>fgrowth / G</code> computes growth rates. Using again the <code>Airpassengers</code> data, the seasonal decomposition shows significant seasonality:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1"></a><span class="kw">plot</span>(<span class="kw">stl</span>(AirPassengers, <span class="st">&quot;periodic&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /> We can actually test the statistical significance of this seasonality by jointly testing a set of monthly dummies regressed on the differenced series. Given that the seasonal fluctuations are increasing in magnitude, using growth rates for the test seems more appropriate:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1"></a>f &lt;-<span class="st"> </span><span class="kw">qF</span>(<span class="kw">cycle</span>(AirPassengers))</span>
<span id="cb111-2"><a href="#cb111-2"></a><span class="kw">fFtest</span>(<span class="kw">fgrowth</span>(AirPassengers), f)</span>
<span id="cb111-3"><a href="#cb111-3"></a><span class="co">#   R-Sq.     DF1     DF2 F-Stat. P-value </span></span>
<span id="cb111-4"><a href="#cb111-4"></a><span class="co">#   0.874      11     131  82.238   0.000</span></span></code></pre></div>
<p>The test shows significant seasonality, accounting for 87% of the variation in the growth rate of the series. We can plot the series together with the ordinary, seasonal (12-month) and deseasonalized monthly growth rate using:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1"></a><span class="kw">G</span>(AirPassengers, <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">12</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cbind</span>(<span class="dt">W.G1 =</span> <span class="kw">W</span>(<span class="kw">G</span>(AirPassengers), f)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb112-2"><a href="#cb112-2"></a><span class="st">  </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;Growth Rate of Airpassengers&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /> It is evident that taking the annualized growth rate also removes most of the periodic behavior. We can also compute second differences or growth rates of growth rates. Below we plot the ordinary and annual first and second differences of the data:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1"></a><span class="kw">plot</span>(<span class="kw">D</span>(AirPassengers, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">12</span>), <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /> In general, both <code>fdiff / D</code> and <code>fgrowth / G</code> can compute sequences of lagged / leaded and iterated differences / growth rates.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1"></a><span class="co"># sequence of leaded/lagged and iterated differences</span></span>
<span id="cb114-2"><a href="#cb114-2"></a>y =<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span></span>
<span id="cb114-3"><a href="#cb114-3"></a><span class="kw">D</span>(y, <span class="dv">-2</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</span>
<span id="cb114-4"><a href="#cb114-4"></a><span class="co">#       F2D1 F2D2 F2D3 FD1 FD2 FD3 -- D1 D2 D3 L2D1 L2D2 L2D3</span></span>
<span id="cb114-5"><a href="#cb114-5"></a><span class="co">#  [1,]   -2    0    0  -1   0   0  1 NA NA NA   NA   NA   NA</span></span>
<span id="cb114-6"><a href="#cb114-6"></a><span class="co">#  [2,]   -2    0    0  -1   0   0  2  1 NA NA   NA   NA   NA</span></span>
<span id="cb114-7"><a href="#cb114-7"></a><span class="co">#  [3,]   -2    0    0  -1   0   0  3  1  0 NA    2   NA   NA</span></span>
<span id="cb114-8"><a href="#cb114-8"></a><span class="co">#  [4,]   -2    0    0  -1   0   0  4  1  0  0    2   NA   NA</span></span>
<span id="cb114-9"><a href="#cb114-9"></a><span class="co">#  [5,]   -2    0   NA  -1   0   0  5  1  0  0    2    0   NA</span></span>
<span id="cb114-10"><a href="#cb114-10"></a><span class="co">#  [6,]   -2    0   NA  -1   0   0  6  1  0  0    2    0   NA</span></span>
<span id="cb114-11"><a href="#cb114-11"></a><span class="co">#  [7,]   -2   NA   NA  -1   0   0  7  1  0  0    2    0    0</span></span>
<span id="cb114-12"><a href="#cb114-12"></a><span class="co">#  [8,]   -2   NA   NA  -1   0  NA  8  1  0  0    2    0    0</span></span>
<span id="cb114-13"><a href="#cb114-13"></a><span class="co">#  [9,]   NA   NA   NA  -1  NA  NA  9  1  0  0    2    0    0</span></span>
<span id="cb114-14"><a href="#cb114-14"></a><span class="co"># [10,]   NA   NA   NA  NA  NA  NA 10  1  0  0    2    0    0</span></span>
<span id="cb114-15"><a href="#cb114-15"></a><span class="co"># attr(,&quot;class&quot;)</span></span>
<span id="cb114-16"><a href="#cb114-16"></a><span class="co"># [1] &quot;matrix&quot;</span></span></code></pre></div>
<p>All of this also works for panel data. The code below gives an example:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1"></a>g =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">each =</span> <span class="dv">5</span>)</span>
<span id="cb115-2"><a href="#cb115-2"></a>t =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">2</span>)</span>
<span id="cb115-3"><a href="#cb115-3"></a></span>
<span id="cb115-4"><a href="#cb115-4"></a><span class="kw">D</span>(y, <span class="dv">-2</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, g, t)</span>
<span id="cb115-5"><a href="#cb115-5"></a><span class="co">#       F2D1 F2D2 FD1 FD2 -- D1 D2 L2D1 L2D2</span></span>
<span id="cb115-6"><a href="#cb115-6"></a><span class="co">#  [1,]   -2    0  -1   0  1 NA NA   NA   NA</span></span>
<span id="cb115-7"><a href="#cb115-7"></a><span class="co">#  [2,]   -2   NA  -1   0  2  1 NA   NA   NA</span></span>
<span id="cb115-8"><a href="#cb115-8"></a><span class="co">#  [3,]   -2   NA  -1   0  3  1  0    2   NA</span></span>
<span id="cb115-9"><a href="#cb115-9"></a><span class="co">#  [4,]   NA   NA  -1  NA  4  1  0    2   NA</span></span>
<span id="cb115-10"><a href="#cb115-10"></a><span class="co">#  [5,]   NA   NA  NA  NA  5  1  0    2    0</span></span>
<span id="cb115-11"><a href="#cb115-11"></a><span class="co">#  [6,]   -2    0  -1   0  6 NA NA   NA   NA</span></span>
<span id="cb115-12"><a href="#cb115-12"></a><span class="co">#  [7,]   -2   NA  -1   0  7  1 NA   NA   NA</span></span>
<span id="cb115-13"><a href="#cb115-13"></a><span class="co">#  [8,]   -2   NA  -1   0  8  1  0    2   NA</span></span>
<span id="cb115-14"><a href="#cb115-14"></a><span class="co">#  [9,]   NA   NA  -1  NA  9  1  0    2   NA</span></span>
<span id="cb115-15"><a href="#cb115-15"></a><span class="co"># [10,]   NA   NA  NA  NA 10  1  0    2    0</span></span>
<span id="cb115-16"><a href="#cb115-16"></a><span class="co"># attr(,&quot;class&quot;)</span></span>
<span id="cb115-17"><a href="#cb115-17"></a><span class="co"># [1] &quot;matrix&quot;</span></span></code></pre></div>
<p>The attached class-attribute allows calls of <code>flag / L / F</code>, <code>fdiff / D</code> and <code>fgrowth / G</code> to be nested. In the example below, <code>L.matrix</code> is called on the right-half ob the above sequence:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1"></a><span class="kw">L</span>(<span class="kw">D</span>(y, <span class="dv">0</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, g, t), <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, g, t)</span>
<span id="cb116-2"><a href="#cb116-2"></a><span class="co">#       -- L1.-- D1 L1.D1 D2 L1.D2 L2D1 L1.L2D1 L2D2 L1.L2D2</span></span>
<span id="cb116-3"><a href="#cb116-3"></a><span class="co">#  [1,]  1    NA NA    NA NA    NA   NA      NA   NA      NA</span></span>
<span id="cb116-4"><a href="#cb116-4"></a><span class="co">#  [2,]  2     1  1    NA NA    NA   NA      NA   NA      NA</span></span>
<span id="cb116-5"><a href="#cb116-5"></a><span class="co">#  [3,]  3     2  1     1  0    NA    2      NA   NA      NA</span></span>
<span id="cb116-6"><a href="#cb116-6"></a><span class="co">#  [4,]  4     3  1     1  0     0    2       2   NA      NA</span></span>
<span id="cb116-7"><a href="#cb116-7"></a><span class="co">#  [5,]  5     4  1     1  0     0    2       2    0      NA</span></span>
<span id="cb116-8"><a href="#cb116-8"></a><span class="co">#  [6,]  6    NA NA    NA NA    NA   NA      NA   NA      NA</span></span>
<span id="cb116-9"><a href="#cb116-9"></a><span class="co">#  [7,]  7     6  1    NA NA    NA   NA      NA   NA      NA</span></span>
<span id="cb116-10"><a href="#cb116-10"></a><span class="co">#  [8,]  8     7  1     1  0    NA    2      NA   NA      NA</span></span>
<span id="cb116-11"><a href="#cb116-11"></a><span class="co">#  [9,]  9     8  1     1  0     0    2       2   NA      NA</span></span>
<span id="cb116-12"><a href="#cb116-12"></a><span class="co"># [10,] 10     9  1     1  0     0    2       2    0      NA</span></span>
<span id="cb116-13"><a href="#cb116-13"></a><span class="co"># attr(,&quot;class&quot;)</span></span>
<span id="cb116-14"><a href="#cb116-14"></a><span class="co"># [1] &quot;matrix&quot;</span></span></code></pre></div>
<!-- THIS GAVE ERROR ON CRAN Checks !! -->
<!-- If `n * diff` (or `n` in `flag / L / F`) exceeds the length of the data or the average group size in panel-computations, all of these functions will throw appropriate errors: -->
<!-- ```{r} -->
<!-- D(y, 3, 2, g, t) -->
<!-- ``` -->
<p><code>fdiff / D</code> and <code>fgrowth / G</code> also come with a data frame method, making the computation of growth-variables on datasets very easy:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1"></a><span class="kw">head</span>(<span class="kw">G</span>(GGDC10S, <span class="dv">1</span>, <span class="dv">1</span>, <span class="op">~</span><span class="st"> </span>Variable <span class="op">+</span><span class="st"> </span>Country, <span class="op">~</span><span class="st"> </span>Year, <span class="dt">cols =</span> <span class="dv">6</span><span class="op">:</span><span class="dv">10</span>))</span>
<span id="cb117-2"><a href="#cb117-2"></a><span class="co">#   Variable Country Year    G1.AGR    G1.MIN   G1.MAN    G1.PU   G1.CON</span></span>
<span id="cb117-3"><a href="#cb117-3"></a><span class="co"># 1       VA     BWA 1960        NA        NA       NA       NA       NA</span></span>
<span id="cb117-4"><a href="#cb117-4"></a><span class="co"># 2       VA     BWA 1961        NA        NA       NA       NA       NA</span></span>
<span id="cb117-5"><a href="#cb117-5"></a><span class="co"># 3       VA     BWA 1962        NA        NA       NA       NA       NA</span></span>
<span id="cb117-6"><a href="#cb117-6"></a><span class="co"># 4       VA     BWA 1963        NA        NA       NA       NA       NA</span></span>
<span id="cb117-7"><a href="#cb117-7"></a><span class="co"># 5       VA     BWA 1964        NA        NA       NA       NA       NA</span></span>
<span id="cb117-8"><a href="#cb117-8"></a><span class="co"># 6       VA     BWA 1965 -3.524492 -28.57143 38.23529 29.41176 103.9604</span></span></code></pre></div>
<!-- One could also add variables by reference using *data.table*: -->
<!-- ```{r, warning=FALSE, message=FALSE, error=FALSE} -->
<!-- head(qDT(wlddev)[, paste0("G.", names(wlddev)[9:12]) := fgrowth(.SD,1,1,iso3c,year), .SDcols = 9:12]) -->
<!-- ``` -->
<!-- When working with *data.table* it is important to realize that while collapse functions will work with *data.table* grouping using `by` or `keyby`, this is very slow because it will run a method-dispatch for every group. It is much better and more secure to utilize the functions fast internal grouping facilities, as I have done in the above example. -->
<p>The code below estimates a dynamic panel model regressing the 10-year growth rate of GDP per capita on it’s 10-year lagged level and the 10-year growth rate of life-expectancy:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1"></a><span class="kw">summary</span>(<span class="kw">lm</span>(<span class="kw">G</span>(PCGDP,<span class="dv">10</span>,<span class="dv">1</span>,iso3c,year) <span class="op">~</span></span>
<span id="cb118-2"><a href="#cb118-2"></a><span class="st">             </span><span class="kw">L</span>(PCGDP,<span class="dv">10</span>,iso3c,year) <span class="op">+</span></span>
<span id="cb118-3"><a href="#cb118-3"></a><span class="st">             </span><span class="kw">G</span>(LIFEEX,<span class="dv">10</span>,<span class="dv">1</span>,iso3c,year), <span class="dt">data =</span> wlddev))</span>
<span id="cb118-4"><a href="#cb118-4"></a><span class="co"># </span></span>
<span id="cb118-5"><a href="#cb118-5"></a><span class="co"># Call:</span></span>
<span id="cb118-6"><a href="#cb118-6"></a><span class="co"># lm(formula = G(PCGDP, 10, 1, iso3c, year) ~ L(PCGDP, 10, iso3c, </span></span>
<span id="cb118-7"><a href="#cb118-7"></a><span class="co">#     year) + G(LIFEEX, 10, 1, iso3c, year), data = wlddev)</span></span>
<span id="cb118-8"><a href="#cb118-8"></a><span class="co"># </span></span>
<span id="cb118-9"><a href="#cb118-9"></a><span class="co"># Residuals:</span></span>
<span id="cb118-10"><a href="#cb118-10"></a><span class="co">#     Min      1Q  Median      3Q     Max </span></span>
<span id="cb118-11"><a href="#cb118-11"></a><span class="co"># -104.75  -22.95   -4.39   13.21 1724.57 </span></span>
<span id="cb118-12"><a href="#cb118-12"></a><span class="co"># </span></span>
<span id="cb118-13"><a href="#cb118-13"></a><span class="co"># Coefficients:</span></span>
<span id="cb118-14"><a href="#cb118-14"></a><span class="co">#                                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb118-15"><a href="#cb118-15"></a><span class="co"># (Intercept)                    2.724e+01  1.206e+00  22.586  &lt; 2e-16 ***</span></span>
<span id="cb118-16"><a href="#cb118-16"></a><span class="co"># L(PCGDP, 10, iso3c, year)     -3.166e-04  5.512e-05  -5.743 9.72e-09 ***</span></span>
<span id="cb118-17"><a href="#cb118-17"></a><span class="co"># G(LIFEEX, 10, 1, iso3c, year)  5.166e-01  1.250e-01   4.134 3.61e-05 ***</span></span>
<span id="cb118-18"><a href="#cb118-18"></a><span class="co"># ---</span></span>
<span id="cb118-19"><a href="#cb118-19"></a><span class="co"># Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb118-20"><a href="#cb118-20"></a><span class="co"># </span></span>
<span id="cb118-21"><a href="#cb118-21"></a><span class="co"># Residual standard error: 61.08 on 6498 degrees of freedom</span></span>
<span id="cb118-22"><a href="#cb118-22"></a><span class="co">#   (6243 observations deleted due to missingness)</span></span>
<span id="cb118-23"><a href="#cb118-23"></a><span class="co"># Multiple R-squared:  0.009558,    Adjusted R-squared:  0.009253 </span></span>
<span id="cb118-24"><a href="#cb118-24"></a><span class="co"># F-statistic: 31.35 on 2 and 6498 DF,  p-value: 2.812e-14</span></span></code></pre></div>
<p>To go even a step further, the code below regresses the 10-year growth rate of GDP on the 10-year lagged levels and 10-year growth rates of GDP and life expectancy, with country and time-fixed effects projected out using <code>HDW</code>. The standard errors are unreliable without bootstrapping, but this example nicely demonstrates the potential for complex estimations brought by <em>collapse</em>.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1"></a>moddat &lt;-<span class="st"> </span><span class="kw">HDW</span>(<span class="kw">L</span>(<span class="kw">G</span>(wlddev, <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="dv">1</span>, <span class="op">~</span>iso3c, <span class="op">~</span>year, <span class="dv">9</span><span class="op">:</span><span class="dv">10</span>), <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="op">~</span>iso3c, <span class="op">~</span>year), <span class="op">~</span>iso3c <span class="op">+</span><span class="st"> </span><span class="kw">qF</span>(year))[<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">5</span>)]</span>
<span id="cb119-2"><a href="#cb119-2"></a><span class="kw">summary</span>(<span class="kw">lm</span>(HDW.L10G1.PCGDP <span class="op">~</span>. , moddat))</span>
<span id="cb119-3"><a href="#cb119-3"></a><span class="co"># </span></span>
<span id="cb119-4"><a href="#cb119-4"></a><span class="co"># Call:</span></span>
<span id="cb119-5"><a href="#cb119-5"></a><span class="co"># lm(formula = HDW.L10G1.PCGDP ~ ., data = moddat)</span></span>
<span id="cb119-6"><a href="#cb119-6"></a><span class="co"># </span></span>
<span id="cb119-7"><a href="#cb119-7"></a><span class="co"># Residuals:</span></span>
<span id="cb119-8"><a href="#cb119-8"></a><span class="co">#     Min      1Q  Median      3Q     Max </span></span>
<span id="cb119-9"><a href="#cb119-9"></a><span class="co"># -448.32  -11.07   -0.22   10.32  578.09 </span></span>
<span id="cb119-10"><a href="#cb119-10"></a><span class="co"># </span></span>
<span id="cb119-11"><a href="#cb119-11"></a><span class="co"># Coefficients:</span></span>
<span id="cb119-12"><a href="#cb119-12"></a><span class="co">#                        Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb119-13"><a href="#cb119-13"></a><span class="co"># (Intercept)           1.487e-15  4.402e-01   0.000        1    </span></span>
<span id="cb119-14"><a href="#cb119-14"></a><span class="co"># HDW.L10.PCGDP        -2.135e-03  1.263e-04 -16.902  &lt; 2e-16 ***</span></span>
<span id="cb119-15"><a href="#cb119-15"></a><span class="co"># HDW.L10.L10G1.PCGDP  -6.983e-01  9.520e-03 -73.355  &lt; 2e-16 ***</span></span>
<span id="cb119-16"><a href="#cb119-16"></a><span class="co"># HDW.L10.LIFEEX        1.495e+00  2.744e-01   5.449 5.32e-08 ***</span></span>
<span id="cb119-17"><a href="#cb119-17"></a><span class="co"># HDW.L10G1.LIFEEX      7.979e-01  1.070e-01   7.459 1.04e-13 ***</span></span>
<span id="cb119-18"><a href="#cb119-18"></a><span class="co"># HDW.L10.L10G1.LIFEEX  8.709e-01  1.034e-01   8.419  &lt; 2e-16 ***</span></span>
<span id="cb119-19"><a href="#cb119-19"></a><span class="co"># ---</span></span>
<span id="cb119-20"><a href="#cb119-20"></a><span class="co"># Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb119-21"><a href="#cb119-21"></a><span class="co"># </span></span>
<span id="cb119-22"><a href="#cb119-22"></a><span class="co"># Residual standard error: 30.04 on 4651 degrees of freedom</span></span>
<span id="cb119-23"><a href="#cb119-23"></a><span class="co"># Multiple R-squared:  0.5652,  Adjusted R-squared:  0.5647 </span></span>
<span id="cb119-24"><a href="#cb119-24"></a><span class="co"># F-statistic:  1209 on 5 and 4651 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<!-- How long did it take to run this computation? About 4 milliseconds on my laptop (2x 2.2 GHZ, 8 GB RAM), so there is plenty of room to do this with much larger data. -->
<!-- ```{r} -->
<!-- microbenchmark(HDW(L(G(wlddev, c(0, 10), 1, ~iso3c, ~year, 9:10), c(0, 10), ~iso3c, ~year), ~iso3c + qF(year))) -->
<!-- ``` -->
<p>One of the inconveniences of the above computations is that it requires declaring the panel-identifiers <code>iso3c</code> and <code>year</code> again and again for each function. A great remedy here are the <em>plm</em> classes <em>pseries</em> and <em>pdata.frame</em> which <em>collapse</em> was built to support. This shows how one could run the same regression with plm:</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1"></a>pwlddev &lt;-<span class="st"> </span>plm<span class="op">::</span><span class="kw">pdata.frame</span>(wlddev, <span class="dt">index =</span> <span class="kw">c</span>(<span class="st">&quot;iso3c&quot;</span>, <span class="st">&quot;year&quot;</span>))</span>
<span id="cb120-2"><a href="#cb120-2"></a>moddat &lt;-<span class="st"> </span><span class="kw">HDW</span>(<span class="kw">L</span>(<span class="kw">G</span>(pwlddev, <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="dv">1</span>, <span class="dv">9</span><span class="op">:</span><span class="dv">10</span>), <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>)))[<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">5</span>)]</span>
<span id="cb120-3"><a href="#cb120-3"></a><span class="kw">summary</span>(<span class="kw">lm</span>(HDW.L10G1.PCGDP <span class="op">~</span>. , moddat))</span>
<span id="cb120-4"><a href="#cb120-4"></a><span class="co"># </span></span>
<span id="cb120-5"><a href="#cb120-5"></a><span class="co"># Call:</span></span>
<span id="cb120-6"><a href="#cb120-6"></a><span class="co"># lm(formula = HDW.L10G1.PCGDP ~ ., data = moddat)</span></span>
<span id="cb120-7"><a href="#cb120-7"></a><span class="co"># </span></span>
<span id="cb120-8"><a href="#cb120-8"></a><span class="co"># Residuals:</span></span>
<span id="cb120-9"><a href="#cb120-9"></a><span class="co">#     Min      1Q  Median      3Q     Max </span></span>
<span id="cb120-10"><a href="#cb120-10"></a><span class="co"># -241.41  -13.16   -1.09   11.25  793.22 </span></span>
<span id="cb120-11"><a href="#cb120-11"></a><span class="co"># </span></span>
<span id="cb120-12"><a href="#cb120-12"></a><span class="co"># Coefficients:</span></span>
<span id="cb120-13"><a href="#cb120-13"></a><span class="co">#                        Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb120-14"><a href="#cb120-14"></a><span class="co"># (Intercept)           0.4136682  0.4932531   0.839    0.402    </span></span>
<span id="cb120-15"><a href="#cb120-15"></a><span class="co"># HDW.L10.PCGDP        -0.0020196  0.0001312 -15.392  &lt; 2e-16 ***</span></span>
<span id="cb120-16"><a href="#cb120-16"></a><span class="co"># HDW.L10.L10G1.PCGDP  -0.6908712  0.0106041 -65.151  &lt; 2e-16 ***</span></span>
<span id="cb120-17"><a href="#cb120-17"></a><span class="co"># HDW.L10.LIFEEX        1.2204125  0.2512625   4.857 1.23e-06 ***</span></span>
<span id="cb120-18"><a href="#cb120-18"></a><span class="co"># HDW.L10G1.LIFEEX      0.7711891  0.1109986   6.948 4.23e-12 ***</span></span>
<span id="cb120-19"><a href="#cb120-19"></a><span class="co"># HDW.L10.L10G1.LIFEEX  0.9303752  0.1066535   8.723  &lt; 2e-16 ***</span></span>
<span id="cb120-20"><a href="#cb120-20"></a><span class="co"># ---</span></span>
<span id="cb120-21"><a href="#cb120-21"></a><span class="co"># Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb120-22"><a href="#cb120-22"></a><span class="co"># </span></span>
<span id="cb120-23"><a href="#cb120-23"></a><span class="co"># Residual standard error: 33.62 on 4651 degrees of freedom</span></span>
<span id="cb120-24"><a href="#cb120-24"></a><span class="co">#   (8087 observations deleted due to missingness)</span></span>
<span id="cb120-25"><a href="#cb120-25"></a><span class="co"># Multiple R-squared:  0.5078,  Adjusted R-squared:  0.5073 </span></span>
<span id="cb120-26"><a href="#cb120-26"></a><span class="co"># F-statistic: 959.8 on 5 and 4651 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>To learn more about the integration of <em>collapse</em> and <em>plm</em>, consult the corresponding vignette.</p>
</div>
</div>
<div id="list-processing-and-a-panel-var-example" class="section level2">
<h2>8. List Processing and a Panel-VAR Example</h2>
<p><em>collapse</em> also provides an ensemble of list-processing functions that grew out of a necessity of working with complex nested lists of data objects. The example provided in this section is also somewhat complex, but it demonstrates the utility of these functions while also providing a nice data-transformation task.</p>
<p>When summarizing the <code>GGDC10S</code> data in section 1, it was evident that certain sectors have a high share of economic activity in almost all countries in the sample. This prompts the question of whether there exist common patterns in the interaction of these important sectors across countries. One way to empirically study this could be through a (Structural) Panel-Vector-Autoregression (PSVAR) in value added with the 6 most important sectors (excluding government): Agriculture, manufacturing, wholesale and retail trade, construction, transport and storage and finance and real estate.</p>
<p>For this we will use the <em>vars</em> package<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a>. Since <em>vars</em> natively does not support panel-VAR, we need to create the central <em>varest</em> object manually and then run the <code>SVAR</code> function to impose identification restrictions. We start with exploring and harmonizing the data: <!-- and then the `irf` and `fevd` commands which create the impulse response functions and the forecast error variance decompositions, respectively.  --></p>
<!-- # We will estimate a panel-VAR with 1 lag -->
<!-- p <- 1 -->
<!-- # This creates a data.table containing the value added of the 6 most important non-government sectors -->
<!-- data <- qDT(GGDC10S)[Variable == "VA", c("Country","Year","AGR","MAN","WRT","CON","TRA","FIRE")] -->
<!-- # Standardizing by country takes country fixed-effects and gets rid of local-currencies -->
<!-- get_vars(data, 3:8) <- STD(data, ~ Country, cols = 3:8, keep.by = FALSE) -->
<!-- # This also subtracts time fixed-effects accounting for global shocks -->
<!-- data <- na_omit(cbind(get_vars(data, 1), W(data, ~ Year, cols = 3:8))) -->
<!-- # Here we add p panel-lags to the country-scaled and time-demeaned data -->
<!-- data <- cbind(get_vars(data, -(1:2)), L(data, 1:p, ~Country, ~Year, keep.ids = FALSE)) -->
<!-- # This removes missing values generated by L from all but the first row  -->
<!-- data <- rbind(data[1:p], na_omit(data[-(1:p)])) # (vars will treat this as a single time series) -->
<!-- # adding a contant term -->
<!-- data[["const"]] <- rep(1, nrow(data)) -->
<!-- # saving the names of the 6 sectors -->
<!-- nam <- names(data)[1:6] -->
<!-- AGRmat <- sweep(AGRmat, 1, rowMeans(AGRmat, na.rm = TRUE), "-") -->
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1"></a><span class="kw">library</span>(vars)</span>
<span id="cb121-2"><a href="#cb121-2"></a><span class="co"># The 6 most important non-government sectors (see section 1)</span></span>
<span id="cb121-3"><a href="#cb121-3"></a>sec &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;AGR&quot;</span>,<span class="st">&quot;MAN&quot;</span>,<span class="st">&quot;WRT&quot;</span>,<span class="st">&quot;CON&quot;</span>,<span class="st">&quot;TRA&quot;</span>,<span class="st">&quot;FIRE&quot;</span>)</span>
<span id="cb121-4"><a href="#cb121-4"></a><span class="co"># This creates a data.frame containing the value added of the 6 most important non-government sectors</span></span>
<span id="cb121-5"><a href="#cb121-5"></a>data &lt;-<span class="st"> </span><span class="kw">na_omit</span>(<span class="kw">fsubset</span>(GGDC10S, Variable <span class="op">==</span><span class="st"> &quot;VA&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;Country&quot;</span>,<span class="st">&quot;Year&quot;</span>, sec)), <span class="dt">cols =</span> sec)</span>
<span id="cb121-6"><a href="#cb121-6"></a><span class="co"># Let&#39;s look at the log VA in agriculture across countries:</span></span>
<span id="cb121-7"><a href="#cb121-7"></a>AGRmat &lt;-<span class="st"> </span><span class="kw">log</span>(<span class="kw">psmat</span>(data, AGR <span class="op">~</span><span class="st"> </span>Country, <span class="op">~</span><span class="st"> </span>Year, <span class="dt">transpose =</span> <span class="ot">TRUE</span>))   <span class="co"># Converting to panel series matrix</span></span>
<span id="cb121-8"><a href="#cb121-8"></a><span class="kw">plot</span>(AGRmat)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /> The plot shows quite some heterogeneity both in the levels (VA is in local currency) and in trend growth rates. In the panel-VAR estimation we are only really interested in the sectoral relationships within countries. Thus we need to harmonize this sectoral data further. One way would be taking growth rates or log-differences of the data, but VAR’s are usually estimated in levels unless the data are cointegrated (and value added series do not, in general, exhibit unit-root behavior). Thus to harmonize the data further we opt for subtracting a country-sector specific cubic trend from the data in logs:</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1"></a><span class="co"># Subtracting a country specific cubic growth trend</span></span>
<span id="cb122-2"><a href="#cb122-2"></a>AGRmat &lt;-<span class="st"> </span><span class="kw">dapply</span>(AGRmat, fHDwithin, <span class="kw">poly</span>(<span class="kw">seq_row</span>(AGRmat), <span class="dv">3</span>), <span class="dt">fill =</span> <span class="ot">TRUE</span>)</span>
<span id="cb122-3"><a href="#cb122-3"></a></span>
<span id="cb122-4"><a href="#cb122-4"></a><span class="kw">plot</span>(AGRmat)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAwAAAAHgCAMAAAAlhPoXAAAAV1BMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6Ojo6OpA6kNtmAABmADpmtrZmtv+QOgCQ2/+2ZgC2/7a2///bkDrb2//b////tmb/25D//7b//9v///8eczivAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAgAElEQVR4nO2dC2PcqJKFmdlk7t2Nd5PxjjeOw///netuCSigeCOh7jrn3olbEhQF1MdDaltKQ5BgqdUOQNBKAQBItAAAJFoAABItAACJFgCARAsAQKIFACDRAgCQaAEASLQAACRaAAASLQAAiRYAgEQLAECiBQAg0QIAkGgBAEi0AAAkWgAAEi0AAIkWAIBECwBAogUAINECAJBoAQBItAAAJFoAABItAACJFgCARAsAQKIFACDRAgCQaAEASLQAACRaAAASLQAAiRYAgEQLAECiBQAg0QIAkGgBAEi0AAAkWgAAEi0AAIkWAIBECwBAogUAINECAJBoAQBItAAAJFoAABItAACJFgCARAsAQKIFACDRAgCQaAEASLQAACRaAAASLQAAiRYAgEQLAECiBQAg0QIAkGgBAEi0AAAkWgAAEi0AAIkWAIBECwBAogUAINECAJBoAQBItAAAJFoAABItAACJ1mQAFARdQqsAmGsOgvoEACDRAgCQaAEASLQAACRaAAASLQAAiRYAgEQLAECiBQAg0QIAECcx/QMAIE5i+gcAQJzE9A8AgDiJ6Z9DAfj11/eZ5qDzJKZ/DgHg48V93frPf4bNQedLTP8cMwO8q2+3H5gBHlZi+uegJdDHy5efHADtv4gDLZGY/jlsD/D6x9+YAR5XYvrnuE3wm/oGAB5VcmboA+8C/frrPwDAgwoA9Cd0+v1DAYDHFADoT7jEHDRXAKA/4RJz0FwpMR0EACBGAKA/4RJz0FwBgP6ES8xBcwUA+hMuMQfNFQDoT7jEHDSkqDcAQH/CJeagIQGAiQmXmIOGBAAmJlxiDhpR/NgLAPQnXGIOGhEAmJlwiTloRABgZsIl5qARAYCZCZeYgwbERDsA6E+4xBw0IAAwNeESc9CA4mhXcjoIAEBxuAOAgYRLzEH9UhoAzEy4xBzULwAwN+ESc1C/AMDchEvMQf0CAHMTLjEHdUvZf7xzUjoIAEgXAJiccIk5qFsAYHLCJeagbgGAyQmXmIN6pci/9KSUDgIAwgUAZidcYg7qVQoAKT0EAIQLAMxOuMQc1Cnl/aBnhfQQAJAtADA94RJzUKcAwPSES8xBnQIA0xMuMQf1SQU/yZGQHjoSgHel/vh7njlovgDAQQC8KvXt13/91B8vibeECWneqwsAHAPA65ef9xcFa/12e2H2qDnoKKnogz0Q0kOHAHAf93/96wbA+5//eFbwpvgrSTGfNAAYS6hvAHz7/Pf3/2nMANcWADhoCfRmxv0NhVFz0EECAEdtgt+22z/vyTdlC2neiwsA4DmAYNGNGACYlnCJOahdCgBoACBYAOAmACBVCkugmwCAVPl/ExoATEu4xBzUKqUBwE0AQKbCLzwDgGkJl5iDGqX8u6AAYF7CJeagNt13wABAAwA58gf83BJIRWeeWABAiuhtTxWN8QBgWsIl5qCi7mP+HttxiDOfZXQRABAiE9V095t4EAYAhhIuMfe8mtVQZPmjonMAYGLCJeaeVtPeWM0Fe2INBACGEi4x97RSs5pKZT8BgHkJl5h7VoV3K8cspT8BgHkJl5h7Vk17JMVGPQAAANfWvFAEAAkBgCuLuV85aAkABAIAFxa/Wh8zVXj6RT7K6CIAcGElBushUwDAFwC4rlKxOmJKsWc1AJiXcIm5p1QyWAdMAYBAAOCyUtnDTlsAIBAAuKzCJhr5g8L87SQAAACuK6aF+hEAACkBgKuKbaFOBPgVUAKAeQ8fHkEA4KJKNVAXAomYBgAA4LJKN1AHAl5M84/XAMCshEvMPZ2y7dPceAAgKQBwTeXbp7X16LaW/IoNAAAAV1WhfdqaL5gAAAARALikis3TtBGgIa2KT8UAwFjCJeaeTRXN09CC/gooEeJPBUC97wcB8KbU9nqwN/81qZ3mxKmmeeqakAS8/ZhfAwGAQZN6e0fex8tXDQA6VdU8dYnsmkf5/4QWngmA9tlxqk39+8f9PcE/vvwEAF2qbJ2qeULRCYCyoAsAPHAfrQbg/qb4T71++fmGN8V3aCYAdr8cLIZCA+0AXLcPVwOwzQCfev2KGaBHta1TtVemfwm0HYBMEdftw9UA2IXPx4sCAB2aCgBZ9oRBXgQgO1VfdhrvuUU81ejtLtC2CPr9AwB0aF6v3MM+uv9ZC4DSuSIAwICu2naX0MSbeIrGsaKnw+wMAIU1EAAY0FXb7hKauIRV5P+NACgmkW/6qp0IAB5cxwMQ3A71Pu+XFEdJbPqCavIKAFxQE0cwE/rhaj4NQLxlThQBAEZ0zaa7iOYDEG1nAUBrYgBwmtraJp9auYBWwQVdC0CiiPwtonWa2XzdZs8291Q6AAAVbVkBQGNqAHCaGtsmm9wBoMILGgC0pAYAp+kQAKJk/K6ABYAvAgCM6IotdxE1N00mQ3z/08uVBCCYH1L5r9iPM4ePAbsnm3smzQUgWurQXLUAcAYuDUC9WwDgcmpvmnSO3Nd5wmWRIj8AQH/CJeaeSVcEgDGhUhcWq3FrAgAup46mSWaRB0DjBAAALqeelskDkLqqGgCIjVwYgBafAMDV1NUyyRjPxcMUAK7WkwCgRVf83eTzAAgIyAMQWbkmAK3xLx2AOwPX8MVoOgC5u6QAQDQAtg+vxECfK4lcBQAGZgCVOL9YAKBFiv24Vp2OpG70lACIm8CFUCrkg6PLNN1NhfqyGSYnXGKuS/nbfIvU6wibL/4SaJwgGMrp2J+bAq4JQPMEAADYg4WaC0BpQKQBUwIg1V5XabmbmicAAJA4WqbzAfDDvR2Aq7TcTQCg34ULeKRHvOByqtJfblD8vw8MQKszACB5vERLAKBRnwEgtWm6RMPd1T4BAID08RKtASC89QMABhIuMTfFg/U+DfnAZC2uCOgtoDIAqai/QsPdVfxbRlyW2QmXmJvjwXqnHgaAS95BAwCDDix3asiDIQC0egIAOuIfAJRPnqkhB+J4LX7Fg65pKgDwZoxcyWsEAIYdWO3WQgCYv6L+cAC0x79YABLlX9Stzszl7/jFKxkAMJpwiblp5S/+YuhY4dFty0YATPCnAUhcWt2bm7xtTH2m2QmXmJtZ/MLfEBgsdxkAq7tzU88EAAAS19dQMFpkc1gGSyBVBCCxzbwSAG2+AIBMotMhWA2AVpUARHNNnX/HqmcCEApAfelKnflq4+UA+L9E/FgAdE0AxwDw8eKi5pJviewr/XCfxwuI1/Qt6c0/OQBcqrShNeqaAA6aAdJvR73Gm+IBAJdhi30FAMYS3vX7x9eZ5iart/CjnZ5gPwzouvSK3gByoxNvQHFX1gPQtwI6bA/wvr8pe5K5ueou/GCv5wJQNcu6ZQ+BQJEDPssVAfB+tGabmHCJubPKPtbtGdadjWoA7IBvl6eEiHwWV9BqAjonAABwWtazjFsr7QC4/+jKKMri/ZqN2n/v+FoANNzmm55wibnTij7S77kA1N1ooKGrgv+2DUGcRdnZQbmHr9cAoH0dJA+AwZIPdHySaRMElQCQwVzT4FeOgtC8ipdIq/+2Xu8EIA+A4YKP83yW5T1u6wCgQUz+025yCMzw08JqAnonAHEAjJd7mOfzDG9RPAqAnUP8HW90hrF0urx3oTU5IgyAufdZ5moNAFE2eo4ZUdMArN3X+VNXS87ZCZeYO7XUg3yfaFbp4l8F3RMWAIjnABVlcxdWrmud421eiAJg7i5ztmaaVXUAxO+IiWaAIKiUMc8ZW7YMUt3xLwqAaWUe4vxUo6puBcQCwOwKyL6Ay0curfo1Cutpa/GCACgWqSL1WupxZDIANZEYrloyAPgcpAHQKxigfgMArxQSCJkSk+Ge4mHE+9SfK5wLQE0c+ssdnQDAI0DRhIw58/FUBvY9f+hEfea5CZeYYwogoR/0tBfMLV/NLnxNss5GKv/ULcC+D85XrRKAOOqjjDS1OUhOn9PhIG63m35WAHz73uht9nE9v5fQ9XvXdfkPAEBn+Y4jJgFAtPBJxFpwhit5/5bp7NmufwKQAwCdDQYs+Y8c+21FfkyOf7pMT0DQDICPbxEAHdbSm3eTzrdqd6a3W54UABUfdf4iWpwl9e3f4hZahdGWORzSfQcQrkhCh5gh0/+VePIxGD0Soy1LmS04LH5WhYnxHpPPCQDX1VsrNVPAbVmjfSxvlZzkEvBOTtC2AMo71AaATay8I6ZgVxAdBhLjwVCdFQn6gWlZAAAqOtnQ8op31SMgZy6308hNCCPaAEhYtN40AWAv0EhLTAEqXPjs/7CTZqYaGe2VUK5Izp06U9MTLjGXMR5M343FJwDQ0VDao7SRkcFxj//MCEvCsRUAmiKa0lRi4qFhyrjSJu8WnsO4m6XpCZeYS9tOdVaDKbNy8hf4LFjNrsbTk7a/ZNVr000ASSPupoCfMwkAGW3ZNlWK/J5MXFpsL75YJWZ20cGE3KYnBICJf/73mqpspZYw++nhkTv8uhkfmi0G3RyQ8YctJnqxvB/i4Qe3uPRuLcdFkZS8Lwknk04HDo58EfXJAVDRmSYX6EaLyc91SPvWzi5ng/Dpn9MViYmEFbtoqAaAMBp8IBxsj9/CkjQZq/lJoKauycXV0G76+QAIOrD6tmRsqDAYq/jmhhsIWzxOzTIZ+DK2yP+JT5zpaJWUnwGiAT8cX+wqKH7sqLP+pL4dEqSJz2lCcqeeDoCgz8Lfea31QhUnbm1GH3bQbkUgcVJFA2qFJR8AfuGtzSKuAQAy4tORwY7t+6LQtlxAdbyEIpYLY0Zib7GXkstZ0nMD4IdPYgzhjARLp9y8rcIB0bdRp8Qco8KLmZuq1ikzLuaM8zfoOQC8NogmDkVnWWOX3Q9T1rhFUnYSSE3BjLGUhVSqZwPAC5awmEoC4pVPevrd0vN7hbbHDVFW5f5evw2ytNP7BbMI8Vsisu5VzRpmAAj2Eq6atsYWJXOJWXK6qYHUL/AuPdflHqMUpg6LeTpFJndfwiXmjFXaxEyL1hAQr1q5fP7YbAI040/WXeWJriZUFDu5FbNhPoxAf1rknuLtC5cQAHdMftAzZsHjs2krYZNo/xPXzKl6pbCgxXsX6PSWj/609YGES8zFRvnmNONp0pNU1Gg2ld+JrQjY3vGXyoQEbXuQBNEeqAxy3itePCgVY92M2e4GDb8H8Cc3ksIMMXSrRQryZ624OZgFHtNcyWlBuwZ3FXAxb0cQPrtfxRpdEoAgcrwDtuourKgnKlDsYsxMMMjasTcuknOPXLG9Zf0jA5ibCTRFhUQ2rZAdDqknJEaMHXspSOo1hBs7/XoFXzMldyKDJjSFpUcYFbZY1DfZpbtboHl7DgJ3RZQ9MgCkk6KJMBP+/mUvlBgMGHdV0NqeSTKc0rwRd6lR2QaPObDjtJ/GG0qVAYeEZNAWNqgD17zx3S0olPc5GKdJburuHpEEyb1Mv9rEk2ie9mjOxK8dFUzSyHxd+D80AF4MMquIKL0Kc5nu809FEen769umsWXOuKhwZ6gL1H2SNQhj34Mw9p0P9DLxh47yNuz39VMwnMelBXOFYqtvjNGIcwU7t8JQJJVl+ok0aEbGPS+1V4eSBc+bqQlPMufFEh0LaBR56eOYos7soWU6kTK1BxbtMNfGTOiEjgVnjAnbjXYdw0Sicym6YBxhfLBBQRrGzAR+eBG3ra+MI1FT7OGuSRLqnCuImKf2vNEiNQnkO98VG7ePnTmLcXZZAHIJgkazQ7QZmkw3kkHYfPLORJ1sjWzp/TAJ+pce004IXHfxY64qan4fRmkRxscoRgIvPASD+ngeuaAlnDMxo4ISlHI++5Wtk6uryRp0hu07BoFs92tNvCMVsJ/ciJWx4xyo0ckAcPdwaL+QsZTOuZpU2+87l0TFRl1QulM6jBTOIPWKb/bdYToW2eSpiPGd8j1wVYyvZUSL1trWLBzxPRDdDBZVPllI+hKtf7Ao9FrfzGrp0CAY2nx8OyRteP1Tp1MBYALVXVJ0kqT1p9fN0Bp2KVd23FsmM+0/v5t3L/3RMdX7UX8ow0SYyVYgcihOE57YXWa90CSpSZ6LVy9X/ZjPmaADim1+c2hg9AZ0rz/Z2MhV0R7X6ZIAKD6NXz0X8GYYoFe8QTZbuA3mqnUB/anJbQwSLaYEmyLoFa73giU0m4TPF7UMY3J3NnXpRHmdu4/z9D/LJjs/uj525xJ18eeUcqxNTHjX7x+bH4m3pebNqXQiOk0qr1fp0idmhawBlAlSajHY0CWHmdwwTx2zrjC2THkNGghY7jbPSBHVxuJ5yg0SezcpMwPYacHtlnTQTa0+aNv+eR0DwJv6tn14Nx/qzakoOtlL2jUKwUFrt74lXaHDdgkselebo00zA1EQAjrxWe1hwHcqncWaHIqaoTpnWxlttv31q3/anIu7jummmsKUqovYQwD4/cOG/duXn23mVPKIqZGiTcPOmVGruBHfHriJ1ZRTbl+uMN+aPZvKMUcVZg8oOlpw1+UyoV6RzlFhO77BPZM+FWUVgdid8FMfL/Ylwe/+Iij0sVgMqTuT2BvRvdsVNJFN6Qck51XcjOGAXdHwOlj2sPlDZr2mqSqLLX7d8n6SuCFrjuG6gEvqrBmASZjw3o3fdh9qlvg0FF30Ozq8JlFknPHaizZ+KSiDGX0/RR4A1HbT2IK/Y7HM+pCvL1sn7dHHrgltSt5og4uh5Xg5XLkCOmwPsE8BHXuAKCWfVLmJTpvnPLYnUh3EXnf74GARE24dguN8rzgWyZnKPr72KM7dIHbngk13qZ2mikRMNQLHAPC5CNpcSoz/rebi7DZYg6E6sYcgDRS1WbFZzSRCDbiBppi75XRNwmCBtSfSfjvkLDJ15s/lvNhzbRfJGpUk3w9nLsvy85Lt+wYEDgLgWHOusl676HDvn2uAxobXOoqSKlOeD8F03THrJzPYCFT+rkWnA9BuSWmvVE9SmgS48gcemkrbwWNc/MqJ0haESA0CjwiAt9zUdC8cxFvZDlkAmf9Ts3HD66AvjSV6HPURXVPFV+2l+N6KZ9rLQZa6YTmufXxXGNe0P0iogB6lXGDvqbV3Ph3axozW7pPKpG+U9Vf7J8IoKYfZAwJAmng/djYVmQTq4HeJXRB6M/pegDnj2tQ2vx2Egi5n4iE+z/VtcM0WS0rxFkJZ25ouGGkjulpELVsbqAY45duhQ5LpEJPBrwVnr6pgW4Y7EXY5CZFSENToGgCYDto+7/9GtXdpyk4o007eowEytNPDYEjxuo4GqYuu+h4NKPG91LbONEPSmG8j0Ri729wMYOruO6P2ZvLmXxtl4VrKxacbqYIaVzcR8cZ+8rvL+hz2b0mPBIBysapJq5N+pmkbLdK+JqHjRT5rNO4s02V+lPJ9rc3/SAa/At6MQ2wzppLhk2wMF0N7dZVf8O6ic0DRFJ57/lxijNOf9iMNZa4JXXtxfUOPfFejij7jEsiLC0XOdFkMoiaIiHBrlzJCInePxFQwavpJm5javKfLN63JQOx7Sz3xqEzEUsZxn/3QATO22xZRPiChdzEB9hyJ2LClw3bZM5CGNJlsY8VjiesIpoJ5PRoAJtrjtu4EYLPGNmJu6AyNmEjz+yQKe3dR2cVbMOJTw4EH0apWEUgNLlHxOQLcMBzEkrFl7DjTcd2Jfyo+z82GUWMYT7XXgKb6pELRUdRkjXHwmAAwc/BA/NMTdkiuj392hRtTYMd5F8Z7727/sGWFM4KPBA0Sz6IXzKRKnOfKNWAIgHcPKAbE1d0dxCs347Q1ENsMG23HltbGVYT6wI74bQw8GABx/HOnOp1woWmm4SYzpO1d7DF9q72OU3YI5m2HoecICL0l/9KYN9hw9r1kSgVjvA+bIsWEVaeH8crNz0zbgaXA1s46RLEO4pufkRoQeCwAuGDvB4DrIzcst8a/H9ZBh/q9S0dHF3OJCI1OKRLQ4Vzljo1ZFxH8cOkxY3PaPEHVwkZhJwSuOt7U5TVLZIefF1yOYIxXeY9KeigASPMGhkYngHhPoaqNkhFzGwGDUT4e6mi5JEzj8lKzgvZo1cE+oLjIcJ4pf+Jy9CulSBMEVUw7GE5OQU29UYBwn6qnnQOIfQKsa4+0RyU9HAD8mDPTBVW4nrSTGptsVNDosweEYG6IZkv0h/fwZ3I4tS6ZAzpVaAqSvRoYDCYSJsZJwqq6JIcaf8PLJOWQfm4A2LEiPYB0e9A2qSTjQbt40zTQyCeSiSMgFf/GSmIATnkUDP/eCntPrYK0isw2uz0+2rzKmZS8+3F9mIR0B+8Vl5wsYp/qCp+e8Ehz7DJ2dvxPBCAcx7gJwhu9/YAtFJi6JZMeDu2ITwZOz38/jGLI7mHtr0iYETgqI684DZkmg5PpeUQF7VmphwKAC7CWHX+tA01UhUNUdJ12HB2Agzxx9yUGu3SK/ATgneBGzChjMN67Yd3izI9I5hNDPadwWqE3ghiX0mbyiCQLn5zwOHN8/B9RfoPZmjGbXnJ3WMIsYQ+X458/yloIiy8CwE8R9p5RzkFSyRwD3tjgjxAt8R9NqXV6JAA4M4fEf/995DoCEvvIYBFUCK/4OFwBpQjya8cV6Cyp4Lw3hZQ8jO53sTOkl8bLGjdTeS6RBsAx2Y4AgMZOYs/m9V9V/OcGyZQvKnUYf1JBSAULleIcxSzuIwxYKMJIrov/jMXxxJcEoNdKYQHUuwIqWPaX09xOkfR7zQIoOFUJQCG//0HxF+6TQ6IAZlIKU2RvWzK72eygkHVgXuIrAnDMAqhpHm0BIBe/5AY99yA1Zz2IjrZgqQIgHoDV7mzBYmYaSizYubkxul9QkBgADoz/bgDKk0sqvbdl5KuWH3J9xzs6Ns4afdU0TFFa1ef6KLx/GlSbn3aq1BIXDwxA9x2ggtX9ZxVezATemINdMVevf+iFWQB4QUjNsSMx+xTLu55dFepgERjbaI9/IQAcG//3z2UICr3PZvESKPZay/hvLnXGfz0AzO+ebof5WTD3pCYzPTBJAIBv4Oj4307kH2l2AOBHTLwGTvqRNRkA0BUCTNF0UlJcAv5MyHjFZsG/oLZ/+TVRWUckvRgAarpHxmzTxUoooiSZfV28B675PkGwqZwPQCb+4wBX0VHt8LFbyy6Kynp+AFbEP9OLrUsVz1YU6F4xyiarrCg119Q2PgD8mowkrBrMYwJKKyVaZAstNd5MSXopAA6K/7LRbD9XWzHpktG9P2atDn5tBugaAJIUVwGQMp17vKW4JIkbXcktQx/U81JeCQDS1VNVs3ipyNA0VtEvv5C9Rsu3KU2hKrdKoUUm3GWaNQIgY5qL+eAo+wBM58K/sb+fG4Cj4r/KaM22rLH5w0DfD5moKVsqFx/Nnor+zC3ySu3OrJeiI/vAj3et54bRmACAb7cp2SQAihcrEKBxVQSAH6xVaZ1eXnimR4cA70TutPmj4v8RAVgc/zUJJ5miUVPIZNY+xe8xxYsksgTLOliOf99IcrWYWNlVfGX6AD0mAMsWQJUpZ7WqFzXuZDJQlc7HkU4CUPHti9onL4mv+URf/Avu8mcXV1UFd+nxAFg+AcycAkrpvEC1ccWMnu5H/nfkVPBzz5Bs1A4AtM4ZjBKSzUsyUW25HXpIABZPABOngBYAtPsllNRS3V4v7yXj5VURgKZmV8XFGEm5avhvsd7ihnlB0k2JV2V31+oCE0BN6kpzrXZSwUpWQFnDKvxIb8OyGQgoJV/jvE0P8TquTdAxM8DvH8lXxPeYC/ItnwAqklcOfq1JlGYX2MEEkDYdrP29lUoBgJ6FSP5PU7NetVyboYOWQL9/fJ1pzs+3fgKYNQXUJFLhgVKqAoDi95R1yFICALtMr/CVLbDEwML1T0sBjZ68q+/Z650V6++KGsMzM0wDIF62hIsL+iw5bz27zM9cbHgincpvPQwtZcP/8Pg/exPc+oCf9eKAVuma3sdNNgLgLWCCtXvV9yfbAShcLYqsoOgdUHc9Y/eE8D8dgEFzh00APSr4MQ2AVAwqT6y5qsG2CoDuRk9YLZs9JfyPBeD3j8Rr4vvM6ccCoH2HW0jGju8qSpYpoR+A/jZP5VQqG+Mnhf+DATDaGZM1PAU0ND773YHsr1fGJxPF5Qfj4TZPZr1C+AOAIY0SUDsBJL89VmMu9eWcMFvu6kiTt99eODH8HwuAq8V/yZcpADTchMytNnKXs7lVZeFpNeU+N/r1YwEwmvMAjRHQsEsY21Jnv5pzHQBOj379aHeBxnIeoaw34wAo5lOfK8WvB6UBGGzx2uwLol8/IADXiv8xApqCenRBlZkfctfHAajLvyb8AcC4cg4N7hFqbmK2mMtmTAIw3OI1K71l3QoAhtVNQOuYPjyfZDOmAJjQ4EV0F3YqABhXxqW5W4TRCSWbcSUA40V069EAuGD8dxPQPqIPWCvmzNwFGtVRU9cMAYAZKm0wWy8lL/ebK5Z0ZMseNHXNEACYoa64BABVVw8WAJiinjDviopunopFHdqyYzcDjtSDAXDR+O8amfuCos9cVosBWNunAGCOOkbmzlFx/mZVDeavLqP50gkCAHPU3sHd62L+EgDo02MBcNn4nx2x+Yvc75UCgD4BgEk6EQA22cUBOGLvMkUAYJZaCQAAhQvnCADMUuuNjil3BlX0oUOnAJAsAAAcnOk0tREw5844ABgVAJimtpCe9GhIBT97dA4A8+9eTREAmKemmJYHQMdW6AQBgHlaAYBJ+ggAtG+FTtAjAbC6rYpqCOrux2CJpA8BQOtW6AwBgIkqRHX1c6umio6H73kANG6FztAjAXB9FWpV+7aJtsZRzTm44k7qkKaV4BkCADNVrFX+dSzVZqLUY805bqGtrPTh+QIAU1X+y++FP9NWvsgmHwbgvP5QyYMlAgDzVXgBQvH9CK1t81gAeEWtDwMAcJQKY3yGgua2Gf3LDecCQMtaHwYA4DCVB3kAsD4MAMBxytQxe/e+vW0eCwBX2AWi4CAA3j7n9/tb8t5mvyf4kdT3B2nPb5qzAV4taLQAAAYXSURBVLClXSAKjgHg7Y+/9cfL7U2pogEoLnKkAjDj+fUkHQLA9mKA3z++/JQOQGmRw10GAGfqEAA+XraXBL9++SkdgMIgLxWAU58+Z3XgDPCp16/iASjEOHNVBACnPn3O6aA9wB72Hy9KPABMVbP3ARe0zAoA1hQa67C7QNsi6PcPH4DRN8U/pKK6AoBVhcbCc4ATFFY2+2UAKQAsfS2G05EAHPOWyEdU0NfXA2BJd1wiBgDAOVKpg9zscJYWAXAJAYCTlFz3q2S60wQAZiZ0AgBUqVufAGCpAMBpSt0By/JwigDAzIRLzD2yAMBKAYDlSu6PT/RAbncAgPXK3hU9xwG53QEA1gsALBQAWK/lAFzkoewSAYALKPvl0FMckNsdAOACAgDrBACuoHtrLPySLACYmHCJuQfX6i+IA4CJCZeYg4YkuDcAACS6NwAAJLo3AAAkujcAACS6NwAAJLo3AAAkujcAACRaAAASLQAAiRYAgEQLAECiBQAg0QIAkGgBAEi0AAAkWgAAEi0AAInWMgAg6BJaBECPDnQBpmF6oe31LsA0TC+0vd4FmIbphbbXuwDTML3Q9noXYBqmF9pe7wJMw/RC2+tdgGmYXmh7vQswDdMLba93AaZheqFtCLq8AAAkWgAAEi0AAIkWAIBECwBAogUAINECAJBoAQBItAAAJFoAABItAACJFgCARGsJAL/+/c/tx5tSf/z9+fPj5fZ3LL5+fnrfz0wzrX/9tVmebvp9//Mb34/w+m0zfJDp7cOg6d8/Pn385hmKP0wzbesx3iCBVgDw8fLnrTKvnzX59ddnP//6116l988z70P1C02/f/n5ee7rEaa3c4eYfrtZvKM13bRrmTHTv3985n1TtPrxh2mmbT3GGyTUAgA+Ib5V5uPlBvnbZ4S+3+t2q/ntzOvXeaY3i29//jPf9P3kp+VDvP66WZxvOmiZftPbGEBbNv4wzbStx3iDRDofgHf17R7xG8i3f9/2CtmaTzNt55b5pjer344wbQGYb9q1zKjpzT4xFH+YZtrWY45pT0v2ALRTPmf61//c1nxbuL4PVc83/f7n/74cZPp25vXeKfNNmyXQAQ1iPswwfW8Aayj+MM20rccc057WAbDTrL5/vNwWFK/f/NF1iuk3dV+jfD3AtDYLiyNM71u9+abthxmmbwMzM7nMN23rMcW0r3UA7Psx9d2em9bf1vTbH38fZVr73THV9G1muS2vjjC9f5hi2mxU5wPgm7b1eC4A9OvnzuZ//9ut0qfN+Nb0tlo8xPTt030rPN+0W00f4LUpY9z0+/1W5SFLoMC0rcdTLYE27bd373WbscXxTW9Hh5g2K6ApG7PA65k7Vbat/z1hp/qm/OpP3ASHpm8Hz7cJ3vT25edWq/cZ9ypD0x8vh5k2vTHl1txpDWI/DJt+29eu82+DxqZven+a26B6r4x9iLRV6HMTPOMxR2D61uf3Vptv2pqbb9rsAeabdmUMmr67txUw+0EYY9rU4zkehJnK3L4BsdXl1Tz5fxt+0B2afjdP1eebtjPxfNOvh3lN3B8y/bZ9EeQ+yEQW55u2M9l4gwTCl+Eg0QIAkGgBAEi0AAAkWgAAEi0AAIkWAIBECwBAogUAINECAJBoAQBItAAAJFoAABItAACJFgCARAsAQKIFACDRAgCQaAEASLQAACRaAAASLQAAiRYAgEQLAECiBQAg0QIAkGgBAEi0AMBibe+IVbe/2v/yfbUzAgUALiD7Lj/odAGACwgArBMAuIA2AG5v8/j11//cXmt5e7/99ja7/c+kQ0cJAFxAFID7W9L//Of+9oG3+xvtQMCRAgAXEAXgm3v/9v4a1plvxIJCAYALiALwXdt/tncB7a8ig44RALiAUgDsN0gBwIECABdQdgaADhUAuIASAHzgydjxAgAXUAKA+10g/Yp54EgBgAsoBcD9OQBuAh0qAACJFgCARAsAQKIFACDRAgCQaAEASLQAACRaAAASLQAAiRYAgEQLAECiBQAg0QIAkGgBAEi0AAAkWgAAEi0AAIkWAIBECwBAogUAINECAJBoAQBItAAAJFoAABKt/wdbV32mKHNYbQAAAABJRU5ErkJggg==" width="100%" /> This seems to have done a decent job in curbing most of the heterogeneity. Some series however have a high variance around that cubic trend. Therefore a final step is to standardize the data to bring the variances in line:</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1"></a><span class="co"># Standardizing the cubic log-detrended data</span></span>
<span id="cb123-2"><a href="#cb123-2"></a>AGRmat &lt;-<span class="st"> </span><span class="kw">fscale</span>(AGRmat)</span>
<span id="cb123-3"><a href="#cb123-3"></a><span class="kw">plot</span>(AGRmat)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
<p>Now this looks pretty good, and is about the most we can do in terms of harmonization without differencing the data. The code below applies these transformations to all sectors:</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1"></a><span class="co"># Taking logs</span></span>
<span id="cb124-2"><a href="#cb124-2"></a><span class="kw">get_vars</span>(data, <span class="dv">3</span><span class="op">:</span><span class="dv">8</span>) &lt;-<span class="st"> </span><span class="kw">dapply</span>(<span class="kw">get_vars</span>(data, <span class="dv">3</span><span class="op">:</span><span class="dv">8</span>), log)</span>
<span id="cb124-3"><a href="#cb124-3"></a><span class="co"># Iteratively projecting out country FE and cubic trends from complete cases (still very slow)</span></span>
<span id="cb124-4"><a href="#cb124-4"></a><span class="kw">get_vars</span>(data, <span class="dv">3</span><span class="op">:</span><span class="dv">8</span>) &lt;-<span class="st"> </span><span class="kw">HDW</span>(data, <span class="op">~</span><span class="st"> </span><span class="kw">qF</span>(Country)<span class="op">*</span><span class="kw">poly</span>(Year, <span class="dv">3</span>), <span class="dt">fill =</span> <span class="ot">TRUE</span>, <span class="dt">eps =</span> <span class="fl">1e-05</span>)</span>
<span id="cb124-5"><a href="#cb124-5"></a><span class="co"># Scaling</span></span>
<span id="cb124-6"><a href="#cb124-6"></a><span class="kw">get_vars</span>(data, <span class="dv">3</span><span class="op">:</span><span class="dv">8</span>) &lt;-<span class="st"> </span><span class="kw">STD</span>(data, <span class="op">~</span><span class="st"> </span>Country, <span class="dt">cols =</span> <span class="dv">3</span><span class="op">:</span><span class="dv">8</span>, <span class="dt">keep.by =</span> <span class="ot">FALSE</span>)</span>
<span id="cb124-7"><a href="#cb124-7"></a></span>
<span id="cb124-8"><a href="#cb124-8"></a><span class="co"># Check the plot</span></span>
<span id="cb124-9"><a href="#cb124-9"></a><span class="kw">plot</span>(<span class="kw">psmat</span>(data, <span class="op">~</span>Country, <span class="op">~</span>Year))</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
<p>Since the data is annual, let us estimate the Panel-VAR with one lag:</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1"></a><span class="co"># This adds one lag of all series to the data</span></span>
<span id="cb125-2"><a href="#cb125-2"></a><span class="kw">add_vars</span>(data) &lt;-<span class="st"> </span><span class="kw">L</span>(data, <span class="dv">1</span>, <span class="op">~</span><span class="st"> </span>Country, <span class="op">~</span><span class="st"> </span>Year, <span class="dt">keep.ids =</span> <span class="ot">FALSE</span>)</span>
<span id="cb125-3"><a href="#cb125-3"></a><span class="co"># This removes missing values from all but the first row and drops identifier columns (vars is made for time series without gaps)</span></span>
<span id="cb125-4"><a href="#cb125-4"></a>data &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">ss</span>(data, <span class="dv">1</span>, <span class="op">-</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)), <span class="kw">na_omit</span>(<span class="kw">ss</span>(data, <span class="dv">-1</span>, <span class="op">-</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>))))</span>
<span id="cb125-5"><a href="#cb125-5"></a><span class="kw">head</span>(data)</span>
<span id="cb125-6"><a href="#cb125-6"></a><span class="co">#   STD.HDW.AGR STD.HDW.MAN STD.HDW.WRT STD.HDW.CON STD.HDW.TRA STD.HDW.FIRE L1.STD.HDW.AGR</span></span>
<span id="cb125-7"><a href="#cb125-7"></a><span class="co"># 1  0.65713990   2.2350584    1.946383 -0.03574375   1.0877821    1.0476512             NA</span></span>
<span id="cb125-8"><a href="#cb125-8"></a><span class="co"># 2 -0.14377074   1.8693571    1.905081  1.23225754   1.0542323    0.9105626     0.65713990</span></span>
<span id="cb125-9"><a href="#cb125-9"></a><span class="co"># 3 -0.09209844  -0.8212004    1.997253 -0.01783808   0.6718473    0.6134263    -0.14377074</span></span>
<span id="cb125-10"><a href="#cb125-10"></a><span class="co"># 4 -0.25213840  -1.7830320   -1.970855 -2.68332492  -1.8475545    0.4382904    -0.09209844</span></span>
<span id="cb125-11"><a href="#cb125-11"></a><span class="co"># 5 -0.31623377  -4.2931568   -1.822211 -2.75551907  -0.7066485   -2.1982638    -0.25213840</span></span>
<span id="cb125-12"><a href="#cb125-12"></a><span class="co"># 6 -0.72691896  -1.3219388   -2.079333 -0.12148289  -1.1398215   -2.2230473    -0.31623377</span></span>
<span id="cb125-13"><a href="#cb125-13"></a><span class="co">#   L1.STD.HDW.MAN L1.STD.HDW.WRT L1.STD.HDW.CON L1.STD.HDW.TRA L1.STD.HDW.FIRE</span></span>
<span id="cb125-14"><a href="#cb125-14"></a><span class="co"># 1             NA             NA             NA             NA              NA</span></span>
<span id="cb125-15"><a href="#cb125-15"></a><span class="co"># 2      2.2350584       1.946383    -0.03574375      1.0877821       1.0476512</span></span>
<span id="cb125-16"><a href="#cb125-16"></a><span class="co"># 3      1.8693571       1.905081     1.23225754      1.0542323       0.9105626</span></span>
<span id="cb125-17"><a href="#cb125-17"></a><span class="co"># 4     -0.8212004       1.997253    -0.01783808      0.6718473       0.6134263</span></span>
<span id="cb125-18"><a href="#cb125-18"></a><span class="co"># 5     -1.7830320      -1.970855    -2.68332492     -1.8475545       0.4382904</span></span>
<span id="cb125-19"><a href="#cb125-19"></a><span class="co"># 6     -4.2931568      -1.822211    -2.75551907     -0.7066485      -2.1982638</span></span></code></pre></div>
<p>Having prepared the data, the code below estimates the panel-VAR using <code>lm</code> and creates the <em>varest</em> object:</p>
<!-- pVAR <- list(varresult = setNames(lapply(seq_len(6), function(i)    # list of 6 lm's each regressing -->
<!--                lm(as.formula(paste0(nam[i],"~ -1 + . ")),           # the sector on all lags of  -->
<!--                get_vars(data, c(i,7:length(data)))[-(1:p)])), nam), # itself and other sectors -->
<!--              datamat = data[-(1:p)], # The full data containing levels and lags of the sectors -->
<!--              y = do.call(cbind, get_vars(data, 1:6)), # Only the levels data as matrix -->
<!--              type = "const", # Specifying that a constant term was added -->
<!--              p = p, # The lag-order -->
<!--              K = 6, # The number of variables -->
<!--              obs = nrow(data)-p, # The number of non-missing obs -->
<!--              totobs = nrow(data), # The total number of obs -->
<!--              restrictions = NULL,  -->
<!--              call = quote(VAR(y = data))) -->
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1"></a><span class="co"># saving the names of the 6 sectors</span></span>
<span id="cb126-2"><a href="#cb126-2"></a>nam &lt;-<span class="st"> </span><span class="kw">names</span>(data)[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>]</span>
<span id="cb126-3"><a href="#cb126-3"></a></span>
<span id="cb126-4"><a href="#cb126-4"></a>pVAR &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">varresult =</span> <span class="kw">setNames</span>(<span class="kw">lapply</span>(<span class="kw">seq_len</span>(<span class="dv">6</span>), <span class="cf">function</span>(i)    <span class="co"># list of 6 lm&#39;s each regressing</span></span>
<span id="cb126-5"><a href="#cb126-5"></a>               <span class="kw">lm</span>(<span class="kw">as.formula</span>(<span class="kw">paste0</span>(nam[i], <span class="st">&quot;~ -1 + . &quot;</span>)),          <span class="co"># the sector on all lags of</span></span>
<span id="cb126-6"><a href="#cb126-6"></a>               <span class="kw">get_vars</span>(data, <span class="kw">c</span>(i, <span class="dv">7</span><span class="op">:</span><span class="kw">fncol</span>(data))))), nam),         <span class="co"># itself and other sectors, removing the missing first row</span></span>
<span id="cb126-7"><a href="#cb126-7"></a>             <span class="dt">datamat =</span> <span class="kw">ss</span>(data, <span class="dv">-1</span>),                                <span class="co"># The full data containing levels and lags of the sectors, removing the missing first row</span></span>
<span id="cb126-8"><a href="#cb126-8"></a>             <span class="dt">y =</span> <span class="kw">do.call</span>(cbind, <span class="kw">get_vars</span>(data, <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>)),               <span class="co"># Only the levels data as matrix</span></span>
<span id="cb126-9"><a href="#cb126-9"></a>             <span class="dt">type =</span> <span class="st">&quot;none&quot;</span>,                                         <span class="co"># No constant or tend term: We harmonized the data already</span></span>
<span id="cb126-10"><a href="#cb126-10"></a>             <span class="dt">p =</span> <span class="dv">1</span>,                                                 <span class="co"># The lag-order</span></span>
<span id="cb126-11"><a href="#cb126-11"></a>             <span class="dt">K =</span> <span class="dv">6</span>,                                                 <span class="co"># The number of variables</span></span>
<span id="cb126-12"><a href="#cb126-12"></a>             <span class="dt">obs =</span> <span class="kw">fnrow</span>(data)<span class="op">-</span><span class="dv">1</span>,                                   <span class="co"># The number of non-missing obs</span></span>
<span id="cb126-13"><a href="#cb126-13"></a>             <span class="dt">totobs =</span> <span class="kw">fnrow</span>(data),                                  <span class="co"># The total number of obs</span></span>
<span id="cb126-14"><a href="#cb126-14"></a>             <span class="dt">restrictions =</span> <span class="ot">NULL</span>,</span>
<span id="cb126-15"><a href="#cb126-15"></a>             <span class="dt">call =</span> <span class="kw">quote</span>(<span class="kw">VAR</span>(<span class="dt">y =</span> data)))</span>
<span id="cb126-16"><a href="#cb126-16"></a></span>
<span id="cb126-17"><a href="#cb126-17"></a><span class="kw">class</span>(pVAR) &lt;-<span class="st"> &quot;varest&quot;</span></span></code></pre></div>
<p>The significant serial-correlation test below suggests that the panel-VAR with one lag is ill-identified, but the sample size is also quite large so the test is prone to reject, and the test is likely also still picking up remaining cross-sectional heterogeneity. For the purposes of this vignette this shall not bother us.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1"></a><span class="kw">serial.test</span>(pVAR)</span>
<span id="cb127-2"><a href="#cb127-2"></a><span class="co"># </span></span>
<span id="cb127-3"><a href="#cb127-3"></a><span class="co">#   Portmanteau Test (asymptotic)</span></span>
<span id="cb127-4"><a href="#cb127-4"></a><span class="co"># </span></span>
<span id="cb127-5"><a href="#cb127-5"></a><span class="co"># data:  Residuals of VAR object pVAR</span></span>
<span id="cb127-6"><a href="#cb127-6"></a><span class="co"># Chi-squared = 1692.9, df = 540, p-value &lt; 2.2e-16</span></span></code></pre></div>
<p>By default the VAR is identified using a Choleski ordering of the direct impact matrix in which the first variable (here Agriculture) is assumed to not be directly impacted by any other sector in the current period, and this descends down to the last variable (Finance and Real Estate), which is assumed to be impacted by all other sectors in the current period. For structural identification it is usually necessary to impose restrictions on the direct impact matrix in line with economic theory. It is difficult to conceive theories on the average worldwide interaction of broad economic sectors, but to aid identification we will compute the correlation matrix in growth rates and restrict the lowest coefficients to be 0, which should be better than just imposing a random Choleski ordering. <!-- This will also provide room for a demonstration of the grouped tibble methods for *collapse* functions, discussed in more detail in the '*collapse* and *dplyr*' vignette: --></p>
<!-- # This computes the correlation matrix in panel growth rates of VA of the 6 sectors, removing very large positive or negative growth rates:  -->
<!-- corr <- GGDC10S %>% fsubset(Variable == "VA") %>%                           # Taking VA series -->
<!--           G(by = ~Country, t = ~Year, cols = sec) %>% {                    # Exact panel growth rates -->
<!--            STD(replace_outliers(get_vars(.,3:8), c(-100, 100)), .$Country) # Standardizing (i.e. harmonizing trend growth rates and variance, and removing some gross outliers) -->
<!--           } %>% na_omit %>% pwcor                                          # Computing correlations -->
<!-- corr -->
<!-- ```{r} -->
<!-- # This computes the average correlation in growth rates of value added of the 6 sectors in each country -->
<!-- corr <- GGDC10S %>% fsubset(Variable == "VA") %>%         # Only VA data -->
<!--               psmat(~ Country, ~ Year, cols = sec) %>%   # Convert to 3D Array -->
<!--                 apply(1, function(x) pwcor(G(x))) %>%    # For each country (dimension 1) compute pairwise correlations of the sectoral growth rates -->
<!--                    rowMeans %>%                          # Compute the mean correlation coefficient across countries -->
<!--                      structure(dim = c(6,6),             # Output as a correlation matrix, class 'pwcor' for pretty printing -->
<!--                                dimnames = list(sec, sec),  -->
<!--                                class = "pwcov")  -->
<!-- corr -->
<!-- # Another solution using data.table ... a bit more compact -->
<!-- qDT(GGDC10S)[Variable == "VA", pwcor(fgrowth(.SD)), by = Country, .SDcols = sec][, -->
<!--              coef := rowid(Country)][, mean(V1), by = coef][[2]] %>% -->
<!--              structure(dim = c(6,6), dimnames = list(sec, sec), class = "pwcor") -->
<!-- ``` -->
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1"></a><span class="co"># This computes the pairwise correlations between standardized sectoral growth rates across countries</span></span>
<span id="cb128-2"><a href="#cb128-2"></a>corr &lt;-<span class="st"> </span><span class="kw">fsubset</span>(GGDC10S, Variable <span class="op">==</span><span class="st"> &quot;VA&quot;</span>) <span class="op">%&gt;%</span><span class="st">   </span><span class="co"># Subset rows: Only VA</span></span>
<span id="cb128-3"><a href="#cb128-3"></a><span class="st">           </span><span class="kw">fgroup_by</span>(Country) <span class="op">%&gt;%</span><span class="st">                </span><span class="co"># Group by country</span></span>
<span id="cb128-4"><a href="#cb128-4"></a><span class="st">                </span><span class="kw">get_vars</span>(sec) <span class="op">%&gt;%</span><span class="st">                </span><span class="co"># Select the 6 sectors</span></span>
<span id="cb128-5"><a href="#cb128-5"></a><span class="st">                   </span>fgrowth <span class="op">%&gt;%</span><span class="st">                   </span><span class="co"># Compute Sectoral growth rates (a time-variable can be passed, but not necessary here as the data is ordered)</span></span>
<span id="cb128-6"><a href="#cb128-6"></a><span class="st">                      </span>fscale <span class="op">%&gt;%</span><span class="st">                 </span><span class="co"># Scale and center (i.e. standardize)</span></span>
<span id="cb128-7"><a href="#cb128-7"></a><span class="st">                         </span>pwcor                   <span class="co"># Compute Pairwise correlations</span></span>
<span id="cb128-8"><a href="#cb128-8"></a></span>
<span id="cb128-9"><a href="#cb128-9"></a>corr</span>
<span id="cb128-10"><a href="#cb128-10"></a><span class="co">#        AGR   MAN   WRT   CON   TRA  FIRE</span></span>
<span id="cb128-11"><a href="#cb128-11"></a><span class="co"># AGR     1    .55   .59   .39   .52   .41</span></span>
<span id="cb128-12"><a href="#cb128-12"></a><span class="co"># MAN    .55    1    .67   .54   .65   .48</span></span>
<span id="cb128-13"><a href="#cb128-13"></a><span class="co"># WRT    .59   .67    1    .56   .66   .52</span></span>
<span id="cb128-14"><a href="#cb128-14"></a><span class="co"># CON    .39   .54   .56    1    .53   .46</span></span>
<span id="cb128-15"><a href="#cb128-15"></a><span class="co"># TRA    .52   .65   .66   .53    1    .51</span></span>
<span id="cb128-16"><a href="#cb128-16"></a><span class="co"># FIRE   .41   .48   .52   .46   .51    1</span></span>
<span id="cb128-17"><a href="#cb128-17"></a></span>
<span id="cb128-18"><a href="#cb128-18"></a><span class="co"># We need to impose K*(K-1)/2 = 15 (with K = 6 variables) restrictions for identification</span></span>
<span id="cb128-19"><a href="#cb128-19"></a>corr[corr <span class="op">&lt;=</span><span class="st"> </span><span class="kw">sort</span>(corr)[<span class="dv">15</span>]] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb128-20"><a href="#cb128-20"></a>corr</span>
<span id="cb128-21"><a href="#cb128-21"></a><span class="co">#        AGR   MAN   WRT   CON   TRA  FIRE</span></span>
<span id="cb128-22"><a href="#cb128-22"></a><span class="co"># AGR     1    .55   .59   .00   .00   .00</span></span>
<span id="cb128-23"><a href="#cb128-23"></a><span class="co"># MAN    .55    1    .67   .54   .65   .00</span></span>
<span id="cb128-24"><a href="#cb128-24"></a><span class="co"># WRT    .59   .67    1    .56   .66   .00</span></span>
<span id="cb128-25"><a href="#cb128-25"></a><span class="co"># CON    .00   .54   .56    1    .00   .00</span></span>
<span id="cb128-26"><a href="#cb128-26"></a><span class="co"># TRA    .00   .65   .66   .00    1    .00</span></span>
<span id="cb128-27"><a href="#cb128-27"></a><span class="co"># FIRE   .00   .00   .00   .00   .00    1</span></span>
<span id="cb128-28"><a href="#cb128-28"></a></span>
<span id="cb128-29"><a href="#cb128-29"></a><span class="co"># The rest is unknown (i.e. will be estimated)</span></span>
<span id="cb128-30"><a href="#cb128-30"></a>corr[corr <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>corr <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb128-31"><a href="#cb128-31"></a></span>
<span id="cb128-32"><a href="#cb128-32"></a><span class="co"># Using a diagonal shock vcov matrix (standard assumption for SVAR)</span></span>
<span id="cb128-33"><a href="#cb128-33"></a>Bmat &lt;-<span class="st"> </span><span class="kw">diag</span>(<span class="dv">6</span>)</span>
<span id="cb128-34"><a href="#cb128-34"></a><span class="kw">diag</span>(Bmat) &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb128-35"><a href="#cb128-35"></a></span>
<span id="cb128-36"><a href="#cb128-36"></a></span>
<span id="cb128-37"><a href="#cb128-37"></a><span class="co"># This estimates the Panel-SVAR using Maximum Likelihood:</span></span>
<span id="cb128-38"><a href="#cb128-38"></a>pSVAR &lt;-<span class="st"> </span><span class="kw">SVAR</span>(pVAR, <span class="dt">Amat =</span> <span class="kw">unclass</span>(corr), <span class="dt">Bmat =</span> Bmat, <span class="dt">estmethod =</span> <span class="st">&quot;direct&quot;</span>)</span>
<span id="cb128-39"><a href="#cb128-39"></a>pSVAR</span>
<span id="cb128-40"><a href="#cb128-40"></a><span class="co"># </span></span>
<span id="cb128-41"><a href="#cb128-41"></a><span class="co"># SVAR Estimation Results:</span></span>
<span id="cb128-42"><a href="#cb128-42"></a><span class="co"># ======================== </span></span>
<span id="cb128-43"><a href="#cb128-43"></a><span class="co"># </span></span>
<span id="cb128-44"><a href="#cb128-44"></a><span class="co"># </span></span>
<span id="cb128-45"><a href="#cb128-45"></a><span class="co"># Estimated A matrix:</span></span>
<span id="cb128-46"><a href="#cb128-46"></a><span class="co">#              STD.HDW.AGR STD.HDW.MAN STD.HDW.WRT STD.HDW.CON STD.HDW.TRA STD.HDW.FIRE</span></span>
<span id="cb128-47"><a href="#cb128-47"></a><span class="co"># STD.HDW.AGR       1.0000    -0.59223     0.51301      0.0000     0.00000            0</span></span>
<span id="cb128-48"><a href="#cb128-48"></a><span class="co"># STD.HDW.MAN      -0.3924     1.00000    -0.07819     -0.0135     0.14207            0</span></span>
<span id="cb128-49"><a href="#cb128-49"></a><span class="co"># STD.HDW.WRT      -0.2547    -0.56875     1.00000     -0.1711    -0.01391            0</span></span>
<span id="cb128-50"><a href="#cb128-50"></a><span class="co"># STD.HDW.CON       0.0000     0.02595    -0.18541      1.0000     0.00000            0</span></span>
<span id="cb128-51"><a href="#cb128-51"></a><span class="co"># STD.HDW.TRA       0.0000    -0.03321    -0.05370      0.0000     1.00000            0</span></span>
<span id="cb128-52"><a href="#cb128-52"></a><span class="co"># STD.HDW.FIRE      0.0000     0.00000     0.00000      0.0000     0.00000            1</span></span>
<span id="cb128-53"><a href="#cb128-53"></a><span class="co"># </span></span>
<span id="cb128-54"><a href="#cb128-54"></a><span class="co"># Estimated B matrix:</span></span>
<span id="cb128-55"><a href="#cb128-55"></a><span class="co">#              STD.HDW.AGR STD.HDW.MAN STD.HDW.WRT STD.HDW.CON STD.HDW.TRA STD.HDW.FIRE</span></span>
<span id="cb128-56"><a href="#cb128-56"></a><span class="co"># STD.HDW.AGR        0.678      0.0000      0.0000      0.0000      0.0000       0.0000</span></span>
<span id="cb128-57"><a href="#cb128-57"></a><span class="co"># STD.HDW.MAN        0.000      0.6248      0.0000      0.0000      0.0000       0.0000</span></span>
<span id="cb128-58"><a href="#cb128-58"></a><span class="co"># STD.HDW.WRT        0.000      0.0000      0.4155      0.0000      0.0000       0.0000</span></span>
<span id="cb128-59"><a href="#cb128-59"></a><span class="co"># STD.HDW.CON        0.000      0.0000      0.0000      0.5028      0.0000       0.0000</span></span>
<span id="cb128-60"><a href="#cb128-60"></a><span class="co"># STD.HDW.TRA        0.000      0.0000      0.0000      0.0000      0.5593       0.0000</span></span>
<span id="cb128-61"><a href="#cb128-61"></a><span class="co"># STD.HDW.FIRE       0.000      0.0000      0.0000      0.0000      0.0000       0.6475</span></span></code></pre></div>
<p>Now this object is quite involved, which brings us to the actual subject of this section:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1"></a><span class="co"># psVAR$var$varresult is a list containing the 6 linear models fitted above, it is not displayed in full here.</span></span>
<span id="cb129-2"><a href="#cb129-2"></a><span class="kw">str</span>(pSVAR, <span class="dt">give.attr =</span> <span class="ot">FALSE</span>, <span class="dt">max.level =</span> <span class="dv">3</span>)</span>
<span id="cb129-3"><a href="#cb129-3"></a><span class="co"># List of 13</span></span>
<span id="cb129-4"><a href="#cb129-4"></a><span class="co">#  $ A      : num [1:6, 1:6] 1 -0.392 -0.255 0 0 ...</span></span>
<span id="cb129-5"><a href="#cb129-5"></a><span class="co">#  $ Ase    : num [1:6, 1:6] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span id="cb129-6"><a href="#cb129-6"></a><span class="co">#  $ B      : num [1:6, 1:6] 0.678 0 0 0 0 ...</span></span>
<span id="cb129-7"><a href="#cb129-7"></a><span class="co">#  $ Bse    : num [1:6, 1:6] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span id="cb129-8"><a href="#cb129-8"></a><span class="co">#  $ LRIM   : NULL</span></span>
<span id="cb129-9"><a href="#cb129-9"></a><span class="co">#  $ Sigma.U: num [1:6, 1:6] 53.217 34.47 24.78 1.63 0.918 ...</span></span>
<span id="cb129-10"><a href="#cb129-10"></a><span class="co">#  $ LR     :List of 5</span></span>
<span id="cb129-11"><a href="#cb129-11"></a><span class="co">#   ..$ statistic: Named num 1653</span></span>
<span id="cb129-12"><a href="#cb129-12"></a><span class="co">#   ..$ parameter: Named num 1</span></span>
<span id="cb129-13"><a href="#cb129-13"></a><span class="co">#   ..$ p.value  : Named num 0</span></span>
<span id="cb129-14"><a href="#cb129-14"></a><span class="co">#   ..$ method   : chr &quot;LR overidentification&quot;</span></span>
<span id="cb129-15"><a href="#cb129-15"></a><span class="co">#   ..$ data.name: symbol data</span></span>
<span id="cb129-16"><a href="#cb129-16"></a><span class="co">#  $ opt    :List of 5</span></span>
<span id="cb129-17"><a href="#cb129-17"></a><span class="co">#   ..$ par        : num [1:20] -0.3924 -0.2547 -0.5922 -0.5688 0.0259 ...</span></span>
<span id="cb129-18"><a href="#cb129-18"></a><span class="co">#   ..$ value      : num 11030</span></span>
<span id="cb129-19"><a href="#cb129-19"></a><span class="co">#   ..$ counts     : Named int [1:2] 501 NA</span></span>
<span id="cb129-20"><a href="#cb129-20"></a><span class="co">#   ..$ convergence: int 1</span></span>
<span id="cb129-21"><a href="#cb129-21"></a><span class="co">#   ..$ message    : NULL</span></span>
<span id="cb129-22"><a href="#cb129-22"></a><span class="co">#  $ start  : num [1:20] 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 ...</span></span>
<span id="cb129-23"><a href="#cb129-23"></a><span class="co">#  $ type   : chr &quot;AB-model&quot;</span></span>
<span id="cb129-24"><a href="#cb129-24"></a><span class="co">#  $ var    :List of 10</span></span>
<span id="cb129-25"><a href="#cb129-25"></a><span class="co">#   ..$ varresult   :List of 6</span></span>
<span id="cb129-26"><a href="#cb129-26"></a><span class="co">#   .. ..$ STD.HDW.AGR :List of 13</span></span>
<span id="cb129-27"><a href="#cb129-27"></a><span class="co">#   .. ..$ STD.HDW.MAN :List of 13</span></span>
<span id="cb129-28"><a href="#cb129-28"></a><span class="co">#   .. ..$ STD.HDW.WRT :List of 13</span></span>
<span id="cb129-29"><a href="#cb129-29"></a><span class="co">#   .. ..$ STD.HDW.CON :List of 13</span></span>
<span id="cb129-30"><a href="#cb129-30"></a><span class="co">#   .. ..$ STD.HDW.TRA :List of 13</span></span>
<span id="cb129-31"><a href="#cb129-31"></a><span class="co">#   .. ..$ STD.HDW.FIRE:List of 13</span></span>
<span id="cb129-32"><a href="#cb129-32"></a><span class="co">#   ..$ datamat     :&#39;data.frame&#39;:  2060 obs. of  12 variables:</span></span>
<span id="cb129-33"><a href="#cb129-33"></a><span class="co">#   .. ..$ STD.HDW.AGR    : num [1:2060] -0.1438 -0.0921 -0.2521 -0.3162 -0.7269 ...</span></span>
<span id="cb129-34"><a href="#cb129-34"></a><span class="co">#   .. ..$ STD.HDW.MAN    : num [1:2060] 1.869 -0.821 -1.783 -4.293 -1.322 ...</span></span>
<span id="cb129-35"><a href="#cb129-35"></a><span class="co">#   .. ..$ STD.HDW.WRT    : num [1:2060] 1.91 2 -1.97 -1.82 -2.08 ...</span></span>
<span id="cb129-36"><a href="#cb129-36"></a><span class="co">#   .. ..$ STD.HDW.CON    : num [1:2060] 1.2323 -0.0178 -2.6833 -2.7555 -0.1215 ...</span></span>
<span id="cb129-37"><a href="#cb129-37"></a><span class="co">#   .. ..$ STD.HDW.TRA    : num [1:2060] 1.054 0.672 -1.848 -0.707 -1.14 ...</span></span>
<span id="cb129-38"><a href="#cb129-38"></a><span class="co">#   .. ..$ STD.HDW.FIRE   : num [1:2060] 0.911 0.613 0.438 -2.198 -2.223 ...</span></span>
<span id="cb129-39"><a href="#cb129-39"></a><span class="co">#   .. ..$ L1.STD.HDW.AGR : num [1:2060] 0.6571 -0.1438 -0.0921 -0.2521 -0.3162 ...</span></span>
<span id="cb129-40"><a href="#cb129-40"></a><span class="co">#   .. ..$ L1.STD.HDW.MAN : num [1:2060] 2.235 1.869 -0.821 -1.783 -4.293 ...</span></span>
<span id="cb129-41"><a href="#cb129-41"></a><span class="co">#   .. ..$ L1.STD.HDW.WRT : num [1:2060] 1.95 1.91 2 -1.97 -1.82 ...</span></span>
<span id="cb129-42"><a href="#cb129-42"></a><span class="co">#   .. ..$ L1.STD.HDW.CON : num [1:2060] -0.0357 1.2323 -0.0178 -2.6833 -2.7555 ...</span></span>
<span id="cb129-43"><a href="#cb129-43"></a><span class="co">#   .. ..$ L1.STD.HDW.TRA : num [1:2060] 1.088 1.054 0.672 -1.848 -0.707 ...</span></span>
<span id="cb129-44"><a href="#cb129-44"></a><span class="co">#   .. ..$ L1.STD.HDW.FIRE: num [1:2060] 1.048 0.911 0.613 0.438 -2.198 ...</span></span>
<span id="cb129-45"><a href="#cb129-45"></a><span class="co">#   ..$ y           : num [1:2061, 1:6] 0.6571 -0.1438 -0.0921 -0.2521 -0.3162 ...</span></span>
<span id="cb129-46"><a href="#cb129-46"></a><span class="co">#   ..$ type        : chr &quot;none&quot;</span></span>
<span id="cb129-47"><a href="#cb129-47"></a><span class="co">#   ..$ p           : num 1</span></span>
<span id="cb129-48"><a href="#cb129-48"></a><span class="co">#   ..$ K           : num 6</span></span>
<span id="cb129-49"><a href="#cb129-49"></a><span class="co">#   ..$ obs         : num 2060</span></span>
<span id="cb129-50"><a href="#cb129-50"></a><span class="co">#   ..$ totobs      : int 2061</span></span>
<span id="cb129-51"><a href="#cb129-51"></a><span class="co">#   ..$ restrictions: NULL</span></span>
<span id="cb129-52"><a href="#cb129-52"></a><span class="co">#   ..$ call        : language VAR(y = data)</span></span>
<span id="cb129-53"><a href="#cb129-53"></a><span class="co">#  $ iter   : Named int 501</span></span>
<span id="cb129-54"><a href="#cb129-54"></a><span class="co">#  $ call   : language SVAR(x = pVAR, estmethod = &quot;direct&quot;, Amat = unclass(corr), Bmat = Bmat)</span></span></code></pre></div>
<div id="list-search-and-identification" class="section level3">
<h3>8.1 List Search and Identification</h3>
<p>When dealing with such a list-like object, we might be interested in its complexity by measuring the level of nesting. This can be done with <code>ldepth</code>:</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1"></a><span class="co"># The list-tree of this object has 5 levels of nesting</span></span>
<span id="cb130-2"><a href="#cb130-2"></a><span class="kw">ldepth</span>(pSVAR)</span>
<span id="cb130-3"><a href="#cb130-3"></a><span class="co"># [1] 5</span></span>
<span id="cb130-4"><a href="#cb130-4"></a></span>
<span id="cb130-5"><a href="#cb130-5"></a><span class="co"># This data has a depth of 1, thus this dataset does not contain list-columns</span></span>
<span id="cb130-6"><a href="#cb130-6"></a><span class="kw">ldepth</span>(data)</span>
<span id="cb130-7"><a href="#cb130-7"></a><span class="co"># [1] 1</span></span></code></pre></div>
<p>Further we might be interested in knowing whether this list-object contains non-atomic elements like call, terms or formulas. The function <code>is.regular</code> in the <em>collapse</em> package checks if an object is atomic or list-like, and the recursive version <code>is.unlistable</code> checks whether all objects in a nested structure are atomic or list-like:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1"></a><span class="co"># Is this object composed only of atomic elements e.g. can it be unlisted?</span></span>
<span id="cb131-2"><a href="#cb131-2"></a><span class="kw">is.unlistable</span>(pSVAR)</span>
<span id="cb131-3"><a href="#cb131-3"></a><span class="co"># [1] FALSE</span></span></code></pre></div>
<p>Evidently this object is not unlistable, from viewing its structure we know that it contains several call and terms objects. We might also want to know if this object saves some kind of residuals or fitted values. This can be done using <code>has_elem</code>, which also supports regular expression search of element names:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1"></a><span class="co"># Does this object contain an element with &quot;fitted&quot; in its name?</span></span>
<span id="cb132-2"><a href="#cb132-2"></a><span class="kw">has_elem</span>(pSVAR, <span class="st">&quot;fitted&quot;</span>, <span class="dt">regex =</span> <span class="ot">TRUE</span>)</span>
<span id="cb132-3"><a href="#cb132-3"></a><span class="co"># [1] TRUE</span></span>
<span id="cb132-4"><a href="#cb132-4"></a></span>
<span id="cb132-5"><a href="#cb132-5"></a><span class="co"># Does this object contain an element with &quot;residuals&quot; in its name?</span></span>
<span id="cb132-6"><a href="#cb132-6"></a><span class="kw">has_elem</span>(pSVAR, <span class="st">&quot;residuals&quot;</span>, <span class="dt">regex =</span> <span class="ot">TRUE</span>)</span>
<span id="cb132-7"><a href="#cb132-7"></a><span class="co"># [1] TRUE</span></span></code></pre></div>
<p>We might also want to know whether the object contains some kind of data-matrix. This can be checked by calling:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1"></a><span class="co"># Is there a matrix stored in this object?</span></span>
<span id="cb133-2"><a href="#cb133-2"></a><span class="kw">has_elem</span>(pSVAR, is.matrix)</span>
<span id="cb133-3"><a href="#cb133-3"></a><span class="co"># [1] TRUE</span></span></code></pre></div>
<p>These functions can sometimes be helpful in exploring objects. A much greater advantage of having functions to search and check lists is the ability to write more complex programs with them (which will not be demonstrated here).</p>
</div>
<div id="list-subsetting" class="section level3">
<h3>8.2 List Subsetting</h3>
<p>Having gathered some information about the <code>pSVAR</code> object, this section introduces several extractor functions to pull out elements from such lists: <code>get_elem</code> can be used to pull out elements from lists in a simplified format<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a>.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1"></a><span class="co"># This is the path to the residuals from a single equation</span></span>
<span id="cb134-2"><a href="#cb134-2"></a><span class="kw">str</span>(pSVAR<span class="op">$</span>var<span class="op">$</span>varresult<span class="op">$</span>STD.HDW.AGR<span class="op">$</span>residuals)</span>
<span id="cb134-3"><a href="#cb134-3"></a><span class="co">#  Named num [1:2060] -0.7128 -0.1889 -0.2124 0.0683 -0.1651 ...</span></span>
<span id="cb134-4"><a href="#cb134-4"></a><span class="co">#  - attr(*, &quot;names&quot;)= chr [1:2060] &quot;2&quot; &quot;3&quot; &quot;4&quot; &quot;5&quot; ...</span></span>
<span id="cb134-5"><a href="#cb134-5"></a></span>
<span id="cb134-6"><a href="#cb134-6"></a><span class="co"># get_elem gets the residuals from all 6 equations and puts them in a top-level list</span></span>
<span id="cb134-7"><a href="#cb134-7"></a>resid &lt;-<span class="st"> </span><span class="kw">get_elem</span>(pSVAR, <span class="st">&quot;residuals&quot;</span>)</span>
<span id="cb134-8"><a href="#cb134-8"></a><span class="kw">str</span>(resid, <span class="dt">give.attr =</span> <span class="ot">FALSE</span>)</span>
<span id="cb134-9"><a href="#cb134-9"></a><span class="co"># List of 6</span></span>
<span id="cb134-10"><a href="#cb134-10"></a><span class="co">#  $ STD.HDW.AGR : Named num [1:2060] -0.7128 -0.1889 -0.2124 0.0683 -0.1651 ...</span></span>
<span id="cb134-11"><a href="#cb134-11"></a><span class="co">#  $ STD.HDW.MAN : Named num [1:2060] 0.356 -1.989 -1.157 -3.085 1.482 ...</span></span>
<span id="cb134-12"><a href="#cb134-12"></a><span class="co">#  $ STD.HDW.WRT : Named num [1:2060] 0.382 0.637 -3.07 -0.413 -0.415 ...</span></span>
<span id="cb134-13"><a href="#cb134-13"></a><span class="co">#  $ STD.HDW.CON : Named num [1:2060] 1.048 -1.08 -2.645 -0.618 2.263 ...</span></span>
<span id="cb134-14"><a href="#cb134-14"></a><span class="co">#  $ STD.HDW.TRA : Named num [1:2060] 0.161 -0.247 -2.261 0.855 -0.137 ...</span></span>
<span id="cb134-15"><a href="#cb134-15"></a><span class="co">#  $ STD.HDW.FIRE: Named num [1:2060] -0.1027 -0.3192 0.0916 -2.1095 -0.0533 ...</span></span>
<span id="cb134-16"><a href="#cb134-16"></a></span>
<span id="cb134-17"><a href="#cb134-17"></a><span class="co"># Quick conversion to matrix and plotting</span></span>
<span id="cb134-18"><a href="#cb134-18"></a><span class="kw">plot.ts</span>(<span class="kw">qM</span>(resid), <span class="dt">main =</span> <span class="st">&quot;Panel-VAR Residuals&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /> Similarly, we could pull out and plot the fitted values:</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1"></a><span class="co"># Regular expression search and retrieval of fitted values</span></span>
<span id="cb135-2"><a href="#cb135-2"></a><span class="kw">plot.ts</span>(<span class="kw">qM</span>(<span class="kw">get_elem</span>(pSVAR, <span class="st">&quot;^fi&quot;</span>, <span class="dt">regex =</span> <span class="ot">TRUE</span>)), <span class="dt">main =</span> <span class="st">&quot;Panel-VAR Fitted Values&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /> Below the main quantities of interest in SVAR analysis are computed: The impulse response functions (IRF’s) and forecast error variance decompositions (FEVD’s):</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1"></a><span class="co"># This computes orthogonalized impulse response functions</span></span>
<span id="cb136-2"><a href="#cb136-2"></a>pIRF &lt;-<span class="st"> </span><span class="kw">irf</span>(pSVAR)</span>
<span id="cb136-3"><a href="#cb136-3"></a><span class="co"># This computes the forecast error variance decompositions</span></span>
<span id="cb136-4"><a href="#cb136-4"></a>pFEVD &lt;-<span class="st"> </span><span class="kw">fevd</span>(pSVAR)</span></code></pre></div>
<p>The <code>pIRF</code> object contains the IRF’s with lower and upper confidence bounds and some atomic elements providing information about the object:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1"></a><span class="co"># See the structure of a vars IRF object:</span></span>
<span id="cb137-2"><a href="#cb137-2"></a><span class="kw">str</span>(pIRF, <span class="dt">give.attr =</span> <span class="ot">FALSE</span>)</span>
<span id="cb137-3"><a href="#cb137-3"></a><span class="co"># List of 11</span></span>
<span id="cb137-4"><a href="#cb137-4"></a><span class="co">#  $ irf       :List of 6</span></span>
<span id="cb137-5"><a href="#cb137-5"></a><span class="co">#   ..$ STD.HDW.AGR : num [1:11, 1:6] 0.671 0.44 0.297 0.208 0.15 ...</span></span>
<span id="cb137-6"><a href="#cb137-6"></a><span class="co">#   ..$ STD.HDW.MAN : num [1:11, 1:6] 0.1882 0.1567 0.1327 0.1124 0.0946 ...</span></span>
<span id="cb137-7"><a href="#cb137-7"></a><span class="co">#   ..$ STD.HDW.WRT : num [1:11, 1:6] -0.2087 -0.1262 -0.0779 -0.0495 -0.0326 ...</span></span>
<span id="cb137-8"><a href="#cb137-8"></a><span class="co">#   ..$ STD.HDW.CON : num [1:11, 1:6] -0.04118 -0.00495 0.0133 0.02114 0.0232 ...</span></span>
<span id="cb137-9"><a href="#cb137-9"></a><span class="co">#   ..$ STD.HDW.TRA : num [1:11, 1:6] -0.02784 -0.01117 -0.00516 -0.00343 -0.00314 ...</span></span>
<span id="cb137-10"><a href="#cb137-10"></a><span class="co">#   ..$ STD.HDW.FIRE: num [1:11, 1:6] 0 0.0144 0.0175 0.0158 0.0127 ...</span></span>
<span id="cb137-11"><a href="#cb137-11"></a><span class="co">#  $ Lower     :List of 6</span></span>
<span id="cb137-12"><a href="#cb137-12"></a><span class="co">#   ..$ STD.HDW.AGR : num [1:11, 1:6] 0.3181 0.166 0.1068 0.0551 0.0211 ...</span></span>
<span id="cb137-13"><a href="#cb137-13"></a><span class="co">#   ..$ STD.HDW.MAN : num [1:11, 1:6] -0.728 -0.416 -0.2273 -0.1211 -0.0584 ...</span></span>
<span id="cb137-14"><a href="#cb137-14"></a><span class="co">#   ..$ STD.HDW.WRT : num [1:11, 1:6] -0.886 -0.504 -0.318 -0.224 -0.182 ...</span></span>
<span id="cb137-15"><a href="#cb137-15"></a><span class="co">#   ..$ STD.HDW.CON : num [1:11, 1:6] -0.8216 -0.4761 -0.2516 -0.1476 -0.0951 ...</span></span>
<span id="cb137-16"><a href="#cb137-16"></a><span class="co">#   ..$ STD.HDW.TRA : num [1:11, 1:6] -0.448 -0.29 -0.192 -0.132 -0.102 ...</span></span>
<span id="cb137-17"><a href="#cb137-17"></a><span class="co">#   ..$ STD.HDW.FIRE: num [1:11, 1:6] 0 -0.0125 -0.0178 -0.0189 -0.0179 ...</span></span>
<span id="cb137-18"><a href="#cb137-18"></a><span class="co">#  $ Upper     :List of 6</span></span>
<span id="cb137-19"><a href="#cb137-19"></a><span class="co">#   ..$ STD.HDW.AGR : num [1:11, 1:6] 1.556 0.921 0.543 0.351 0.233 ...</span></span>
<span id="cb137-20"><a href="#cb137-20"></a><span class="co">#   ..$ STD.HDW.MAN : num [1:11, 1:6] 0.996 0.687 0.475 0.356 0.283 ...</span></span>
<span id="cb137-21"><a href="#cb137-21"></a><span class="co">#   ..$ STD.HDW.WRT : num [1:11, 1:6] 0.767 0.477 0.321 0.207 0.149 ...</span></span>
<span id="cb137-22"><a href="#cb137-22"></a><span class="co">#   ..$ STD.HDW.CON : num [1:11, 1:6] 0.617 0.44 0.334 0.25 0.193 ...</span></span>
<span id="cb137-23"><a href="#cb137-23"></a><span class="co">#   ..$ STD.HDW.TRA : num [1:11, 1:6] 0.357 0.248 0.179 0.139 0.107 ...</span></span>
<span id="cb137-24"><a href="#cb137-24"></a><span class="co">#   ..$ STD.HDW.FIRE: num [1:11, 1:6] 0 0.0387 0.0497 0.0482 0.0422 ...</span></span>
<span id="cb137-25"><a href="#cb137-25"></a><span class="co">#  $ response  : chr [1:6] &quot;STD.HDW.AGR&quot; &quot;STD.HDW.MAN&quot; &quot;STD.HDW.WRT&quot; &quot;STD.HDW.CON&quot; ...</span></span>
<span id="cb137-26"><a href="#cb137-26"></a><span class="co">#  $ impulse   : chr [1:6] &quot;STD.HDW.AGR&quot; &quot;STD.HDW.MAN&quot; &quot;STD.HDW.WRT&quot; &quot;STD.HDW.CON&quot; ...</span></span>
<span id="cb137-27"><a href="#cb137-27"></a><span class="co">#  $ ortho     : logi TRUE</span></span>
<span id="cb137-28"><a href="#cb137-28"></a><span class="co">#  $ cumulative: logi FALSE</span></span>
<span id="cb137-29"><a href="#cb137-29"></a><span class="co">#  $ runs      : num 100</span></span>
<span id="cb137-30"><a href="#cb137-30"></a><span class="co">#  $ ci        : num 0.05</span></span>
<span id="cb137-31"><a href="#cb137-31"></a><span class="co">#  $ boot      : logi TRUE</span></span>
<span id="cb137-32"><a href="#cb137-32"></a><span class="co">#  $ model     : chr &quot;svarest&quot;</span></span></code></pre></div>
<p>We could separately access the top-level atomic or list elements using <code>atomic_elem</code> or <code>list_elem</code>:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1"></a><span class="co"># Pool-out top-level atomic elements in the list</span></span>
<span id="cb138-2"><a href="#cb138-2"></a><span class="kw">str</span>(<span class="kw">atomic_elem</span>(pIRF))</span>
<span id="cb138-3"><a href="#cb138-3"></a><span class="co"># List of 8</span></span>
<span id="cb138-4"><a href="#cb138-4"></a><span class="co">#  $ response  : chr [1:6] &quot;STD.HDW.AGR&quot; &quot;STD.HDW.MAN&quot; &quot;STD.HDW.WRT&quot; &quot;STD.HDW.CON&quot; ...</span></span>
<span id="cb138-5"><a href="#cb138-5"></a><span class="co">#  $ impulse   : chr [1:6] &quot;STD.HDW.AGR&quot; &quot;STD.HDW.MAN&quot; &quot;STD.HDW.WRT&quot; &quot;STD.HDW.CON&quot; ...</span></span>
<span id="cb138-6"><a href="#cb138-6"></a><span class="co">#  $ ortho     : logi TRUE</span></span>
<span id="cb138-7"><a href="#cb138-7"></a><span class="co">#  $ cumulative: logi FALSE</span></span>
<span id="cb138-8"><a href="#cb138-8"></a><span class="co">#  $ runs      : num 100</span></span>
<span id="cb138-9"><a href="#cb138-9"></a><span class="co">#  $ ci        : num 0.05</span></span>
<span id="cb138-10"><a href="#cb138-10"></a><span class="co">#  $ boot      : logi TRUE</span></span>
<span id="cb138-11"><a href="#cb138-11"></a><span class="co">#  $ model     : chr &quot;svarest&quot;</span></span></code></pre></div>
<p>There are also recursive versions of <code>atomic_elem</code> and <code>list_elem</code> named <code>reg_elem</code> and <code>irreg_elem</code> which can be used to split nested lists into the atomic and non-atomic parts. These are not covered in this vignette.</p>
</div>
<div id="recursive-apply-and-unlisting-in-2d" class="section level3">
<h3>8.3 Recursive Apply and Unlisting in 2D</h3>
<p><em>vars</em> supplies simple <code>plot</code> methods for IRF and FEVD objects using base graphics. <!-- , for example: --> <!-- ```{r} --> <!-- # Plot the forecast-error variance decmpositions --> <!-- plot(pFEVD) --> <!-- ``` --> <!-- `plot(pIRF)` would give us 6 charts of all sectoral responses to each sectoral shock.  --> In this section we however want to generate nicer and more compact plots using <code>ggplot2</code>, and also compute some statistics on the IRF data. Starting with the latter, the code below sums the 10-period impulse response coefficients of each sector in response to each sectoral impulse and stores them in a data frame:</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1"></a><span class="co"># Computing the cumulative impact after 10 periods</span></span>
<span id="cb139-2"><a href="#cb139-2"></a><span class="kw">list_elem</span>(pIRF) <span class="op">%&gt;%</span><span class="st">                            </span><span class="co"># Pull out the sublist elements containing the IRF coefficients + CI&#39;s</span></span>
<span id="cb139-3"><a href="#cb139-3"></a><span class="st">  </span><span class="kw">rapply2d</span>(<span class="cf">function</span>(x) <span class="kw">round</span>(<span class="kw">fsum</span>(x), <span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># Recursively apply the column-sums to coefficient matrices (could also use colSums)</span></span>
<span id="cb139-4"><a href="#cb139-4"></a><span class="st">  </span><span class="kw">unlist2d</span>(<span class="kw">c</span>(<span class="st">&quot;Type&quot;</span>, <span class="st">&quot;Impulse&quot;</span>))               <span class="co"># Recursively row-bind the result to a data.frame and add identifier columns</span></span>
<span id="cb139-5"><a href="#cb139-5"></a><span class="co">#     Type      Impulse STD.HDW.AGR STD.HDW.MAN STD.HDW.WRT STD.HDW.CON STD.HDW.TRA STD.HDW.FIRE</span></span>
<span id="cb139-6"><a href="#cb139-6"></a><span class="co"># 1    irf  STD.HDW.AGR        2.14        1.44        1.83        0.96        0.87         0.72</span></span>
<span id="cb139-7"><a href="#cb139-7"></a><span class="co"># 2    irf  STD.HDW.MAN        0.99        2.29        2.11        1.07        0.95         1.06</span></span>
<span id="cb139-8"><a href="#cb139-8"></a><span class="co"># 3    irf  STD.HDW.WRT       -0.57       -0.43        0.59        0.14       -0.01        -0.07</span></span>
<span id="cb139-9"><a href="#cb139-9"></a><span class="co"># 4    irf  STD.HDW.CON        0.11        0.00        0.18        1.89        0.43         0.23</span></span>
<span id="cb139-10"><a href="#cb139-10"></a><span class="co"># 5    irf  STD.HDW.TRA       -0.07       -0.14       -0.24       -0.30        1.31        -0.21</span></span>
<span id="cb139-11"><a href="#cb139-11"></a><span class="co"># 6    irf STD.HDW.FIRE        0.09       -0.09        0.03       -0.09       -0.06         1.84</span></span>
<span id="cb139-12"><a href="#cb139-12"></a><span class="co"># 7  Lower  STD.HDW.AGR        0.63       -1.32       -1.40       -1.24       -1.79        -0.47</span></span>
<span id="cb139-13"><a href="#cb139-13"></a><span class="co"># 8  Lower  STD.HDW.MAN       -1.66        0.68       -1.08       -0.98       -1.17         0.13</span></span>
<span id="cb139-14"><a href="#cb139-14"></a><span class="co"># 9  Lower  STD.HDW.WRT       -2.66       -3.05       -0.40       -2.86       -2.37        -1.14</span></span>
<span id="cb139-15"><a href="#cb139-15"></a><span class="co"># 10 Lower  STD.HDW.CON       -1.96       -1.46       -1.41        0.64       -1.07        -0.37</span></span>
<span id="cb139-16"><a href="#cb139-16"></a><span class="co"># 11 Lower  STD.HDW.TRA       -1.44       -1.63       -1.13       -1.70        0.29        -0.83</span></span>
<span id="cb139-17"><a href="#cb139-17"></a><span class="co"># 12 Lower STD.HDW.FIRE       -0.13       -0.26       -0.16       -0.26       -0.23         0.94</span></span>
<span id="cb139-18"><a href="#cb139-18"></a><span class="co"># 13 Upper  STD.HDW.AGR        4.21        3.76        3.30        2.53        2.02         1.52</span></span>
<span id="cb139-19"><a href="#cb139-19"></a><span class="co"># 14 Upper  STD.HDW.MAN        3.63        4.81        3.00        4.23        3.86         2.04</span></span>
<span id="cb139-20"><a href="#cb139-20"></a><span class="co"># 15 Upper  STD.HDW.WRT        2.32        2.47        3.99        1.41        3.12         0.99</span></span>
<span id="cb139-21"><a href="#cb139-21"></a><span class="co"># 16 Upper  STD.HDW.CON        2.42        3.17        2.59        3.70        2.48         1.49</span></span>
<span id="cb139-22"><a href="#cb139-22"></a><span class="co"># 17 Upper  STD.HDW.TRA        1.33        2.16        1.91        0.95        3.12         0.62</span></span>
<span id="cb139-23"><a href="#cb139-23"></a><span class="co"># 18 Upper STD.HDW.FIRE        0.31        0.14        0.25        0.14        0.17         2.22</span></span></code></pre></div>
<p>The function <code>rapply2d</code> used here is very similar to <code>base::rapply</code>, with the difference that the result is not simplified / unlisted by default and that <code>rapply2d</code> will treat data frames like atomic objects and apply functions to them. <code>unlist2d</code> is an efficient generalization of <code>base::unlist</code> to 2-dimensions, or one could also think of it as a recursive generalization of <code>do.call(rbind, ...)</code>. It efficiently unlists nested lists of data objects and creates a data frame with identifier columns for each level of nesting on the left, and the content of the list in columns on the right.</p>
<p>The above cumulative coefficients suggest that Agriculture responds mostly to it’s own shock, and a bit to shocks in Manufacturing and Wholesale and Retail Trade. Similar patters can be observed for Manufacturing and Wholesale and Retail Trade. Thus these three sectors seem to be interlinked in most countries. The remaining three sectors are mostly affected by their own dynamics, but also by Agriculture and Manufacturing.</p>
<!-- Finance and Real Estate sector seems even more independent and really only responds to it's own dynamics. Manufacturing and Transport and Storage seem to be pretty interlinked with the other broad sectors. Wholesale and Retail Trade and Construction exhibit some strange dynamics (i.e. WRT responds more to the CON shock that to it's own shock, and CON responds strongly negatively to the WRT shock). -->
<p>Let us use <code>ggplot2</code> to create nice compact plots of the IRF’s and FEVD’s. For this task <code>unlist2d</code> will again be extremely helpful in creating the data frame representation required. Starting with the IRF’s, we will discard the upper and lower bounds and just use the impulses:</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1"></a><span class="co"># This binds the matrices after adding integer row-names to them to a data.table</span></span>
<span id="cb140-2"><a href="#cb140-2"></a></span>
<span id="cb140-3"><a href="#cb140-3"></a>data &lt;-<span class="st"> </span>pIRF<span class="op">$</span>irf <span class="op">%&gt;%</span><span class="st">                      </span><span class="co"># Get only the coefficient matrices, discard the confidence bounds</span></span>
<span id="cb140-4"><a href="#cb140-4"></a><span class="st">           </span><span class="kw">unlist2d</span>(<span class="dt">idcols =</span> <span class="st">&quot;Impulse&quot;</span>,   <span class="co"># Recursive unlisting to data.table creating a factor id-column</span></span>
<span id="cb140-5"><a href="#cb140-5"></a>                    <span class="dt">row.names =</span> <span class="st">&quot;Time&quot;</span>,   <span class="co"># and saving generated rownames in a variable called &#39;Time&#39;</span></span>
<span id="cb140-6"><a href="#cb140-6"></a>                    <span class="dt">id.factor =</span> <span class="ot">TRUE</span>,     <span class="co"># -&gt; Create Id column (&#39;Impulse&#39;) as factor</span></span>
<span id="cb140-7"><a href="#cb140-7"></a>                    <span class="dt">DT =</span> <span class="ot">TRUE</span>)            <span class="co"># -&gt; Output as data.table (default is data.frame)</span></span>
<span id="cb140-8"><a href="#cb140-8"></a></span>
<span id="cb140-9"><a href="#cb140-9"></a><span class="kw">head</span>(data, <span class="dv">3</span>)</span>
<span id="cb140-10"><a href="#cb140-10"></a><span class="co">#        Impulse Time STD.HDW.AGR STD.HDW.MAN STD.HDW.WRT STD.HDW.CON STD.HDW.TRA STD.HDW.FIRE</span></span>
<span id="cb140-11"><a href="#cb140-11"></a><span class="co"># 1: STD.HDW.AGR    1   0.6713553   0.2871269   0.3443597  0.05639648  0.02802612   0.00000000</span></span>
<span id="cb140-12"><a href="#cb140-12"></a><span class="co"># 2: STD.HDW.AGR    2   0.4397169   0.2640971   0.3186278  0.10551675  0.08746941   0.05372323</span></span>
<span id="cb140-13"><a href="#cb140-13"></a><span class="co"># 3: STD.HDW.AGR    3   0.2974060   0.2210911   0.2738225  0.12549417  0.11301853   0.08483246</span></span>
<span id="cb140-14"><a href="#cb140-14"></a></span>
<span id="cb140-15"><a href="#cb140-15"></a>data &lt;-<span class="st"> </span><span class="kw">melt</span>(data, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)                   <span class="co"># Using data.table&#39;s melt</span></span>
<span id="cb140-16"><a href="#cb140-16"></a><span class="kw">head</span>(data, <span class="dv">3</span>)</span>
<span id="cb140-17"><a href="#cb140-17"></a><span class="co">#        Impulse Time    variable     value</span></span>
<span id="cb140-18"><a href="#cb140-18"></a><span class="co"># 1: STD.HDW.AGR    1 STD.HDW.AGR 0.6713553</span></span>
<span id="cb140-19"><a href="#cb140-19"></a><span class="co"># 2: STD.HDW.AGR    2 STD.HDW.AGR 0.4397169</span></span>
<span id="cb140-20"><a href="#cb140-20"></a><span class="co"># 3: STD.HDW.AGR    3 STD.HDW.AGR 0.2974060</span></span>
<span id="cb140-21"><a href="#cb140-21"></a></span>
<span id="cb140-22"><a href="#cb140-22"></a><span class="co"># Here comes the plot:</span></span>
<span id="cb140-23"><a href="#cb140-23"></a>  <span class="kw">ggplot</span>(data, <span class="kw">aes</span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> value, <span class="dt">color =</span> Impulse)) <span class="op">+</span></span>
<span id="cb140-24"><a href="#cb140-24"></a><span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="kw">I</span>(<span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>) <span class="op">+</span></span>
<span id="cb140-25"><a href="#cb140-25"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="ot">NULL</span>, <span class="dt">title =</span> <span class="st">&quot;Orthogonal Impulse Response Functions&quot;</span>) <span class="op">+</span></span>
<span id="cb140-26"><a href="#cb140-26"></a><span class="st">    </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">rainbow</span>(<span class="dv">6</span>)) <span class="op">+</span></span>
<span id="cb140-27"><a href="#cb140-27"></a><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>variable) <span class="op">+</span></span>
<span id="cb140-28"><a href="#cb140-28"></a><span class="st">    </span><span class="kw">theme_light</span>(<span class="dt">base_size =</span> <span class="dv">14</span>) <span class="op">+</span></span>
<span id="cb140-29"><a href="#cb140-29"></a><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> scales<span class="op">::</span><span class="kw">pretty_breaks</span>(<span class="dt">n=</span><span class="dv">7</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))<span class="op">+</span></span>
<span id="cb140-30"><a href="#cb140-30"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> scales<span class="op">::</span><span class="kw">pretty_breaks</span>(<span class="dt">n=</span><span class="dv">7</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))<span class="op">+</span></span>
<span id="cb140-31"><a href="#cb140-31"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb140-32"><a href="#cb140-32"></a>      <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb140-33"><a href="#cb140-33"></a>      <span class="dt">strip.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">colour =</span> <span class="ot">NA</span>),</span>
<span id="cb140-34"><a href="#cb140-34"></a>      <span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;grey30&quot;</span>),</span>
<span id="cb140-35"><a href="#cb140-35"></a>      <span class="dt">axis.ticks =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb140-36"><a href="#cb140-36"></a>      <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /> To round things off, below we do the same thing for the FEVD’s:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1"></a>data &lt;-<span class="st"> </span><span class="kw">unlist2d</span>(pFEVD, <span class="dt">idcols =</span> <span class="st">&quot;variable&quot;</span>, <span class="dt">row.names =</span> <span class="st">&quot;Time&quot;</span>, <span class="dt">id.factor =</span> <span class="ot">TRUE</span>, <span class="dt">DT =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb141-2"><a href="#cb141-2"></a><span class="st">            </span><span class="kw">melt</span>(<span class="kw">c</span>(<span class="st">&quot;variable&quot;</span>, <span class="st">&quot;Time&quot;</span>), <span class="dt">variable.name =</span> <span class="st">&quot;Sector&quot;</span>) </span>
<span id="cb141-3"><a href="#cb141-3"></a><span class="kw">head</span>(data, <span class="dv">3</span>)</span>
<span id="cb141-4"><a href="#cb141-4"></a><span class="co">#       variable Time      Sector     value</span></span>
<span id="cb141-5"><a href="#cb141-5"></a><span class="co"># 1: STD.HDW.AGR    1 STD.HDW.AGR 0.8469414</span></span>
<span id="cb141-6"><a href="#cb141-6"></a><span class="co"># 2: STD.HDW.AGR    2 STD.HDW.AGR 0.8404128</span></span>
<span id="cb141-7"><a href="#cb141-7"></a><span class="co"># 3: STD.HDW.AGR    3 STD.HDW.AGR 0.8333513</span></span>
<span id="cb141-8"><a href="#cb141-8"></a></span>
<span id="cb141-9"><a href="#cb141-9"></a><span class="co"># Here comes the plot:</span></span>
<span id="cb141-10"><a href="#cb141-10"></a>  <span class="kw">ggplot</span>(data, <span class="kw">aes</span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> value, <span class="dt">fill =</span> Sector)) <span class="op">+</span></span>
<span id="cb141-11"><a href="#cb141-11"></a><span class="st">    </span><span class="kw">geom_area</span>(<span class="dt">position =</span> <span class="st">&quot;fill&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span></span>
<span id="cb141-12"><a href="#cb141-12"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="ot">NULL</span>, <span class="dt">title =</span> <span class="st">&quot;Forecast Error Variance Decompositions&quot;</span>) <span class="op">+</span></span>
<span id="cb141-13"><a href="#cb141-13"></a><span class="st">    </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">rainbow</span>(<span class="dv">6</span>)) <span class="op">+</span></span>
<span id="cb141-14"><a href="#cb141-14"></a><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>variable) <span class="op">+</span></span>
<span id="cb141-15"><a href="#cb141-15"></a><span class="st">    </span><span class="kw">theme_linedraw</span>(<span class="dt">base_size =</span> <span class="dv">14</span>) <span class="op">+</span></span>
<span id="cb141-16"><a href="#cb141-16"></a><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> scales<span class="op">::</span><span class="kw">pretty_breaks</span>(<span class="dt">n=</span><span class="dv">7</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))<span class="op">+</span></span>
<span id="cb141-17"><a href="#cb141-17"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> scales<span class="op">::</span><span class="kw">pretty_breaks</span>(<span class="dt">n=</span><span class="dv">7</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))<span class="op">+</span></span>
<span id="cb141-18"><a href="#cb141-18"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb141-19"><a href="#cb141-19"></a>      <span class="dt">strip.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">colour =</span> <span class="ot">NA</span>),</span>
<span id="cb141-20"><a href="#cb141-20"></a>      <span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;grey30&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /> Both the IRF’s and the FEVD’s show that Agriculture, Manufacturing and Wholesale and Retail Trade are broadly interlinked, even in the short-run, and that Agriculture and Manufacturing explain some of the variation in Construction, Transport and Finance at longer horizons. Of course the identification strategy used for this example was not really structural or theory based. A better strategy could be to aggregate the World Input-Output Database and use those shares for identification (which would be another very nice <em>collapse</em> exercise, but not for this vignette).</p>
<!-- . There are also not much dynamics in the FEVD, suggesting that longer lag-lengths might be appropriate. The most important point of critique for this analysis is the structural identification strategy which is highly dubious (as correlation does not imply causation and we are also restricting sectoral relationships with a lower correlation to be 0 in the current period). A better method could be to aggregate the World Input-Output Database and use those shares for identification (which would be another very nice *collapse* exercise, but not for this vignette). -->
</div>
</div>
<div id="going-further" class="section level2">
<h2>Going Further</h2>
<p>To learn more about <em>collapse</em>, just examine the documentation <code>help(&quot;collapse-documentation&quot;)</code> which is organized, extensive and contains lots of examples.</p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Timmer, M. P., de Vries, G. J., &amp; de Vries, K. (2015). “Patterns of Structural Change in Developing Countries.” . In J. Weiss, &amp; M. Tribe (Eds.), <em>Routledge Handbook of Industry and Development.</em> (pp. 65-83). Routledge.</p>
<p>Mundlak, Yair. 1978. “On the Pooling of Time Series and Cross Section Data.” <em>Econometrica</em> 46 (1): 69–85.</p>
<!-- ## Benchmarks vs. *dplyr* and *data.table* -->
<!-- **Notes:**  -->
<!-- * Benchmarks are run on real and generated data, always with missing values. The largest data size is 10 columns each 1 Million Obs. and 100000 groups. -->
<!-- * Benchmarks are run on a conventional Windows 8.1 laptop with 2x 2.2 GHZ Intel i5 processor, 8GB DDR3 RAM and a Samsung 850 EVO SSD.  -->
<!-- * *data.table* multi-threading is enabled and 2 thread are used. *collapse* and *dplyr* are not parallelized.  -->
<!-- ### Aggregations -->
<!-- #### Large Data -->
<!-- ```{r, eval=NCRAN} -->
<!-- # Creating a data.table with 10 columns and 1 mio. obs, including 10% missing values -->
<!-- testdat <- na_insert(qDT(replicate(10, rnorm(1e6), simplify = FALSE)), prop = 0.1)  -->
<!-- testdat[["g1"]] <- sample.int(1000, 1e6, replace = TRUE) # 1000 groups -->
<!-- testdat[["g2"]] <- sample.int(100, 1e6, replace = TRUE) # 100 groups -->
<!-- # The average group size is 10, there are about 100000 groups -->
<!-- gtestdat <- group_by(testdat, g1, g2) -->
<!-- g <- GRP(testdat, ~ g1 + g2) -->
<!-- g -->
<!-- # Function performing the comparison -->
<!-- benchFUN <- function(FUN, fFUN, neval = 10, narm = TRUE, ...) { -->
<!--   eval(substitute(microbenchmark( -->
<!--    dplyr = summarize_all(group_by(testdat, g1, g2), FUN, ...), -->
<!--    dplyr_grouped = summarize_all(gtestdat, FUN, ...), -->
<!--    data.table_2_threads = testdat[, lapply(.SD, FUN, ...), keyby = c("g1","g2")], -->
<!--    collapse = collap(testdat, ~ g1 + g2, fFUN, keep.col.order = FALSE, na.rm = narm), -->
<!--    collapse_grouped = collap(testdat, g, fFUN, cols = 1:10, keep.col.order = FALSE, na.rm = narm),  -->
<!--    times = neval -->
<!--   ))) -->
<!-- } -->
<!-- # Sum -->
<!-- benchFUN(sum, fsum, na.rm = TRUE) -->
<!-- # Product -->
<!-- benchFUN(prod, fprod, na.rm = TRUE) -->
<!-- # Mean -->
<!-- benchFUN(mean, fmean, na.rm = TRUE) -->
<!-- # Maximum -->
<!-- benchFUN(max, fmax, na.rm = TRUE) -->
<!-- # Median -->
<!-- benchFUN(median, fmedian, 1, na.rm = TRUE) -->
<!-- # Variance -->
<!-- benchFUN(var, fvar, 1, na.rm = TRUE) -->
<!-- # Note: fvar implements a numerically stable online variance using Welfords Algorithm. -->
<!-- # Last Value -->
<!-- benchFUN(last, flast, 1, narm = FALSE) -->
<!-- # Note: collapse functions ffirst and flast by default also remove missing values i.e. take the first and last non-missing data point -->
<!-- # Number of Observations -->
<!-- options(collapse_unused_arg_action = "none") -->
<!-- benchFUN(function(x) sum(!is.na(x)), fNobs, 1) -->
<!-- # Number of Distinct Values -->
<!-- benchFUN(n_distinct, fNdistinct, 1, na.rm = TRUE) -->
<!-- ``` -->
<!-- Below some weighted and mode computations that are not straightforward in *dplyr* or *data.table*: -->
<!-- ```{r, eval=NCRAN} -->
<!-- # Weighted Mean -->
<!-- w <- abs(100*rnorm(1e6)) + 1 -->
<!-- testdat[["w"]] <- w -->
<!-- # Seems not possible with dplyr ... -->
<!-- system.time(testdat[, lapply(.SD, weighted.mean, w = w, na.rm = TRUE), keyby = c("g1","g2")]) -->
<!-- system.time(collap(testdat, ~ g1 + g2, w = w)) -->
<!-- # Weighted Variance -->
<!-- system.time(collap(testdat, ~ g1 + g2, fvar, w = w)) -->
<!-- # Mode -->
<!-- system.time(collap(testdat, ~ g1 + g2, fmode)) -->
<!-- # Note: This mode function uses index hashing in C++ -->
<!-- # Weighted Mode -->
<!-- system.time(collap(testdat, ~ g1 + g2, fmode, w = w)) -->
<!-- ``` -->
<!-- #### Typical Data -->
<!-- #### Small Data -->
<!-- When it comes to larger aggregation problems, the performance if *collapse* is broadly in line with *data.table* (at least on this machine), and offers the additional advantage of high-performance weighted and categorical aggregations: -->
<!-- I believe on really huge datasets aggregated on a multi-core machine, *data.table*'s memory efficiency and thread-parallelization will let it run faster with some GeForce optimized functions, but that does not apply to most users (I have tested up to 10 million obs. on my laptop where *collapse* is still very much in line). In comparison to *collapse* and *data.table* the performance of *dplyr* on this data is rather poor, especially for base functions that are not highly optimized like `sum`. I do however very much appreciate the tidyverse ecosystem for highly organized data exploration and transformation. Therefore I have created methods for all of the *Fast Statistical Functions* as well as `collap`, enabling them to be used effectively in the *dplyr* ecosystem where they produce amazing speed gains. This is the subject of the '*collapse* and *dplyr*' vignette. -->
<!-- Apart from its non-reliance on non-standard evaluation, a central advantage of *collapse* for programming is the speed it maintains on smaller problems where it's more efficient R code compared to *dplyr* and *data.table* really plays out: -->
<!-- ```{r, eval=NCRAN} -->
<!-- # 12000 obs in 1500 groups: A more typical case -->
<!-- GRP(wlddev, ~ iso3c + decade) -->
<!-- library(microbenchmark) -->
<!-- dtwlddev <- qDT(wlddev) -->
<!-- microbenchmark(dplyr = dtwlddev %>% group_by(iso3c,decade) %>% select_at(9:12) %>% summarise_all(sum, na.rm = TRUE), -->
<!--                data.table = dtwlddev[, lapply(.SD, sum, na.rm = TRUE), by = c("iso3c","decade"), .SDcols = 9:12], -->
<!--                collap = collap(dtwlddev, ~ iso3c + decade, fsum, cols = 9:12), -->
<!--                fast_fun = fsum(get_vars(dtwlddev, 9:12), GRP(dtwlddev, ~ iso3c + decade), use.g.names = FALSE)) # We can gain a bit coding it manually -->
<!-- # Now going really small: -->
<!-- dtmtcars <- qDT(mtcars) -->
<!-- microbenchmark(dplyr = dtmtcars %>% group_by(cyl,vs,am) %>% summarise_all(sum, na.rm = TRUE),      # Large R overhead -->
<!--                data.table = dtmtcars[, lapply(.SD, sum, na.rm = TRUE), by = c("cyl","vs","am")],   # Large R overhead -->
<!--                collap = collap(dtmtcars, ~ cyl + vs + am, fsum),                                   # Now this is still quite efficient -->
<!--                fast_fun = fsum(dtmtcars, GRP(dtmtcars, ~ cyl + vs + am), use.g.names = FALSE))     # And this is nearly the speed of a full C++ implementation -->
<!-- ``` -->
<!-- In general, the smaller the problem, the greater advantage *collapse* has over other packages because it's R overhead (i.e. the R code executed before the actual C-function doing the hard work is called) is carefully minimized. Most users working on typical datasets (< 1 Mio obs.) will find that their code runs significantly faster when implemented in *collapse* compared to other solutions. -->
<!-- ### Transformation Benchmarks -->
<!-- Below I provide benchmarks for some very common data transformation tasks, again comparing *collapse* to *dplyr* and *data.table*: -->
<!-- ```{r, eval=NCRAN} -->
<!-- # The average group size is 10, there are about 100000 groups -->
<!-- GRP(testdat, ~ g1 + g2) -->
<!-- # get indices of grouping columns -->
<!-- ind <- get_vars(testdat, c("g1","g2"), "indices") -->
<!-- # Centering -->
<!-- system.time(testdat %>% group_by(g1,g2) %>% mutate_all(function(x) x - mean.default(x, na.rm = TRUE))) -->
<!-- system.time(testdat[, lapply(.SD, function(x) x - mean(x, na.rm = TRUE)), keyby = c("g1","g2")]) -->
<!-- system.time(W(testdat, ~ g1 + g2)) -->
<!-- # Weighted Centering -->
<!-- # Can't easily be done in dplyr.. -->
<!-- system.time(testdat[, lapply(.SD, function(x) x - weighted.mean(x, w, na.rm = TRUE)), keyby = c("g1","g2")]) -->
<!-- system.time(W(testdat, ~ g1 + g2, ~ w)) -->
<!-- # Centering on the overall mean -->
<!-- # Can't easily be done in dplyr or data.table. -->
<!-- system.time(W(testdat, ~ g1 + g2, mean = "overall.mean"))      # Ordinary -->
<!-- system.time(W(testdat, ~ g1 + g2, ~ w, mean = "overall.mean")) # Weighted -->
<!-- # Centering on both grouping variables simultaneously -->
<!-- # Can't be done in dplyr or data.table at all! -->
<!-- system.time(HDW(testdat, ~ qF(g1) + qF(g2), variable.wise = TRUE))        # Ordinary -->
<!-- system.time(HDW(testdat, ~ qF(g1) + qF(g2), w = w, variable.wise = TRUE)) # Weighted -->
<!-- # Proportions -->
<!-- system.time(testdat %>% group_by(g1,g2) %>% mutate_all(function(x) x/sum(x, na.rm = TRUE))) -->
<!-- system.time(testdat[, lapply(.SD, function(x) x/sum(x, na.rm = TRUE)), keyby = c("g1","g2")]) -->
<!-- system.time(fsum(get_vars(testdat, -ind), get_vars(testdat, ind), TRA = "/")) -->
<!-- # Scaling -->
<!-- system.time(testdat %>% group_by(g1,g2) %>% mutate_all(function(x) x/sd(x, na.rm = TRUE))) -->
<!-- system.time(testdat[, lapply(.SD, function(x) x/sd(x, na.rm = TRUE)), keyby = c("g1","g2")]) -->
<!-- system.time(fsd(get_vars(testdat, -ind), get_vars(testdat, ind), TRA = "/")) -->
<!-- system.time(fsd(get_vars(testdat, -ind), get_vars(testdat, ind), w, "/")) # Weighted Scaling. Need a weighted sd to do in dplyr or data.table -->
<!-- # Scaling and centering (i.e. standardizing) -->
<!-- system.time(testdat %>% group_by(g1,g2) %>% mutate_all(function(x) (x - mean.default(x, na.rm = TRUE))/sd(x, na.rm = TRUE))) -->
<!-- system.time(testdat[, lapply(.SD, function(x) (x - mean(x, na.rm = TRUE))/sd(x, na.rm = TRUE)), keyby = c("g1","g2")]) -->
<!-- system.time(STD(testdat, ~ g1 + g2)) -->
<!-- system.time(STD(testdat, ~ g1 + g2, ~ w))  # Weighted standardizing: Also difficult to do in dplyr or data.table -->
<!-- # Replacing data with any ststistic, here the sum: -->
<!-- system.time(testdat %>% group_by(g1,g2) %>% mutate_all(sum, na.rm = TRUE)) -->
<!-- system.time(testdat[, setdiff(names(testdat), c("g1","g2")) := lapply(.SD, sum, na.rm = TRUE), keyby = c("g1","g2")]) -->
<!-- system.time(fsum(get_vars(testdat, -ind), get_vars(testdat, ind), TRA = "replace_fill")) # dplyr and data.table also fill missing values. -->
<!-- system.time(fsum(get_vars(testdat, -ind), get_vars(testdat, ind), TRA = "replace")) # This preserves missing values, and is not easily implemented in dplyr or data.table -->
<!-- ``` -->
<!-- The message is clear: *collapse* outperforms *dplyr* and *data.table* both in scope and speed when it comes to grouped and / or weighted transformations of data. This capacity of *collapse* should make it attractive to econometricians and people programming with complex panel data. In the '*collapse* and *plm*' vignette I provide a programming example by implementing a more general case of the Hausman and Taylor (1981) estimator with two levels of fixed effects, as well as further benchmarks. -->
<!-- <!-- This capacity with `B` and `W` can be extremely useful to implement complex fixed-effects and instrumental-variables procedures (Like Hausman-Taylor 1985 etc.) not implemented in standard packages. Bootstrapping can be used to obtain proper standard errors. `fbetween / B` and `fwithin / W` are also orders of magnitudes faster than implementations in standard packages - for large problems. The code below shows the time required to average / center 1 Million observations in 100,000 groups:  -->
<!-- <!-- ````{r} -->
<!-- <!-- x <- abs(1000*rnorm(1e6))+100 -->
<!-- <!-- f <- qF(sample.int(1e5, 1e6, replace = TRUE), na.exclude = FALSE) -->
<!-- <!-- system.time(ave(x, f)) # Base R equivalent of fbetween / B -->
<!-- <!-- system.time(B(x, f)) -->
<!-- <!-- system.time(W(x, f)) -->
<!-- <!-- ``` -->
<!-- ### Time-Computation Benchmarks -->
<!-- Below I provide some benchmarks for lags, differences and growth rates on panel data. I will run microbenchmarks on the `wlddev` dataset. benchmarks on larger panels are already provided in the other vignettes. Again I compare *collapse* to *dplyr* and *data.table*: -->
<!-- ```{r, eval=NCRAN} -->
<!-- # We have a balanced panel of 216 countries, each observed for 59 years -->
<!-- descr(wlddev, cols = c("iso3c", "year")) -->
<!-- # 1 Panel-Lag -->
<!-- suppressMessages( -->
<!-- microbenchmark(dplyr_not_ordered = wlddev %>% group_by(iso3c) %>% select_at(9:12) %>% mutate_all(lag), -->
<!--                dplyr_ordered = wlddev %>% arrange(iso3c,year) %>% group_by(iso3c) %>% select_at(9:12) %>% mutate_all(lag), -->
<!--                data.table_not_ordered = dtwlddev[, shift(.SD), keyby = iso3c, .SDcols = 9:12], -->
<!--                data.table_ordered = dtwlddev[order(year), shift(.SD), keyby = iso3c, .SDcols = 9:12], -->
<!--                collapse_not_ordered = L(wlddev, 1, ~iso3c, cols = 9:12), -->
<!--                collapse_ordered = L(wlddev, 1, ~iso3c, ~year, cols = 9:12), -->
<!--                subtract_from_CNO = message("Panel-lag computed without timevar: Assuming ordered data"))) -->
<!-- # Sequence of 1 lead and 3 lags: Not possible in dplyr -->
<!-- microbenchmark(data.table_not_ordered = dtwlddev[, shift(.SD, -1:3), keyby = iso3c, .SDcols = 9:12], -->
<!--                data.table_ordered = dtwlddev[order(year), shift(.SD, -1:3), keyby = iso3c, .SDcols = 9:12], -->
<!--                collapse_ordered = L(wlddev, -1:3, ~iso3c, ~year, cols = 9:12)) -->
<!-- # 1 Panel-difference -->
<!-- microbenchmark(dplyr_not_ordered = wlddev %>% group_by(iso3c) %>% select_at(9:12) %>% mutate_all(function(x) x - lag(x)), -->
<!--                dplyr_ordered = wlddev %>% arrange(iso3c,year) %>% group_by(iso3c) %>% select_at(9:12) %>% mutate_all(function(x) x - lag(x)), -->
<!--                data.table_not_ordered = dtwlddev[, lapply(.SD, function(x) x - shift(x)), keyby = iso3c, .SDcols = 9:12], -->
<!--                data.table_ordered = dtwlddev[order(year), lapply(.SD, function(x) x - shift(x)), keyby = iso3c, .SDcols = 9:12], -->
<!--                collapse_ordered = D(wlddev, 1, 1, ~iso3c, ~year, cols = 9:12)) -->
<!-- # Iterated Panel-Difference: Not straightforward in dplyr or data.table -->
<!-- microbenchmark(collapse_ordered = D(wlddev, 1, 2, ~iso3c, ~year, cols = 9:12)) -->
<!-- # Sequence of Lagged/Leaded Differences: Not straightforward in dplyr or data.table -->
<!-- microbenchmark(collapse_ordered = D(wlddev, -1:3, 1, ~iso3c, ~year, cols = 9:12)) -->
<!-- # Sequence of Lagged/Leaded and Iterated Differences: Not straightforward in dplyr or data.table -->
<!-- microbenchmark(collapse_ordered = D(wlddev, -1:3, 1:2, ~iso3c, ~year, cols = 9:12)) -->
<!-- # The same applies to growth rates or log-differences. -->
<!-- microbenchmark(collapse_ordered_growth = G(wlddev, 1, 1, ~iso3c, ~year, cols = 9:12), -->
<!--                collapse_ordered_logdiff = G(wlddev, 1, 1, ~iso3c, ~year, cols = 9:12, logdiff = TRUE)) -->
<!-- ``` -->
<!-- The results are similar to the grouped transformations: *collapse* substantially facilitates and speeds up these complex operations in R. Again *plm* classes are very useful to avoid having to specify panel-identifiers all the time. See the '*collapse* and *plm*' vignette for more details. -->
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>in the <em>Within</em> data, the overall mean was added back after subtracting out country means, to preserve the level of the data, see also section 6.5.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>You may wonder why with weights the standard-deviations in the group ‘4.0.1’ are <code>0</code> while they were <code>NA</code> without weights. This stirs from the fact that group ‘4.0.1’ only has one observation, and in the Bessel-corrected estimate of the variance there is a <code>n - 1</code> in the denominator which becomes <code>0</code> if <code>n = 1</code> and division by <code>0</code> becomes <code>NA</code> in this case (<code>fvar</code> was designed that way to match the behavior or <code>stats::var</code>). In the weighted version the denominator is <code>sum(w) - 1</code>, and if <code>sum(w)</code> is not 1, then the denominator is not <code>0</code>. The standard-deviation however is still <code>0</code> because the sum of squares in the numerator is <code>0</code>. In other words this means that in a weighted aggregation singleton-groups are not treated like singleton groups unless the corresponding weight is <code>1</code>.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>I.e. the most frequent value. By default a first-mode is computed.<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>If the list is unnamed, <code>collap</code> uses <code>all.vars(substitute(list(FUN1, FUN2, ...)))</code> to get the function names. Alternatively it is also possible to pass a character vector of function names.<a href="#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p><code>BY.grouped_df</code> is probably only useful together with the <code>expand.wide = TRUE</code> argument which <em>dplyr</em> does not have, because otherwise <em>dplyr</em>’s <code>summarize</code> and <code>mutate</code> are substantially faster on larger data.<a href="#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p>I noticed there is a <em>panelvar</em> package, but I am more familiar with <em>vars</em> and <em>panelvar</em> can be pretty slow in my experience. We also have about 50 years of data here, so dynamic panel bias is not a big issue.<a href="#fnref6" class="footnote-back">↩︎</a></p></li>
<li id="fn7"><p>The <em>vars</em> package also provides convenient extractor functions for some quantities, but <code>get_elem</code> of course works in a much broader range of contexts.<a href="#fnref7" class="footnote-back">↩︎</a></p></li>
</ol>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
